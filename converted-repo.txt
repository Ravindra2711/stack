Selected Files Directory Structure:

└── ./
    ├── src
    │   ├── analyser
    │   │   ├── index.test.ts
    │   │   └── index.ts
    │   ├── common
    │   │   ├── rules
    │   │   │   └── matchFiles.ts
    │   │   ├── helpers.ts
    │   │   ├── languages.ts
    │   │   ├── log.ts
    │   │   └── nid.ts
    │   ├── payload
    │   │   ├── helpers.test.ts
    │   │   ├── helpers.ts
    │   │   ├── index.test.ts
    │   │   └── index.ts
    │   ├── provider
    │   │   ├── base.ts
    │   │   ├── fake.ts
    │   │   └── fs.ts
    │   ├── rules
    │   │   ├── ai
    │   │   │   ├── anthropic.ts
    │   │   │   ├── aws.bedrock.ts
    │   │   │   ├── aws.comprehend.ts
    │   │   │   ├── aws.polly.ts
    │   │   │   ├── aws.rekognition.ts
    │   │   │   ├── aws.sagemaker.ts
    │   │   │   ├── aws.transcribe.ts
    │   │   │   ├── aws.translate.ts
    │   │   │   ├── azure.openai.ts
    │   │   │   ├── cohere.ts
    │   │   │   ├── deepseek.ts
    │   │   │   ├── elevenlabs.ts
    │   │   │   ├── gcp.aiplatform.ts
    │   │   │   ├── gcp.dialogflow.ts
    │   │   │   ├── gcp.language.ts
    │   │   │   ├── gcp.speech.ts
    │   │   │   ├── gcp.translate.ts
    │   │   │   ├── gcp.vertex.ts
    │   │   │   ├── gcp.vision.ts
    │   │   │   ├── geminiai.ts
    │   │   │   ├── groq.ts
    │   │   │   ├── huggingface.ts
    │   │   │   ├── index.ts
    │   │   │   ├── mistralai.ts
    │   │   │   ├── ollama.ts
    │   │   │   ├── openai.ts
    │   │   │   ├── perplexityai.ts
    │   │   │   ├── replicate.ts
    │   │   │   ├── vercel.ai.ts
    │   │   │   └── xai.ts
    │   │   ├── analytics
    │   │   │   ├── adobe.analytics.ts
    │   │   │   ├── amplitude.ts
    │   │   │   ├── databuddy.ts
    │   │   │   ├── datafast.ts
    │   │   │   ├── fathom.ts
    │   │   │   ├── google.analytics.ts
    │   │   │   ├── hotjar.ts
    │   │   │   ├── index.ts
    │   │   │   ├── koalaanalytics.ts
    │   │   │   ├── logsnag.ts
    │   │   │   ├── matomo.ts
    │   │   │   ├── mixpanel.ts
    │   │   │   ├── pirschanalytics.ts
    │   │   │   ├── plausible.ts
    │   │   │   ├── posthog.ts
    │   │   │   ├── segment.ts
    │   │   │   ├── simpleanalytics.ts
    │   │   │   ├── tinybird.ts
    │   │   │   └── vercel.analytics.ts
    │   │   ├── app
    │   │   │   ├── adminer.ts
    │   │   │   ├── apacheTika.ts
    │   │   │   ├── caddy.ts
    │   │   │   ├── consul.ts
    │   │   │   ├── discourse.ts
    │   │   │   ├── grafana.ts
    │   │   │   ├── haproxy.ts
    │   │   │   ├── httpd.ts
    │   │   │   ├── index.ts
    │   │   │   ├── kibana.ts
    │   │   │   ├── kong.ts
    │   │   │   ├── mongoexpress.ts
    │   │   │   ├── nginx.ts
    │   │   │   ├── postgrest.ts
    │   │   │   ├── teamspeak.ts
    │   │   │   ├── telegraf.ts
    │   │   │   ├── traefik.ts
    │   │   │   └── zookeeper.ts
    │   │   ├── auth
    │   │   │   ├── auth0.ts
    │   │   │   ├── aws.cognito.ts
    │   │   │   ├── betterauth.ts
    │   │   │   ├── clerk.ts
    │   │   │   ├── frontegg.ts
    │   │   │   ├── fusionauth.ts
    │   │   │   ├── hanko.ts
    │   │   │   ├── index.ts
    │   │   │   ├── kinde.ts
    │   │   │   ├── logto.ts
    │   │   │   ├── okta.ts
    │   │   │   ├── orysh.ts
    │   │   │   ├── properlauth.ts
    │   │   │   ├── stytch.ts
    │   │   │   ├── supabase.auth.ts
    │   │   │   ├── supertokens.ts
    │   │   │   └── workos.ts
    │   │   ├── automation
    │   │   │   ├── apify.ts
    │   │   │   ├── aws.sfn.ts
    │   │   │   ├── browerbase.ts
    │   │   │   ├── browseruse.ts
    │   │   │   ├── crawl4ai.ts
    │   │   │   ├── firecrawl.ts
    │   │   │   ├── index.ts
    │   │   │   ├── inngest.ts
    │   │   │   ├── n8n.ts
    │   │   │   ├── playwright.ts
    │   │   │   ├── puppeteer.ts
    │   │   │   └── selenium.ts
    │   │   ├── builder
    │   │   │   ├── babel.ts
    │   │   │   ├── esbuild.ts
    │   │   │   ├── index.ts
    │   │   │   ├── nxjs.ts
    │   │   │   ├── parceljs.ts
    │   │   │   ├── rolldown.ts
    │   │   │   ├── rollup.ts
    │   │   │   ├── rspack.ts
    │   │   │   ├── swc.ts
    │   │   │   ├── turborepo.ts
    │   │   │   ├── vite.ts
    │   │   │   └── webpack.ts
    │   │   ├── ci
    │   │   │   ├── appveyor.ts
    │   │   │   ├── atlassian.bitbucketpipelines.ts
    │   │   │   ├── aws.codebuild.ts
    │   │   │   ├── aws.codepipeline.ts
    │   │   │   ├── azure.ci.ts
    │   │   │   ├── browserstack.ts
    │   │   │   ├── circleci.ts
    │   │   │   ├── cirrusci.ts
    │   │   │   ├── cloudbees.codeship.ts
    │   │   │   ├── codeclimate.ts
    │   │   │   ├── codecov.ts
    │   │   │   ├── codesandboxci.ts
    │   │   │   ├── concourseci.ts
    │   │   │   ├── coveralls.ts
    │   │   │   ├── cypressci.ts
    │   │   │   ├── deepsource.ts
    │   │   │   ├── dependabot.ts
    │   │   │   ├── depotdev.ts
    │   │   │   ├── droneci.ts
    │   │   │   ├── gcp.cloudbuild.ts
    │   │   │   ├── github.codeql.ts
    │   │   │   ├── gitlab.ci.ts
    │   │   │   ├── index.ts
    │   │   │   ├── jenkins.ts
    │   │   │   ├── nxcloud.ts
    │   │   │   ├── relativeci.ts
    │   │   │   ├── renovate.ts
    │   │   │   ├── sonarcloud.ts
    │   │   │   ├── sonarqube.ts
    │   │   │   ├── styleci.ts
    │   │   │   ├── teamcity.ts
    │   │   │   ├── travisci.ts
    │   │   │   └── trufflesecurity.ts
    │   │   ├── cloud
    │   │   │   ├── adobe.ts
    │   │   │   ├── akamai.ts
    │   │   │   ├── alibabacloud.ts
    │   │   │   ├── apple.ts
    │   │   │   ├── atlassian.ts
    │   │   │   ├── aws.ts
    │   │   │   ├── azure.ts
    │   │   │   ├── cloudbees.ts
    │   │   │   ├── cloudflare.ts
    │   │   │   ├── dokku.ts
    │   │   │   ├── equinix.ts
    │   │   │   ├── firebase.ts
    │   │   │   ├── flyio.ts
    │   │   │   ├── gcp.ts
    │   │   │   ├── google.ts
    │   │   │   ├── heroku.ts
    │   │   │   ├── hetzner.ts
    │   │   │   ├── hostinger.ts
    │   │   │   ├── ibmcloud.ts
    │   │   │   ├── index.ts
    │   │   │   ├── microsoft.ts
    │   │   │   ├── netlify.ts
    │   │   │   ├── nextcloud.ts
    │   │   │   ├── oraclecloud.ts
    │   │   │   ├── ovh.ts
    │   │   │   ├── qovery.ts
    │   │   │   ├── railway.ts
    │   │   │   ├── scaleway.ts
    │   │   │   ├── supabase.ts
    │   │   │   ├── upstash.ts
    │   │   │   └── vercel.ts
    │   │   ├── cms
    │   │   │   ├── adobe.commercecloud.ts
    │   │   │   ├── adobe.experiencemanager.ts
    │   │   │   ├── bigcommerce.ts
    │   │   │   ├── commercetools.ts
    │   │   │   ├── contentful.ts
    │   │   │   ├── datocms.ts
    │   │   │   ├── drupal.ts
    │   │   │   ├── fabric.ts
    │   │   │   ├── ghost.ts
    │   │   │   ├── gitbook.ts
    │   │   │   ├── index.ts
    │   │   │   ├── joomla.ts
    │   │   │   ├── kentico.ts
    │   │   │   ├── magento.ts
    │   │   │   ├── payloadcms.ts
    │   │   │   ├── prestashop.ts
    │   │   │   ├── sanity.ts
    │   │   │   ├── shopify.ts
    │   │   │   ├── sitecore.xmcloud.ts
    │   │   │   ├── squarespace.ts
    │   │   │   ├── storyblok.ts
    │   │   │   ├── strapi.ts
    │   │   │   ├── webflow.ts
    │   │   │   ├── woocommerce.ts
    │   │   │   └── wordpress.ts
    │   │   ├── collaboration
    │   │   │   ├── airtable.ts
    │   │   │   ├── asana.ts
    │   │   │   ├── atlassian.confluence.ts
    │   │   │   ├── atlassian.jira.ts
    │   │   │   ├── atlassian.opsgenie.ts
    │   │   │   ├── atlassian.trello.ts
    │   │   │   ├── calcom.ts
    │   │   │   ├── calendly.ts
    │   │   │   ├── clickup.ts
    │   │   │   ├── crowdin.ts
    │   │   │   ├── google.calendar.ts
    │   │   │   ├── google.chat.ts
    │   │   │   ├── google.docs.ts
    │   │   │   ├── google.drive.ts
    │   │   │   ├── google.forms.ts
    │   │   │   ├── google.gmail.ts
    │   │   │   ├── google.keep.ts
    │   │   │   ├── google.meet.ts
    │   │   │   ├── google.sheets.ts
    │   │   │   ├── google.slides.ts
    │   │   │   ├── google.tasks.ts
    │   │   │   ├── index.ts
    │   │   │   ├── linear.ts
    │   │   │   ├── microsoft.onedrive.ts
    │   │   │   ├── miro.ts
    │   │   │   ├── monday.ts
    │   │   │   └── notion.ts
    │   │   ├── communication
    │   │   │   ├── aircall.ts
    │   │   │   ├── discord.ts
    │   │   │   ├── facebook.ts
    │   │   │   ├── freshdesk.ts
    │   │   │   ├── index.ts
    │   │   │   ├── instagram.ts
    │   │   │   ├── intercom.ts
    │   │   │   ├── linkedin.ts
    │   │   │   ├── mattermost.ts
    │   │   │   ├── reddit.ts
    │   │   │   ├── slack.ts
    │   │   │   ├── telegram.ts
    │   │   │   ├── twitch.ts
    │   │   │   ├── twitter.ts
    │   │   │   ├── whatsapp.ts
    │   │   │   ├── wikipedia.ts
    │   │   │   ├── youtube.ts
    │   │   │   ├── zendesk.ts
    │   │   │   └── zoom.ts
    │   │   ├── crm
    │   │   │   ├── hubspot.ts
    │   │   │   ├── index.ts
    │   │   │   ├── klaviyo.ts
    │   │   │   ├── salesforce.ts
    │   │   │   └── twentycrm.ts
    │   │   ├── db
    │   │   │   ├── algolia.ts
    │   │   │   ├── apacheCassandra.ts
    │   │   │   ├── apacheCouchdb.ts
    │   │   │   ├── apacheHadoop.ts
    │   │   │   ├── apacheHive.ts
    │   │   │   ├── apacheIceberg.ts
    │   │   │   ├── apacheSolr.ts
    │   │   │   ├── apacheSpark.ts
    │   │   │   ├── aws.athena.ts
    │   │   │   ├── aws.cloudsearch.ts
    │   │   │   ├── aws.documentdb.ts
    │   │   │   ├── aws.dynamodb.ts
    │   │   │   ├── aws.elasticache.ts
    │   │   │   ├── aws.memorydb.ts
    │   │   │   ├── aws.neptune.ts
    │   │   │   ├── aws.opensearch.ts
    │   │   │   ├── aws.rds.ts
    │   │   │   ├── aws.redshift.ts
    │   │   │   ├── aws.secretsmanager.ts
    │   │   │   ├── aws.timestream.ts
    │   │   │   ├── azure.cosmosdb.ts
    │   │   │   ├── azure.mariadb.ts
    │   │   │   ├── azure.mysql.ts
    │   │   │   ├── azure.postgres.ts
    │   │   │   ├── azure.redis.ts
    │   │   │   ├── azure.sql.ts
    │   │   │   ├── chromadb.ts
    │   │   │   ├── clickhouse.ts
    │   │   │   ├── cockroachdb.ts
    │   │   │   ├── convex.ts
    │   │   │   ├── couchbase.ts
    │   │   │   ├── cratedb.ts
    │   │   │   ├── datastax.ts
    │   │   │   ├── duckdb.ts
    │   │   │   ├── elasticsearch.ts
    │   │   │   ├── firebase.firestore.ts
    │   │   │   ├── gcp.bigquery.ts
    │   │   │   ├── gcp.bigtable.ts
    │   │   │   ├── gcp.datastore.ts
    │   │   │   ├── gcp.memorystore.ts
    │   │   │   ├── gcp.secretmanager.ts
    │   │   │   ├── gcp.spanner.ts
    │   │   │   ├── gcp.sql.ts
    │   │   │   ├── hashicorpVault.ts
    │   │   │   ├── index.ts
    │   │   │   ├── influxdb.ts
    │   │   │   ├── libsql.ts
    │   │   │   ├── mariadb.ts
    │   │   │   ├── meilisearch.ts
    │   │   │   ├── meilisearchcloud.ts
    │   │   │   ├── memcached.ts
    │   │   │   ├── milvusdb.ts
    │   │   │   ├── mongodb.ts
    │   │   │   ├── mssql.ts
    │   │   │   ├── mysql.ts
    │   │   │   ├── neo4j.ts
    │   │   │   ├── neondb.ts
    │   │   │   ├── oceanbase.ts
    │   │   │   ├── ovh.database.ts
    │   │   │   ├── percona.ts
    │   │   │   ├── pinecone.ts
    │   │   │   ├── planetscale.ts
    │   │   │   ├── postgres.ts
    │   │   │   ├── qdrant.ts
    │   │   │   ├── qovery.database.ts
    │   │   │   ├── questdb.ts
    │   │   │   ├── railway.mongodb.ts
    │   │   │   ├── railway.mysql.ts
    │   │   │   ├── railway.postgres.ts
    │   │   │   ├── railway.redis.ts
    │   │   │   ├── redis.ts
    │   │   │   ├── replit.database.ts
    │   │   │   ├── replit.postgres.ts
    │   │   │   ├── rethinkdb.ts
    │   │   │   ├── scaleway.database.ts
    │   │   │   ├── scaleway.documentdb.ts
    │   │   │   ├── scaleway.redis.ts
    │   │   │   ├── scaleway.secretmanager.ts
    │   │   │   ├── snowflake.ts
    │   │   │   ├── sqlite.ts
    │   │   │   ├── supabase.postgres.ts
    │   │   │   ├── surrealdb.ts
    │   │   │   ├── swiftype.ts
    │   │   │   ├── tdengine.ts
    │   │   │   ├── tidb.ts
    │   │   │   ├── timescaledb.ts
    │   │   │   ├── tursodb.ts
    │   │   │   ├── typesense.ts
    │   │   │   ├── typesensecloud.ts
    │   │   │   ├── upstash.redis.ts
    │   │   │   ├── valkey.ts
    │   │   │   ├── vercel.blob.ts
    │   │   │   ├── vercel.kv.ts
    │   │   │   ├── vercel.postgres.ts
    │   │   │   └── victoriametrics.ts
    │   │   ├── etl
    │   │   │   ├── airbyte.ts
    │   │   │   ├── apacheAirflow.ts
    │   │   │   ├── apacheFlink.ts
    │   │   │   ├── apacheStorm.ts
    │   │   │   ├── apideck.ts
    │   │   │   ├── aws.glue.ts
    │   │   │   ├── composio.ts
    │   │   │   ├── databricks.ts
    │   │   │   ├── dataiku.ts
    │   │   │   ├── gcp.dataflow.ts
    │   │   │   ├── gcp.dataproc.ts
    │   │   │   ├── index.ts
    │   │   │   ├── integrationapp.ts
    │   │   │   ├── logstash.ts
    │   │   │   ├── mergedev.ts
    │   │   │   ├── nango.ts
    │   │   │   ├── trayio.ts
    │   │   │   └── useparagon.ts
    │   │   ├── framework
    │   │   │   ├── apiplatform.ts
    │   │   │   ├── blitzjs.ts
    │   │   │   ├── dioxus.ts
    │   │   │   ├── django.ts
    │   │   │   ├── index.ts
    │   │   │   ├── laravel.ts
    │   │   │   ├── meteorjs.ts
    │   │   │   ├── nestjs.ts
    │   │   │   ├── nextjs.ts
    │   │   │   ├── nuxtjs.ts
    │   │   │   ├── rails.ts
    │   │   │   ├── redwoodjs.ts
    │   │   │   ├── remixrun.ts
    │   │   │   ├── remult.ts
    │   │   │   ├── sveltekit.ts
    │   │   │   ├── symfony.ts
    │   │   │   ├── tanstackstart.ts
    │   │   │   ├── tauri.ts
    │   │   │   ├── wasp.ts
    │   │   │   └── yii2.ts
    │   │   ├── hosting
    │   │   │   ├── aws.amplifyhosting.ts
    │   │   │   ├── aws.apigateway.ts
    │   │   │   ├── aws.ec2.ts
    │   │   │   ├── aws.ecs.ts
    │   │   │   ├── aws.eks.ts
    │   │   │   ├── aws.fargate.ts
    │   │   │   ├── aws.lambda.ts
    │   │   │   ├── aws.lightsail.ts
    │   │   │   ├── azure.aks.ts
    │   │   │   ├── azure.functions.ts
    │   │   │   ├── azure.staticwebapps.ts
    │   │   │   ├── cloudflare.pages.ts
    │   │   │   ├── cloudflare.workers.ts
    │   │   │   ├── denodeploy.ts
    │   │   │   ├── digitalocean.ts
    │   │   │   ├── elasticcloud.ts
    │   │   │   ├── expodev.ts
    │   │   │   ├── fastly.ts
    │   │   │   ├── gcp.appengine.ts
    │   │   │   ├── gcp.cloudrun.ts
    │   │   │   ├── gcp.functions.ts
    │   │   │   ├── gcp.gce.ts
    │   │   │   ├── gcp.gke.ts
    │   │   │   ├── gcp.tasks.ts
    │   │   │   ├── github.pages.ts
    │   │   │   ├── index.ts
    │   │   │   ├── koyeb.ts
    │   │   │   ├── kubernetes.ts
    │   │   │   ├── mongodbatlas.ts
    │   │   │   ├── ovh.dedicated.ts
    │   │   │   ├── ovh.kubernetes.ts
    │   │   │   ├── ovh.vps.ts
    │   │   │   ├── platformsh.ts
    │   │   │   ├── qovery.cluster.ts
    │   │   │   ├── render.ts
    │   │   │   ├── replit.ts
    │   │   │   ├── scaleway.container.ts
    │   │   │   ├── scaleway.elasticmetal.ts
    │   │   │   ├── scaleway.functions.ts
    │   │   │   ├── scaleway.kubernetes.ts
    │   │   │   ├── sitecore.ts
    │   │   │   ├── supabase.functions.ts
    │   │   │   ├── tencentcloud.ts
    │   │   │   ├── vercel.edge.ts
    │   │   │   └── vercel.functions.ts
    │   │   ├── iac
    │   │   │   ├── ansible.ts
    │   │   │   ├── aws.cloudformation.ts
    │   │   │   ├── chef.ts
    │   │   │   ├── helm.ts
    │   │   │   ├── index.ts
    │   │   │   ├── pulumi.ts
    │   │   │   └── terragrunt.ts
    │   │   ├── iconset
    │   │   │   ├── antdicons.ts
    │   │   │   ├── bootstrapicons.ts
    │   │   │   ├── feathericons.ts
    │   │   │   ├── fontawesome.ts
    │   │   │   ├── heroicons.ts
    │   │   │   ├── hugeicons.ts
    │   │   │   ├── index.ts
    │   │   │   ├── ionicons.ts
    │   │   │   ├── lordicon.ts
    │   │   │   ├── lucideicons.ts
    │   │   │   ├── materialdesignicons.ts
    │   │   │   ├── muiicons.ts
    │   │   │   ├── phosphoreicons.ts
    │   │   │   ├── radixicons.ts
    │   │   │   ├── reacticons.ts
    │   │   │   ├── remixicons.ts
    │   │   │   ├── simpleicons.ts
    │   │   │   └── tablericons.ts
    │   │   ├── language
    │   │   │   ├── ada.ts
    │   │   │   ├── aspnet.ts
    │   │   │   ├── bash.ts
    │   │   │   ├── c.ts
    │   │   │   ├── clojure.ts
    │   │   │   ├── cobol.ts
    │   │   │   ├── coffeescript.ts
    │   │   │   ├── cplusplus.ts
    │   │   │   ├── csharp.ts
    │   │   │   ├── css.ts
    │   │   │   ├── dart.ts
    │   │   │   ├── elixir.ts
    │   │   │   ├── glsl.ts
    │   │   │   ├── haskell.ts
    │   │   │   ├── index.ts
    │   │   │   ├── java.ts
    │   │   │   ├── javascript.ts
    │   │   │   ├── jsx.ts
    │   │   │   ├── kotlin.ts
    │   │   │   ├── lua.ts
    │   │   │   ├── matlab.ts
    │   │   │   ├── objectivec.ts
    │   │   │   ├── perl.ts
    │   │   │   ├── r.ts
    │   │   │   ├── scala.ts
    │   │   │   ├── scss.ts
    │   │   │   ├── swift.ts
    │   │   │   ├── typescript.ts
    │   │   │   ├── visualbasicnet.ts
    │   │   │   └── vue.ts
    │   │   ├── linter
    │   │   │   ├── biomejs.ts
    │   │   │   ├── eslint.ts
    │   │   │   ├── golangcilint.ts
    │   │   │   ├── index.ts
    │   │   │   ├── oxlint.ts
    │   │   │   ├── phpstan.ts
    │   │   │   ├── prettier.ts
    │   │   │   ├── rubocop.ts
    │   │   │   ├── sonarlint.ts
    │   │   │   ├── stylelint.ts
    │   │   │   ├── ultracite.ts
    │   │   │   └── vale.ts
    │   │   ├── maps
    │   │   │   ├── apple.maps.ts
    │   │   │   ├── azure.maps.ts
    │   │   │   ├── gcp.maps.ts
    │   │   │   ├── heremaps.ts
    │   │   │   ├── index.ts
    │   │   │   └── mapbox.ts
    │   │   ├── monitoring
    │   │   │   ├── appsignal.ts
    │   │   │   ├── aws.cloudwatch.ts
    │   │   │   ├── betterstack.ts
    │   │   │   ├── blackfire.ts
    │   │   │   ├── bugsnag.ts
    │   │   │   ├── datadog.ts
    │   │   │   ├── dynatrace.ts
    │   │   │   ├── gcp.logging.ts
    │   │   │   ├── healthchecksio.ts
    │   │   │   ├── honeybadger.ts
    │   │   │   ├── hyperdx.ts
    │   │   │   ├── index.ts
    │   │   │   ├── newrelic.ts
    │   │   │   ├── onlineornot.ts
    │   │   │   ├── opentelemetry.ts
    │   │   │   ├── papertrail.ts
    │   │   │   ├── pingdom.ts
    │   │   │   ├── prometheus.ts
    │   │   │   ├── rollbar.ts
    │   │   │   ├── scoutapm.ts
    │   │   │   ├── sentry.ts
    │   │   │   ├── signoz.ts
    │   │   │   ├── uptimekuma.ts
    │   │   │   └── zipkin.ts
    │   │   ├── network
    │   │   │   ├── gcp.dns.ts
    │   │   │   └── index.ts
    │   │   ├── notification
    │   │   │   ├── aws.ses.ts
    │   │   │   ├── aws.sns.ts
    │   │   │   ├── beehiiv.ts
    │   │   │   ├── brevo.ts
    │   │   │   ├── clicksend.ts
    │   │   │   ├── ifttt.ts
    │   │   │   ├── index.ts
    │   │   │   ├── mailchimp.ts
    │   │   │   ├── mailgun.ts
    │   │   │   ├── mailjet.ts
    │   │   │   ├── novu.ts
    │   │   │   ├── resend.ts
    │   │   │   ├── sendgrid.ts
    │   │   │   ├── twilio.ts
    │   │   │   └── zapier.ts
    │   │   ├── orm
    │   │   │   ├── dieselrs.ts
    │   │   │   ├── doctrinephp.ts
    │   │   │   ├── drizzeleorm.ts
    │   │   │   ├── goent.ts
    │   │   │   ├── gorm.ts
    │   │   │   ├── index.ts
    │   │   │   ├── knex.ts
    │   │   │   ├── kysely.ts
    │   │   │   ├── prisma.ts
    │   │   │   ├── sequelize.ts
    │   │   │   ├── sequelruby.ts
    │   │   │   ├── sqlalchemy.ts
    │   │   │   └── typeorm.ts
    │   │   ├── package_manager
    │   │   │   ├── asdf.ts
    │   │   │   ├── bundler.ts
    │   │   │   ├── cargo.ts
    │   │   │   ├── goenv.ts
    │   │   │   ├── index.ts
    │   │   │   ├── npm.ts
    │   │   │   ├── nuget.ts
    │   │   │   ├── nvm.ts
    │   │   │   ├── phpcomposer.ts
    │   │   │   ├── phpenv.ts
    │   │   │   ├── pipenv.ts
    │   │   │   ├── pnpm.ts
    │   │   │   ├── poetry.ts
    │   │   │   ├── rubyenv.ts
    │   │   │   └── yarn.ts
    │   │   ├── payment
    │   │   │   ├── adyen.ts
    │   │   │   ├── chargebee.ts
    │   │   │   ├── google.pay.ts
    │   │   │   ├── index.ts
    │   │   │   ├── intuit.ts
    │   │   │   ├── klarna.ts
    │   │   │   ├── lemonsqueezy.ts
    │   │   │   ├── paddle.ts
    │   │   │   ├── paypal.ts
    │   │   │   ├── paystack.ts
    │   │   │   ├── polarsh.ts
    │   │   │   ├── revenuecat.ts
    │   │   │   ├── squareup.ts
    │   │   │   ├── stripe.ts
    │   │   │   ├── useautumn.ts
    │   │   │   └── zuora.ts
    │   │   ├── queue
    │   │   │   ├── apacheKafka.ts
    │   │   │   ├── aws.kafka.ts
    │   │   │   ├── aws.kinesis.ts
    │   │   │   ├── aws.mq.ts
    │   │   │   ├── aws.sqs.ts
    │   │   │   ├── celery.ts
    │   │   │   ├── gcp.pubsub.ts
    │   │   │   ├── index.ts
    │   │   │   ├── nats.ts
    │   │   │   ├── rabbitmq.ts
    │   │   │   ├── scaleway.mq.ts
    │   │   │   ├── supabase.realtime.ts
    │   │   │   ├── upstash.kafka.ts
    │   │   │   └── upstash.qstash.ts
    │   │   ├── runtime
    │   │   │   ├── apacheCordova.ts
    │   │   │   ├── bunsh.ts
    │   │   │   ├── capacitorjs.ts
    │   │   │   ├── electron.ts
    │   │   │   └── index.ts
    │   │   ├── saas
    │   │   │   ├── atlassian.bitbucket.ts
    │   │   │   ├── base44.ts
    │   │   │   ├── box.ts
    │   │   │   ├── cloudinary.ts
    │   │   │   ├── docusign.ts
    │   │   │   ├── dropbox.ts
    │   │   │   ├── figma.ts
    │   │   │   ├── github.ts
    │   │   │   ├── hypertune.ts
    │   │   │   ├── index.ts
    │   │   │   ├── lago.ts
    │   │   │   ├── launchdarkly.ts
    │   │   │   ├── logrocket.ts
    │   │   │   ├── lovable.ts
    │   │   │   ├── metabase.ts
    │   │   │   ├── optimizely.ts
    │   │   │   ├── pagerduty.ts
    │   │   │   ├── placekit.ts
    │   │   │   ├── postman.ts
    │   │   │   ├── postmark.ts
    │   │   │   ├── prismacloud.ts
    │   │   │   ├── sap.ts
    │   │   │   ├── sas.ts
    │   │   │   ├── servicenow.ts
    │   │   │   ├── splitio.ts
    │   │   │   ├── splunk.ts
    │   │   │   ├── spotify.ts
    │   │   │   ├── tailscale.ts
    │   │   │   ├── veriff.ts
    │   │   │   ├── vialink.ts
    │   │   │   ├── withorb.ts
    │   │   │   ├── wolframalpha.ts
    │   │   │   └── yousign.ts
    │   │   ├── security
    │   │   │   ├── aws.kms.ts
    │   │   │   ├── checkov.ts
    │   │   │   ├── datadome.ts
    │   │   │   ├── gcp.kms.ts
    │   │   │   ├── gitguardian.ts
    │   │   │   ├── index.ts
    │   │   │   ├── infisical.ts
    │   │   │   ├── snyk.ts
    │   │   │   ├── sqreen.ts
    │   │   │   └── wiz.ts
    │   │   ├── spec
    │   │   │   ├── deno
    │   │   │   │   ├── index.ts
    │   │   │   │   ├── lockfile.test.ts
    │   │   │   │   └── lockfile.ts
    │   │   │   ├── docker
    │   │   │   │   ├── component.test.ts
    │   │   │   │   ├── component.ts
    │   │   │   │   └── index.ts
    │   │   │   ├── dotenv
    │   │   │   │   ├── index.test.ts
    │   │   │   │   ├── index.ts
    │   │   │   │   └── matcher.ts
    │   │   │   ├── githubActions
    │   │   │   │   ├── component.test.ts
    │   │   │   │   ├── component.ts
    │   │   │   │   └── index.ts
    │   │   │   ├── golang
    │   │   │   │   ├── component.test.ts
    │   │   │   │   ├── component.ts
    │   │   │   │   ├── index.ts
    │   │   │   │   ├── lockfile.test.ts
    │   │   │   │   └── lockfile.ts
    │   │   │   ├── licenses
    │   │   │   │   ├── index.test.ts
    │   │   │   │   └── index.ts
    │   │   │   ├── nodejs
    │   │   │   │   ├── component.test.ts
    │   │   │   │   ├── component.ts
    │   │   │   │   └── index.ts
    │   │   │   ├── php
    │   │   │   │   ├── component.test.ts
    │   │   │   │   ├── component.ts
    │   │   │   │   └── index.ts
    │   │   │   ├── python
    │   │   │   │   ├── index.ts
    │   │   │   │   ├── lockfile.test.ts
    │   │   │   │   └── lockfile.ts
    │   │   │   ├── ruby
    │   │   │   │   ├── index.ts
    │   │   │   │   ├── lockfile.test.ts
    │   │   │   │   └── lockfile.ts
    │   │   │   ├── rust
    │   │   │   │   ├── component.test.ts
    │   │   │   │   ├── component.ts
    │   │   │   │   └── index.ts
    │   │   │   ├── terraform
    │   │   │   │   ├── index.ts
    │   │   │   │   ├── lockfile.test.ts
    │   │   │   │   ├── lockfile.ts
    │   │   │   │   ├── resource.test.ts
    │   │   │   │   └── resource.ts
    │   │   │   ├── zig
    │   │   │   │   └── index.ts
    │   │   │   └── index.ts
    │   │   ├── ssg
    │   │   │   ├── assemble.ts
    │   │   │   ├── astro.ts
    │   │   │   ├── docsify.ts
    │   │   │   ├── docusaurus.ts
    │   │   │   ├── eleventy.ts
    │   │   │   ├── fern.ts
    │   │   │   ├── fumadocs.ts
    │   │   │   ├── gatsby.ts
    │   │   │   ├── gridsome.ts
    │   │   │   ├── hexojs.ts
    │   │   │   ├── hugo.ts
    │   │   │   ├── index.ts
    │   │   │   ├── jekyll.ts
    │   │   │   ├── mintlify.ts
    │   │   │   ├── mkdocs.ts
    │   │   │   ├── readthedocs.ts
    │   │   │   ├── slatedocs.ts
    │   │   │   ├── vitepress.ts
    │   │   │   └── vuepress.ts
    │   │   ├── storage
    │   │   │   ├── aws.cloudfront.ts
    │   │   │   ├── aws.ebs.ts
    │   │   │   ├── aws.ecr.ts
    │   │   │   ├── aws.efs.ts
    │   │   │   ├── aws.glacier.ts
    │   │   │   ├── aws.s3.ts
    │   │   │   ├── azure.storage.ts
    │   │   │   ├── cloudflare.r2.ts
    │   │   │   ├── gcp.artifactregistry.ts
    │   │   │   ├── gcp.containerregistry.ts
    │   │   │   ├── gcp.gcs.ts
    │   │   │   ├── index.ts
    │   │   │   ├── ovh.storage.ts
    │   │   │   ├── scaleway.storage.ts
    │   │   │   └── supabase.storage.ts
    │   │   ├── test
    │   │   │   ├── index.ts
    │   │   │   ├── jest.ts
    │   │   │   ├── k6.ts
    │   │   │   ├── lighthouse.ts
    │   │   │   ├── mochajs.ts
    │   │   │   ├── phppest.ts
    │   │   │   ├── phpunit.ts
    │   │   │   ├── storybook.ts
    │   │   │   ├── testinglibrary.ts
    │   │   │   └── vitest.ts
    │   │   ├── tool
    │   │   │   ├── adonisjs.ts
    │   │   │   ├── apacheThrift.ts
    │   │   │   ├── atlasgo.ts
    │   │   │   ├── bytebase.ts
    │   │   │   ├── effectjs.ts
    │   │   │   ├── elysiajs.ts
    │   │   │   ├── express.ts
    │   │   │   ├── fastify.ts
    │   │   │   ├── flyway.ts
    │   │   │   ├── gitlab.ts
    │   │   │   ├── goacmelego.ts
    │   │   │   ├── honojs.ts
    │   │   │   ├── index.ts
    │   │   │   ├── koa.ts
    │   │   │   ├── liquibase.ts
    │   │   │   ├── mailhog.ts
    │   │   │   ├── mcp.ts
    │   │   │   ├── openapi.ts
    │   │   │   ├── pytorch.ts
    │   │   │   ├── reactEmail.ts
    │   │   │   ├── socketio.ts
    │   │   │   ├── tensorflow.ts
    │   │   │   ├── trpc.ts
    │   │   │   └── twig.ts
    │   │   ├── ui_framework
    │   │   │   ├── alpinejs.ts
    │   │   │   ├── angular.ts
    │   │   │   ├── emberjs.ts
    │   │   │   ├── expojs.ts
    │   │   │   ├── htmx.ts
    │   │   │   ├── index.ts
    │   │   │   ├── infernojs.ts
    │   │   │   ├── ionic.ts
    │   │   │   ├── litjs.ts
    │   │   │   ├── mithriljs.ts
    │   │   │   ├── preactjs.ts
    │   │   │   ├── qwikjs.ts
    │   │   │   ├── react.ts
    │   │   │   ├── solidjs.ts
    │   │   │   ├── stenciljs.ts
    │   │   │   ├── sveltejs.ts
    │   │   │   ├── umijs.ts
    │   │   │   └── vue.ts
    │   │   ├── ui
    │   │   │   ├── antd.ts
    │   │   │   ├── ariakitui.ts
    │   │   │   ├── arkui.ts
    │   │   │   ├── baseui.ts
    │   │   │   ├── bootstrap.ts
    │   │   │   ├── chakraui.ts
    │   │   │   ├── codemirror.ts
    │   │   │   ├── d3js.ts
    │   │   │   ├── daisyui.ts
    │   │   │   ├── fluentui.ts
    │   │   │   ├── gradio.ts
    │   │   │   ├── headlessui.ts
    │   │   │   ├── heroui.ts
    │   │   │   ├── index.ts
    │   │   │   ├── lexicaleditor.ts
    │   │   │   ├── mantineui.ts
    │   │   │   ├── materialui.ts
    │   │   │   ├── monacoeditor.ts
    │   │   │   ├── phaserjs.ts
    │   │   │   ├── radixui.ts
    │   │   │   ├── reactRouterDom.ts
    │   │   │   ├── refinedev.ts
    │   │   │   ├── rekaui.ts
    │   │   │   ├── remixRouter.ts
    │   │   │   ├── sandpackeditor.ts
    │   │   │   ├── shadcn.ts
    │   │   │   ├── shopify.hydrogen.ts
    │   │   │   ├── tailwind.ts
    │   │   │   ├── tanstackRouter.ts
    │   │   │   └── tiptap.ts
    │   │   ├── validation
    │   │   │   ├── arktype.ts
    │   │   │   ├── index.ts
    │   │   │   ├── joijs.ts
    │   │   │   ├── jsonschema.ts
    │   │   │   ├── superstruct.ts
    │   │   │   ├── typebox.ts
    │   │   │   ├── valibot.ts
    │   │   │   └── zod.ts
    │   │   ├── all.test.ts
    │   │   ├── ci.test.ts
    │   │   ├── cloud.test.ts
    │   │   ├── files.test.ts
    │   │   ├── hosting.test.ts
    │   │   ├── index.ts
    │   │   └── quality.test.ts
    │   ├── scripts
    │   │   └── prebuild.ts
    │   ├── tests
    │   │   └── helpers.ts
    │   ├── types
    │   │   ├── index.ts
    │   │   ├── licenses.ts
    │   │   ├── rule.ts
    │   │   ├── techs.ts
    │   │   └── utils.ts
    │   ├── autoload.ts
    │   ├── cli.test.ts
    │   ├── cli.ts
    │   ├── github-action.ts
    │   ├── index.ts
    │   ├── loader.ts
    │   ├── matchAllFiles.test.ts
    │   ├── matchAllFiles.ts
    │   ├── matchDependencies.ts
    │   └── register.ts
    ├── tests
    │   └── __fixtures__
    │       └── pkgs
    │           └── app
    │               └── src
    │                   └── index.html
    ├── eslint.config.js
    └── vitest.config.ts



--- eslint.config.js ---

import lint from '@h1fra/eslint-config';

export default [
  {
    ignores: ['**/dist/', '**/node_modules/', '**/.wrangler'],
  },
  ...lint.configs.base,
  ...lint.configs.strict,
  {
    settings: {},
    rules: {
      'import-x/extensions': 'off', // does not work for some reason
      'import-x/no-extraneous-dependencies': 'off', // does not work for some reason
    },
  },
  {
    files: ['**/**.test.ts'],
    rules: {
      '@typescript-eslint/no-unsafe-assignment': 'off',
      '@typescript-eslint/no-non-null-assertion': 'off',
    },
  },
];


--- src/analyser/index.test.ts ---

import path from 'node:path';

import { beforeEach, describe, expect, it, vi } from 'vitest';

import { analyser } from './index.js';
import { flatten } from '../payload/helpers.js';
import { FakeProvider } from '../provider/fake.js';
import { FSProvider } from '../provider/fs.js';

import type { AnalyserJson } from '../types/index.js';
import '../autoload.js';

const dockerCompose = `version: '3'
services:
  db:
    container_name: db
    image: postgres:15.1-alpine
    ports:
      - '5432:5432'
    environment:
      - POSTGRES_PASSWORD=postgres
`;

let id = 0;
vi.mock('../common/nid.ts', () => {
  return { nid: () => `${id++}` };
});

describe('analyser', () => {
  beforeEach(() => {
    vi.resetAllMocks();
  });

  it('should not find anything', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': [],
        },
        files: {},
      }),
    });

    expect(res.toJson('')).toStrictEqual({
      id: expect.any(String),
      name: 'main',
      edges: [],
      inComponent: null,
      languages: {},
      path: ['/'],
      tech: null,
      techs: [],
      childs: [],
      licenses: [],
      dependencies: [],
      reason: [],
    });
  });

  it('should register only component of the same tech', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['package.json', 'docker-compose.yml'],
        },
        files: {
          '/docker-compose.yml': dockerCompose,
          '/package.json': '{ "name": "test", "dependencies": {"pg": "1.0.0"}}',
        },
      }),
    });

    const flat = flatten(res, { merge: true });
    const json: AnalyserJson = structuredClone(flat.toJson(''));

    expect(json).toMatchSnapshot();
    expect(flat.childs[0].id).toBe(flat.childs[1].edges[0].target.id);
  });

  it('should run correctly', async () => {
    const root = path.join(import.meta.dirname, '../../tests/__fixtures__');
    const res = await analyser({
      provider: new FSProvider({
        path: root,
      }),
    });

    expect(res.toJson(root)).toMatchSnapshot();

    const flatted = flatten(res, { merge: true });

    // Check that inComponent was updated
    const vercel = flatted.childs.find((child) => child.name === 'Vercel')!;
    const app = flatted.childs.find((child) => child.name === '@fake/app');

    expect(app!.inComponent!.id).toBe(vercel.id);

    // Check that edge.target was updated
    const datadog = flatted.childs.find((child) => child.name === 'Datadog')!;
    const api = flatted.childs.find((child) => child.name === '@fake/api');

    expect(api!.edges[0].target.id).toBe(datadog.id);

    expect(structuredClone(flatted.toJson(root))).toMatchSnapshot();
  });
});


--- src/analyser/index.ts ---

import { Payload } from '../payload/index.js';

import type { BaseProvider } from '../provider/base.js';

export interface AnalyserOptions {
  provider: BaseProvider;
}

export async function analyser(opts: AnalyserOptions): Promise<Payload> {
  const provider = opts.provider;
  const pl = new Payload({ name: 'main', folderPath: '/' });

  await pl.recurse(provider, provider.basePath);

  return pl;
}


--- src/autoload.ts ---

import { loadAllRules } from './loader.js';
import './rules/index.js';

loadAllRules();


--- src/cli.test.ts ---

import childProcess from 'node:child_process';
import fs from 'node:fs/promises';
import path from 'node:path';
import { promisify } from 'node:util';

import { describe, expect, it } from 'vitest';

const execFileAsync = promisify(childProcess.execFile);

describe(
  'cli',
  () => {
    it('should analyse', async () => {
      const now = new Date();

      const root = path.join(import.meta.dirname, '../');
      const file = path.join(import.meta.dirname, './cli.ts');
      const res = await execFileAsync('tsx', [file, './'], {
        env: { ...process.env, LOG_LEVEL: 'info' },
      });

      // TODO: change consola formatter
      expect(res.stdout).toBe(`[log] ▶ Path ${root}
[log]
[log] Output ${root}output.json
`);

      const stat = await fs.stat(path.join(root, 'output.json'));

      expect(stat.ctime.getTime()).toBeGreaterThan(now.getTime());
    });
  },
  {
    timeout: 10_000,
  }
);


--- src/cli.ts ---

#!/usr/bin/env node

import fs from 'node:fs/promises';
import path from 'node:path';
import timer from 'node:timers/promises';
import { fileURLToPath } from 'node:url';

import { Command } from 'commander';
import figureSet from 'figures';
import kleur from 'kleur';
import ora from 'ora';

import { analyser } from './analyser/index.js';
import { l } from './common/log.js';
import { flatten } from './payload/helpers.js';
import { FSProvider } from './provider/fs.js';

import './autoload.js';

const program = new Command();

const filename = fileURLToPath(import.meta.url);
const dirname = path.dirname(filename);
// eslint-disable-next-line unicorn/no-await-expression-member
const pkg = JSON.parse((await fs.readFile(path.join(dirname, './../package.json'))).toString()) as {
  version: string;
};

program
  .name('stack-analyser')
  .description('CLI to extract metadata from repository')
  .argument('<path>', 'repository to analyze')
  .option('-o, --output <FILENAME>', 'output json to a file', 'output.json')
  .option('--flat', 'flatten the output', false)
  .version(pkg.version)
  .action(async (arg: string, options: { output?: string; flat: boolean }) => {
    const pathAtExecution = process.cwd();
    const root = path.isAbsolute(arg) ? arg : path.join(pathAtExecution, arg);

    l.debug('Version', pkg.version);

    try {
      const stat = await fs.stat(root);
      if (!stat.isDirectory()) {
        l.log(kleur.bold().red(figureSet.cross), `Path "${root}" is not a folder`);
        process.exit(1);
      }
    } catch {
      l.log(kleur.bold().red(figureSet.cross), `Path "${root}" does not exist`);
      process.exit(1);
    }

    l.log(kleur.bold().magenta(figureSet.triangleRight), 'Path', kleur.cyan(root));

    const spinner = ora(`Analysing`).start();

    await timer.setTimeout(500);
    const res = await analyser({
      provider: new FSProvider({ path: root, ignorePaths: [] }),
    });
    spinner.succeed('Analysed');

    if (options.output) {
      const output = options.flat ? flatten(res, { merge: true }) : res;
      const file = path.join(pathAtExecution, options.output);
      await fs.writeFile(file, JSON.stringify(output.toJson(root), undefined, 2));
      l.log('');
      l.log('Output', kleur.green(file));
    }
  });

program.parse(process.argv);


--- src/common/helpers.ts ---

export function cleanPath(paths: string[], root: string): string[] {
  return paths.map((path) => path.replace(root, ''));
}


--- src/common/languages.ts ---

import path from 'node:path';

export interface LangListItem {
  extensions: string[];
  group: null | string;
  name: string;
  type: 'data' | 'markup' | 'programming' | 'prose';
}

// Source: https://github.com/github/linguist/blob/5a0c74277548122267d84283910abd5e0b89380e/lib/linguist/languages.yml#L1528
export const rawList: LangListItem[] = [
  {
    extensions: ['.bsl', '.os'],
    group: null,
    name: '1C Enterprise',
    type: 'programming',
  },
  {
    extensions: ['.2da'],
    group: null,
    name: '2-Dimensional Array',
    type: 'data',
  },
  {
    extensions: ['.4dm'],
    group: null,
    name: '4D',
    type: 'programming',
  },
  {
    extensions: ['.abap'],
    group: null,
    name: 'ABAP',
    type: 'programming',
  },
  {
    extensions: ['.asddls'],
    group: null,
    name: 'ABAP CDS',
    type: 'programming',
  },
  {
    extensions: ['.abnf'],
    group: null,
    name: 'ABNF',
    type: 'data',
  },
  {
    extensions: ['.asc', '.ash'],
    group: null,
    name: 'AGS Script',
    type: 'programming',
  },
  {
    extensions: ['.aidl'],
    group: null,
    name: 'AIDL',
    type: 'programming',
  },
  {
    extensions: ['.al'],
    group: null,
    name: 'AL',
    type: 'programming',
  },
  {
    extensions: ['.ampl', '.mod'],
    group: null,
    name: 'AMPL',
    type: 'programming',
  },
  {
    extensions: ['.g4'],
    group: null,
    name: 'ANTLR',
    type: 'programming',
  },
  {
    extensions: ['.apib'],
    group: null,
    name: 'API Blueprint',
    type: 'markup',
  },
  {
    extensions: ['.apl', '.dyalog'],
    group: null,
    name: 'APL',
    type: 'programming',
  },
  {
    extensions: ['.asl', '.dsl'],
    group: null,
    name: 'ASL',
    type: 'programming',
  },
  {
    extensions: ['.asn', '.asn1'],
    group: null,
    name: 'ASN.1',
    type: 'data',
  },
  {
    extensions: ['.asax', '.ascx', '.ashx', '.asmx', '.aspx', '.axd'],
    group: null,
    name: 'ASP.NET',
    type: 'programming',
  },
  {
    extensions: ['.dats', '.hats', '.sats'],
    group: null,
    name: 'ATS',
    type: 'programming',
  },
  {
    extensions: ['.as'],
    group: null,
    name: 'ActionScript',
    type: 'programming',
  },
  {
    extensions: ['.adb', '.ada', '.ads'],
    group: null,
    name: 'Ada',
    type: 'programming',
  },
  {
    extensions: ['.afm'],
    group: null,
    name: 'Adobe Font Metrics',
    type: 'data',
  },
  {
    extensions: ['.agda'],
    group: null,
    name: 'Agda',
    type: 'programming',
  },
  {
    extensions: ['.als'],
    group: null,
    name: 'Alloy',
    type: 'programming',
  },
  {
    extensions: ['.OutJob', '.PcbDoc', '.PrjPCB', '.SchDoc'],
    group: null,
    name: 'Altium Designer',
    type: 'data',
  },
  {
    extensions: ['.as', '.angelscript'],
    group: null,
    name: 'AngelScript',
    type: 'programming',
  },
  {
    extensions: ['.antlers.html', '.antlers.php', '.antlers.xml'],
    group: null,
    name: 'Antlers',
    type: 'markup',
  },
  {
    extensions: ['.apacheconf', '.vhost'],
    group: null,
    name: 'ApacheConf',
    type: 'data',
  },
  {
    extensions: ['.cls'],
    group: null,
    name: 'Apex',
    type: 'programming',
  },
  {
    extensions: ['.agc'],
    group: 'Assembly',
    name: 'Apollo Guidance Computer',
    type: 'programming',
  },
  {
    extensions: ['.applescript', '.scpt'],
    group: null,
    name: 'AppleScript',
    type: 'programming',
  },
  {
    extensions: ['.arc'],
    group: null,
    name: 'Arc',
    type: 'programming',
  },
  {
    extensions: ['.asciidoc', '.adoc', '.asc'],
    group: null,
    name: 'AsciiDoc',
    type: 'prose',
  },
  {
    extensions: ['.aj'],
    group: null,
    name: 'AspectJ',
    type: 'programming',
  },
  {
    extensions: ['.asm', '.a51', '.i', '.inc', '.nas', '.nasm'],
    group: null,
    name: 'Assembly',
    type: 'programming',
  },
  {
    extensions: ['.astro'],
    group: null,
    name: 'Astro',
    type: 'markup',
  },
  {
    extensions: ['.asy'],
    group: null,
    name: 'Asymptote',
    type: 'programming',
  },
  {
    extensions: ['.aug'],
    group: null,
    name: 'Augeas',
    type: 'programming',
  },
  {
    extensions: ['.ahk', '.ahkl'],
    group: null,
    name: 'AutoHotkey',
    type: 'programming',
  },
  {
    extensions: ['.au3'],
    group: null,
    name: 'AutoIt',
    type: 'programming',
  },
  {
    extensions: ['.avdl'],
    group: null,
    name: 'Avro IDL',
    type: 'data',
  },
  {
    extensions: ['.awk', '.auk', '.gawk', '.mawk', '.nawk'],
    group: null,
    name: 'Awk',
    type: 'programming',
  },
  {
    extensions: ['.bas'],
    group: null,
    name: 'BASIC',
    type: 'programming',
  },
  {
    extensions: ['.bal'],
    group: null,
    name: 'Ballerina',
    type: 'programming',
  },
  {
    extensions: ['.bat', '.cmd'],
    group: null,
    name: 'Batchfile',
    type: 'programming',
  },
  {
    extensions: ['.bf'],
    group: null,
    name: 'Beef',
    type: 'programming',
  },
  {
    extensions: ['.befunge', '.bf'],
    group: null,
    name: 'Befunge',
    type: 'programming',
  },
  {
    extensions: ['.be'],
    group: null,
    name: 'Berry',
    type: 'programming',
  },
  {
    extensions: ['.bib', '.bibtex'],
    group: 'TeX',
    name: 'BibTeX',
    type: 'markup',
  },
  {
    extensions: ['.bicep'],
    group: null,
    name: 'Bicep',
    type: 'programming',
  },
  {
    extensions: ['.bs'],
    group: null,
    name: 'Bikeshed',
    type: 'markup',
  },
  {
    extensions: ['.bison'],
    group: 'Yacc',
    name: 'Bison',
    type: 'programming',
  },
  {
    extensions: ['.bb'],
    group: null,
    name: 'BitBake',
    type: 'programming',
  },
  {
    extensions: ['.blade', '.blade.php'],
    group: null,
    name: 'Blade',
    type: 'markup',
  },
  {
    extensions: ['.bb', '.decls'],
    group: null,
    name: 'BlitzBasic',
    type: 'programming',
  },
  {
    extensions: ['.bmx'],
    group: null,
    name: 'BlitzMax',
    type: 'programming',
  },
  {
    extensions: ['.bsv'],
    group: null,
    name: 'Bluespec',
    type: 'programming',
  },
  {
    extensions: ['.boo'],
    group: null,
    name: 'Boo',
    type: 'programming',
  },
  {
    extensions: ['.bpl'],
    group: null,
    name: 'Boogie',
    type: 'programming',
  },
  {
    extensions: ['.b', '.bf'],
    group: null,
    name: 'Brainfuck',
    type: 'programming',
  },
  {
    extensions: ['.bs'],
    group: null,
    name: 'BrighterScript',
    type: 'programming',
  },
  {
    extensions: ['.brs'],
    group: null,
    name: 'Brightscript',
    type: 'programming',
  },
  {
    extensions: ['.c', '.cats', '.h', '.idc'],
    group: null,
    name: 'C',
    type: 'programming',
  },
  {
    extensions: ['.cs', '.cake', '.csx', '.linq'],
    group: null,
    name: 'C#',
    type: 'programming',
  },
  {
    extensions: [
      '.cpp',
      '.c++',
      '.cc',
      '.cp',
      '.cppm',
      '.cxx',
      '.h',
      '.h++',
      '.hh',
      '.hpp',
      '.hxx',
      '.inc',
      '.inl',
      '.ino',
      '.ipp',
      '.ixx',
      '.re',
      '.tcc',
      '.tpp',
    ],
    group: null,
    name: 'C++',
    type: 'programming',
  },
  {
    extensions: ['.c-objdump'],
    group: null,
    name: 'C-ObjDump',
    type: 'data',
  },
  {
    extensions: ['.chs'],
    group: 'Haskell',
    name: 'C2hs Haskell',
    type: 'programming',
  },
  {
    extensions: ['.cds'],
    group: null,
    name: 'CAP CDS',
    type: 'programming',
  },
  {
    extensions: ['.cil'],
    group: null,
    name: 'CIL',
    type: 'data',
  },
  {
    extensions: ['.clp'],
    group: null,
    name: 'CLIPS',
    type: 'programming',
  },
  {
    extensions: ['.cmake', '.cmake.in'],
    group: null,
    name: 'CMake',
    type: 'programming',
  },
  {
    extensions: ['.cob', '.cbl', '.ccp', '.cobol', '.cpy'],
    group: null,
    name: 'COBOL',
    type: 'programming',
  },
  {
    extensions: ['.dae'],
    group: null,
    name: 'COLLADA',
    type: 'data',
  },
  {
    extensions: ['.cson'],
    group: null,
    name: 'CSON',
    type: 'data',
  },
  {
    extensions: ['.css'],
    group: null,
    name: 'CSS',
    type: 'markup',
  },
  {
    extensions: ['.csv'],
    group: null,
    name: 'CSV',
    type: 'data',
  },
  {
    extensions: ['.cue'],
    group: null,
    name: 'CUE',
    type: 'programming',
  },
  {
    extensions: ['.w'],
    group: null,
    name: 'CWeb',
    type: 'programming',
  },
  {
    extensions: ['.cabal'],
    group: null,
    name: 'Cabal Config',
    type: 'data',
  },
  {
    extensions: ['.cdc'],
    group: null,
    name: 'Cadence',
    type: 'programming',
  },
  {
    extensions: ['.cairo'],
    group: null,
    name: 'Cairo',
    type: 'programming',
  },
  {
    extensions: ['.mligo'],
    group: 'LigoLANG',
    name: 'CameLIGO',
    type: 'programming',
  },
  {
    extensions: ['.capnp'],
    group: null,
    name: "Cap'n Proto",
    type: 'programming',
  },
  {
    extensions: ['.mss'],
    group: null,
    name: 'CartoCSS',
    type: 'programming',
  },
  {
    extensions: ['.ceylon'],
    group: null,
    name: 'Ceylon',
    type: 'programming',
  },
  {
    extensions: ['.chpl'],
    group: null,
    name: 'Chapel',
    type: 'programming',
  },
  {
    extensions: ['.ch'],
    group: null,
    name: 'Charity',
    type: 'programming',
  },
  {
    extensions: [
      '.crc32',
      '.md2',
      '.md4',
      '.md5',
      '.sha1',
      '.sha2',
      '.sha224',
      '.sha256',
      '.sha256sum',
      '.sha3',
      '.sha384',
      '.sha512',
    ],
    group: null,
    name: 'Checksums',
    type: 'data',
  },
  {
    extensions: ['.ck'],
    group: null,
    name: 'ChucK',
    type: 'programming',
  },
  {
    extensions: ['.circom'],
    group: null,
    name: 'Circom',
    type: 'programming',
  },
  {
    extensions: ['.cirru'],
    group: null,
    name: 'Cirru',
    type: 'programming',
  },
  {
    extensions: ['.clw'],
    group: null,
    name: 'Clarion',
    type: 'programming',
  },
  {
    extensions: ['.clar'],
    group: null,
    name: 'Clarity',
    type: 'programming',
  },
  {
    extensions: ['.asp'],
    group: null,
    name: 'Classic ASP',
    type: 'programming',
  },
  {
    extensions: ['.icl', '.dcl'],
    group: null,
    name: 'Clean',
    type: 'programming',
  },
  {
    extensions: ['.click'],
    group: null,
    name: 'Click',
    type: 'programming',
  },
  {
    extensions: [
      '.clj',
      '.bb',
      '.boot',
      '.cl2',
      '.cljc',
      '.cljs',
      '.cljs.hl',
      '.cljscm',
      '.cljx',
      '.hic',
    ],
    group: null,
    name: 'Clojure',
    type: 'programming',
  },
  {
    extensions: ['.soy'],
    group: null,
    name: 'Closure Templates',
    type: 'markup',
  },
  {
    extensions: ['.conllu', '.conll'],
    group: null,
    name: 'CoNLL-U',
    type: 'data',
  },
  {
    extensions: ['.ql', '.qll'],
    group: null,
    name: 'CodeQL',
    type: 'programming',
  },
  {
    extensions: ['.coffee', '._coffee', '.cake', '.cjsx', '.iced'],
    group: null,
    name: 'CoffeeScript',
    type: 'programming',
  },
  {
    extensions: ['.cfm', '.cfml'],
    group: null,
    name: 'ColdFusion',
    type: 'programming',
  },
  {
    extensions: ['.cfc'],
    group: 'ColdFusion',
    name: 'ColdFusion CFC',
    type: 'programming',
  },
  {
    extensions: ['.lisp', '.asd', '.cl', '.l', '.lsp', '.ny', '.podsl', '.sexp'],
    group: null,
    name: 'Common Lisp',
    type: 'programming',
  },
  {
    extensions: ['.cwl'],
    group: null,
    name: 'Common Workflow Language',
    type: 'programming',
  },
  {
    extensions: ['.cp', '.cps'],
    group: null,
    name: 'Component Pascal',
    type: 'programming',
  },
  {
    extensions: ['.cl'],
    group: null,
    name: 'Cool',
    type: 'programming',
  },
  {
    extensions: ['.coq', '.v'],
    group: null,
    name: 'Coq',
    type: 'programming',
  },
  {
    extensions: ['.cppobjdump', '.c++-objdump', '.c++objdump', '.cpp-objdump', '.cxx-objdump'],
    group: null,
    name: 'Cpp-ObjDump',
    type: 'data',
  },
  {
    extensions: ['.creole'],
    group: null,
    name: 'Creole',
    type: 'prose',
  },
  {
    extensions: ['.cr'],
    group: null,
    name: 'Crystal',
    type: 'programming',
  },
  {
    extensions: ['.orc', '.udo'],
    group: null,
    name: 'Csound',
    type: 'programming',
  },
  {
    extensions: ['.csd'],
    group: null,
    name: 'Csound Document',
    type: 'programming',
  },
  {
    extensions: ['.sco'],
    group: null,
    name: 'Csound Score',
    type: 'programming',
  },
  {
    extensions: ['.cu', '.cuh'],
    group: null,
    name: 'Cuda',
    type: 'programming',
  },
  {
    extensions: ['.cue'],
    group: null,
    name: 'Cue Sheet',
    type: 'data',
  },
  {
    extensions: ['.curry'],
    group: null,
    name: 'Curry',
    type: 'programming',
  },
  {
    extensions: ['.cy'],
    group: null,
    name: 'Cycript',
    type: 'programming',
  },
  {
    extensions: ['.cyp', '.cypher'],
    group: null,
    name: 'Cypher',
    type: 'programming',
  },
  {
    extensions: ['.pyx', '.pxd', '.pxi'],
    group: null,
    name: 'Cython',
    type: 'programming',
  },
  {
    extensions: ['.d', '.di'],
    group: null,
    name: 'D',
    type: 'programming',
  },
  {
    extensions: ['.d-objdump'],
    group: null,
    name: 'D-ObjDump',
    type: 'data',
  },
  {
    extensions: ['.com'],
    group: null,
    name: 'DIGITAL Command Language',
    type: 'programming',
  },
  {
    extensions: ['.dm'],
    group: null,
    name: 'DM',
    type: 'programming',
  },
  {
    extensions: ['.zone', '.arpa'],
    group: null,
    name: 'DNS Zone',
    type: 'data',
  },
  {
    extensions: ['.d'],
    group: null,
    name: 'DTrace',
    type: 'programming',
  },
  {
    extensions: ['.dfy'],
    group: null,
    name: 'Dafny',
    type: 'programming',
  },
  {
    extensions: ['.darcspatch', '.dpatch'],
    group: null,
    name: 'Darcs Patch',
    type: 'data',
  },
  {
    extensions: ['.dart'],
    group: null,
    name: 'Dart',
    type: 'programming',
  },
  {
    extensions: ['.dwl'],
    group: null,
    name: 'DataWeave',
    type: 'programming',
  },
  {
    extensions: ['.dsc'],
    group: null,
    name: 'Debian Package Control File',
    type: 'data',
  },
  {
    extensions: ['.dsc'],
    group: null,
    name: 'DenizenScript',
    type: 'programming',
  },
  {
    extensions: ['.dhall'],
    group: null,
    name: 'Dhall',
    type: 'programming',
  },
  {
    extensions: ['.diff', '.patch'],
    group: null,
    name: 'Diff',
    type: 'data',
  },
  {
    extensions: ['.x'],
    group: null,
    name: 'DirectX 3D File',
    type: 'data',
  },
  {
    extensions: ['.dockerfile'],
    group: null,
    name: 'Dockerfile',
    type: 'programming',
  },
  {
    extensions: ['.djs'],
    group: null,
    name: 'Dogescript',
    type: 'programming',
  },
  {
    extensions: ['.env'],
    group: null,
    name: 'Dotenv',
    type: 'data',
  },
  {
    extensions: ['.dylan', '.dyl', '.intr', '.lid'],
    group: null,
    name: 'Dylan',
    type: 'programming',
  },
  {
    extensions: ['.e'],
    group: null,
    name: 'E',
    type: 'programming',
  },
  {
    extensions: ['.eml', '.mbox'],
    group: null,
    name: 'E-mail',
    type: 'data',
  },
  {
    extensions: ['.ebnf'],
    group: null,
    name: 'EBNF',
    type: 'data',
  },
  {
    extensions: ['.ecl', '.eclxml'],
    group: null,
    name: 'ECL',
    type: 'programming',
  },
  {
    extensions: ['.ecl'],
    group: 'prolog',
    name: 'ECLiPSe',
    type: 'programming',
  },
  {
    extensions: ['.ejs', '.ect', '.ejs.t', '.jst'],
    group: null,
    name: 'EJS',
    type: 'markup',
  },
  {
    extensions: ['.eq'],
    group: null,
    name: 'EQ',
    type: 'programming',
  },
  {
    extensions: ['.sch', '.brd'],
    group: null,
    name: 'Eagle',
    type: 'data',
  },
  {
    extensions: ['.eb'],
    group: 'Python',
    name: 'Easybuild',
    type: 'data',
  },
  {
    extensions: ['.epj'],
    group: 'JavaScript',
    name: 'Ecere Projects',
    type: 'data',
  },
  {
    extensions: ['.editorconfig'],
    group: 'INI',
    name: 'EditorConfig',
    type: 'data',
  },
  {
    extensions: ['.edc'],
    group: null,
    name: 'Edje Data Collection',
    type: 'data',
  },
  {
    extensions: ['.e'],
    group: null,
    name: 'Eiffel',
    type: 'programming',
  },
  {
    extensions: ['.ex', '.exs'],
    group: null,
    name: 'Elixir',
    type: 'programming',
  },
  {
    extensions: ['.elm'],
    group: null,
    name: 'Elm',
    type: 'programming',
  },
  {
    extensions: ['.elv'],
    group: null,
    name: 'Elvish',
    type: 'programming',
  },
  {
    extensions: ['.el', '.emacs', '.emacs.desktop'],
    group: null,
    name: 'Emacs Lisp',
    type: 'programming',
  },
  {
    extensions: ['.em', '.emberscript'],
    group: null,
    name: 'EmberScript',
    type: 'programming',
  },
  {
    extensions: ['.erl', '.app', '.app.src', '.es', '.escript', '.hrl', '.xrl', '.yrl'],
    group: null,
    name: 'Erlang',
    type: 'programming',
  },
  {
    extensions: ['.e', '.ex'],
    group: null,
    name: 'Euphoria',
    type: 'programming',
  },
  {
    extensions: ['.fs', '.fsi', '.fsx'],
    group: null,
    name: 'F#',
    type: 'programming',
  },
  {
    extensions: ['.fst', '.fsti'],
    group: null,
    name: 'F*',
    type: 'programming',
  },
  {
    extensions: ['.flf'],
    group: null,
    name: 'FIGlet Font',
    type: 'data',
  },
  {
    extensions: ['.fx', '.flux'],
    group: null,
    name: 'FLUX',
    type: 'programming',
  },
  {
    extensions: ['.factor'],
    group: null,
    name: 'Factor',
    type: 'programming',
  },
  {
    extensions: ['.fy', '.fancypack'],
    group: null,
    name: 'Fancy',
    type: 'programming',
  },
  {
    extensions: ['.fan'],
    group: null,
    name: 'Fantom',
    type: 'programming',
  },
  {
    extensions: ['.dsp'],
    group: null,
    name: 'Faust',
    type: 'programming',
  },
  {
    extensions: ['.fnl'],
    group: null,
    name: 'Fennel',
    type: 'programming',
  },
  {
    extensions: ['.f'],
    group: null,
    name: 'Filebench WML',
    type: 'programming',
  },
  {
    extensions: ['.fs'],
    group: 'RenderScript',
    name: 'Filterscript',
    type: 'programming',
  },
  {
    extensions: ['.ftl'],
    group: null,
    name: 'Fluent',
    type: 'programming',
  },
  {
    extensions: ['.for', '.eam.fs'],
    group: null,
    name: 'Formatted',
    type: 'data',
  },
  {
    extensions: ['.fth', '.4th', '.f', '.for', '.forth', '.fr', '.frt', '.fs'],
    group: null,
    name: 'Forth',
    type: 'programming',
  },
  {
    extensions: ['.f', '.f77', '.for', '.fpp'],
    group: 'Fortran',
    name: 'Fortran',
    type: 'programming',
  },
  {
    extensions: ['.f90', '.f03', '.f08', '.f95'],
    group: 'Fortran',
    name: 'Fortran Free Form',
    type: 'programming',
  },
  {
    extensions: ['.bi', '.bas'],
    group: null,
    name: 'FreeBasic',
    type: 'programming',
  },
  {
    extensions: ['.ftl'],
    group: null,
    name: 'FreeMarker',
    type: 'programming',
  },
  {
    extensions: ['.fr'],
    group: null,
    name: 'Frege',
    type: 'programming',
  },
  {
    extensions: ['.fut'],
    group: null,
    name: 'Futhark',
    type: 'programming',
  },
  {
    extensions: ['.g', '.cnc', '.gco', '.gcode'],
    group: null,
    name: 'G-code',
    type: 'programming',
  },
  {
    extensions: ['.gaml'],
    group: null,
    name: 'GAML',
    type: 'programming',
  },
  {
    extensions: ['.gms'],
    group: null,
    name: 'GAMS',
    type: 'programming',
  },
  {
    extensions: ['.g', '.gap', '.gd', '.gi', '.tst'],
    group: null,
    name: 'GAP',
    type: 'programming',
  },
  {
    extensions: ['.gdb', '.gdbinit'],
    group: null,
    name: 'GDB',
    type: 'programming',
  },
  {
    extensions: ['.gd'],
    group: null,
    name: 'GDScript',
    type: 'programming',
  },
  {
    extensions: ['.ged'],
    group: null,
    name: 'GEDCOM',
    type: 'data',
  },
  {
    extensions: [
      '.glsl',
      '.fp',
      '.frag',
      '.frg',
      '.fs',
      '.fsh',
      '.fshader',
      '.geo',
      '.geom',
      '.glslf',
      '.glslv',
      '.gs',
      '.gshader',
      '.rchit',
      '.rmiss',
      '.shader',
      '.tesc',
      '.tese',
      '.vert',
      '.vrx',
      '.vsh',
      '.vshader',
    ],
    group: null,
    name: 'GLSL',
    type: 'programming',
  },
  {
    extensions: ['.gn', '.gni'],
    group: null,
    name: 'GN',
    type: 'data',
  },
  {
    extensions: ['.gsc', '.csc', '.gsh'],
    group: null,
    name: 'GSC',
    type: 'programming',
  },
  {
    extensions: ['.gml'],
    group: null,
    name: 'Game Maker Language',
    type: 'programming',
  },
  {
    extensions: ['.gmi'],
    group: null,
    name: 'Gemini',
    type: 'prose',
  },
  {
    extensions: ['.4gl'],
    group: null,
    name: 'Genero',
    type: 'programming',
  },
  {
    extensions: ['.per'],
    group: null,
    name: 'Genero Forms',
    type: 'markup',
  },
  {
    extensions: ['.gs'],
    group: null,
    name: 'Genie',
    type: 'programming',
  },
  {
    extensions: ['.kid'],
    group: null,
    name: 'Genshi',
    type: 'programming',
  },
  {
    extensions: ['.ebuild'],
    group: 'Shell',
    name: 'Gentoo Ebuild',
    type: 'programming',
  },
  {
    extensions: ['.eclass'],
    group: 'Shell',
    name: 'Gentoo Eclass',
    type: 'programming',
  },
  {
    extensions: [
      '.gbr',
      '.cmp',
      '.gbl',
      '.gbo',
      '.gbp',
      '.gbs',
      '.gko',
      '.gml',
      '.gpb',
      '.gpt',
      '.gtl',
      '.gto',
      '.gtp',
      '.gts',
      '.ncl',
      '.sol',
    ],
    group: null,
    name: 'Gerber Image',
    type: 'data',
  },
  {
    extensions: ['.po', '.pot'],
    group: null,
    name: 'Gettext Catalog',
    type: 'prose',
  },
  {
    extensions: ['.feature', '.story'],
    group: null,
    name: 'Gherkin',
    type: 'programming',
  },
  {
    extensions: ['.gitconfig'],
    group: 'INI',
    name: 'Git Config',
    type: 'data',
  },
  {
    extensions: ['.gleam'],
    group: null,
    name: 'Gleam',
    type: 'programming',
  },
  {
    extensions: ['.glf'],
    group: null,
    name: 'Glyph',
    type: 'programming',
  },
  {
    extensions: ['.bdf'],
    group: null,
    name: 'Glyph Bitmap Distribution Format',
    type: 'data',
  },
  {
    extensions: ['.gp', '.gnu', '.gnuplot', '.p', '.plot', '.plt'],
    group: null,
    name: 'Gnuplot',
    type: 'programming',
  },
  {
    extensions: ['.go'],
    group: null,
    name: 'Go',
    type: 'programming',
  },
  {
    extensions: ['.gdnlib', '.gdns', '.tres', '.tscn'],
    group: null,
    name: 'Godot Resource',
    type: 'data',
  },
  {
    extensions: ['.golo'],
    group: null,
    name: 'Golo',
    type: 'programming',
  },
  {
    extensions: ['.gs', '.gst', '.gsx', '.vark'],
    group: null,
    name: 'Gosu',
    type: 'programming',
  },
  {
    extensions: ['.grace'],
    group: null,
    name: 'Grace',
    type: 'programming',
  },
  {
    extensions: ['.gradle'],
    group: null,
    name: 'Gradle',
    type: 'data',
  },
  {
    extensions: ['.gf'],
    group: null,
    name: 'Grammatical Framework',
    type: 'programming',
  },
  {
    extensions: ['.gml'],
    group: null,
    name: 'Graph Modeling Language',
    type: 'data',
  },
  {
    extensions: ['.graphql', '.gql', '.graphqls'],
    group: null,
    name: 'GraphQL',
    type: 'data',
  },
  {
    extensions: ['.dot', '.gv'],
    group: null,
    name: 'Graphviz (DOT)',
    type: 'data',
  },
  {
    extensions: ['.groovy', '.grt', '.gtpl', '.gvy'],
    group: null,
    name: 'Groovy',
    type: 'programming',
  },
  {
    extensions: ['.gsp'],
    group: 'Groovy',
    name: 'Groovy Server Pages',
    type: 'programming',
  },
  {
    extensions: ['.cfg'],
    group: null,
    name: 'HAProxy',
    type: 'data',
  },
  {
    extensions: ['.hcl', '.nomad', '.tf', '.tfvars', '.workflow'],
    group: null,
    name: 'HCL',
    type: 'programming',
  },
  {
    extensions: ['.hlsl', '.cginc', '.fx', '.fxh', '.hlsli'],
    group: null,
    name: 'HLSL',
    type: 'programming',
  },
  {
    extensions: ['.hocon'],
    group: null,
    name: 'HOCON',
    type: 'data',
  },
  {
    extensions: ['.html', '.hta', '.htm', '.html.hl', '.inc', '.xht', '.xhtml'],
    group: null,
    name: 'HTML',
    type: 'markup',
  },
  {
    extensions: ['.ecr'],
    group: 'HTML',
    name: 'HTML+ECR',
    type: 'markup',
  },
  {
    extensions: ['.eex', '.html.heex', '.html.leex'],
    group: 'HTML',
    name: 'HTML+EEX',
    type: 'markup',
  },
  {
    extensions: ['.erb', '.erb.deface', '.rhtml'],
    group: 'HTML',
    name: 'HTML+ERB',
    type: 'markup',
  },
  {
    extensions: ['.phtml'],
    group: 'HTML',
    name: 'HTML+PHP',
    type: 'markup',
  },
  {
    extensions: ['.cshtml', '.razor'],
    group: 'HTML',
    name: 'HTML+Razor',
    type: 'markup',
  },
  {
    extensions: ['.http'],
    group: null,
    name: 'HTTP',
    type: 'data',
  },
  {
    extensions: ['.hxml'],
    group: null,
    name: 'HXML',
    type: 'data',
  },
  {
    extensions: ['.hack', '.hh', '.hhi'],
    group: null,
    name: 'Hack',
    type: 'programming',
  },
  {
    extensions: ['.haml', '.haml.deface'],
    group: null,
    name: 'Haml',
    type: 'markup',
  },
  {
    extensions: ['.handlebars', '.hbs'],
    group: null,
    name: 'Handlebars',
    type: 'markup',
  },
  {
    extensions: ['.hb'],
    group: null,
    name: 'Harbour',
    type: 'programming',
  },
  {
    extensions: ['.hs', '.hs-boot', '.hsc'],
    group: null,
    name: 'Haskell',
    type: 'programming',
  },
  {
    extensions: ['.hx', '.hxsl'],
    group: null,
    name: 'Haxe',
    type: 'programming',
  },
  {
    extensions: ['.q', '.hql'],
    group: null,
    name: 'HiveQL',
    type: 'programming',
  },
  {
    extensions: ['.hc'],
    group: null,
    name: 'HolyC',
    type: 'programming',
  },
  {
    extensions: ['.hy'],
    group: null,
    name: 'Hy',
    type: 'programming',
  },
  {
    extensions: ['.bf'],
    group: null,
    name: 'HyPhy',
    type: 'programming',
  },
  {
    extensions: ['.pro', '.dlm'],
    group: null,
    name: 'IDL',
    type: 'programming',
  },
  {
    extensions: ['.ipf'],
    group: null,
    name: 'IGOR Pro',
    type: 'programming',
  },
  {
    extensions: [
      '.ini',
      '.cfg',
      '.cnf',
      '.dof',
      '.lektorproject',
      '.prefs',
      '.pro',
      '.properties',
      '.url',
    ],
    group: null,
    name: 'INI',
    type: 'data',
  },
  {
    extensions: ['.irclog', '.weechatlog'],
    group: null,
    name: 'IRC log',
    type: 'data',
  },
  {
    extensions: ['.idr', '.lidr'],
    group: null,
    name: 'Idris',
    type: 'programming',
  },
  {
    extensions: ['.gitignore'],
    group: 'INI',
    name: 'Ignore List',
    type: 'data',
  },
  {
    extensions: ['.ijm'],
    group: null,
    name: 'ImageJ Macro',
    type: 'programming',
  },
  {
    extensions: ['.imba'],
    group: null,
    name: 'Imba',
    type: 'programming',
  },
  {
    extensions: ['.ni', '.i7x'],
    group: null,
    name: 'Inform 7',
    type: 'programming',
  },
  {
    extensions: ['.ink'],
    group: null,
    name: 'Ink',
    type: 'programming',
  },
  {
    extensions: ['.iss', '.isl'],
    group: null,
    name: 'Inno Setup',
    type: 'programming',
  },
  {
    extensions: ['.io'],
    group: null,
    name: 'Io',
    type: 'programming',
  },
  {
    extensions: ['.ik'],
    group: null,
    name: 'Ioke',
    type: 'programming',
  },
  {
    extensions: ['.thy'],
    group: null,
    name: 'Isabelle',
    type: 'programming',
  },
  {
    extensions: ['.ijs'],
    group: null,
    name: 'J',
    type: 'programming',
  },
  {
    extensions: ['.jcl'],
    group: null,
    name: 'JCL',
    type: 'programming',
  },
  {
    extensions: ['.flex', '.jflex'],
    group: 'Lex',
    name: 'JFlex',
    type: 'programming',
  },
  {
    extensions: [
      '.json',
      '.4DForm',
      '.4DProject',
      '.avsc',
      '.geojson',
      '.gltf',
      '.har',
      '.ice',
      '.JSON-tmLanguage',
      '.jsonl',
      '.mcmeta',
      '.tfstate',
      '.tfstate.backup',
      '.topojson',
      '.webapp',
      '.webmanifest',
      '.yy',
      '.yyp',
    ],
    group: null,
    name: 'JSON',
    type: 'data',
  },
  {
    extensions: [
      '.jsonc',
      '.code-snippets',
      '.sublime-build',
      '.sublime-commands',
      '.sublime-completions',
      '.sublime-keymap',
      '.sublime-macro',
      '.sublime-menu',
      '.sublime-mousemap',
      '.sublime-project',
      '.sublime-settings',
      '.sublime-theme',
      '.sublime-workspace',
      '.sublime_metrics',
      '.sublime_session',
    ],
    group: 'JSON',
    name: 'JSON with Comments',
    type: 'data',
  },
  {
    extensions: ['.json5'],
    group: null,
    name: 'JSON5',
    type: 'data',
  },
  {
    extensions: ['.jsonld'],
    group: null,
    name: 'JSONLD',
    type: 'data',
  },
  {
    extensions: ['.jq'],
    group: null,
    name: 'JSONiq',
    type: 'programming',
  },
  {
    extensions: ['.janet'],
    group: null,
    name: 'Janet',
    type: 'programming',
  },
  {
    extensions: ['.j'],
    group: null,
    name: 'Jasmin',
    type: 'programming',
  },
  {
    extensions: ['.java', '.jav', '.jsh'],
    group: null,
    name: 'Java',
    type: 'programming',
  },
  {
    extensions: ['.properties'],
    group: null,
    name: 'Java Properties',
    type: 'data',
  },
  {
    extensions: ['.jsp', '.tag'],
    group: 'Java',
    name: 'Java Server Pages',
    type: 'programming',
  },
  {
    extensions: [
      '.js',
      '._js',
      '.bones',
      '.cjs',
      '.es',
      '.es6',
      '.frag',
      '.gs',
      '.jake',
      '.javascript',
      '.jsb',
      '.jscad',
      '.jsfl',
      '.jslib',
      '.jsm',
      '.jspre',
      '.jss',
      '.jsx',
      '.mjs',
      '.njs',
      '.pac',
      '.sjs',
      '.ssjs',
      '.xsjs',
      '.xsjslib',
    ],
    group: null,
    name: 'JavaScript',
    type: 'programming',
  },
  {
    extensions: ['.js.erb'],
    group: 'JavaScript',
    name: 'JavaScript+ERB',
    type: 'programming',
  },
  {
    extensions: ['.snap'],
    group: null,
    name: 'Jest Snapshot',
    type: 'data',
  },
  {
    extensions: ['.mps', '.mpl', '.msd'],
    group: null,
    name: 'JetBrains MPS',
    type: 'programming',
  },
  {
    extensions: ['.jinja', '.j2', '.jinja2'],
    group: null,
    name: 'Jinja',
    type: 'markup',
  },
  {
    extensions: ['.jison'],
    group: 'Yacc',
    name: 'Jison',
    type: 'programming',
  },
  {
    extensions: ['.jisonlex'],
    group: 'Lex',
    name: 'Jison Lex',
    type: 'programming',
  },
  {
    extensions: ['.ol', '.iol'],
    group: null,
    name: 'Jolie',
    type: 'programming',
  },
  {
    extensions: ['.jsonnet', '.libsonnet'],
    group: null,
    name: 'Jsonnet',
    type: 'programming',
  },
  {
    extensions: ['.jl'],
    group: null,
    name: 'Julia',
    type: 'programming',
  },
  {
    extensions: ['.ipynb'],
    group: null,
    name: 'Jupyter Notebook',
    type: 'markup',
  },
  {
    extensions: ['.krl'],
    group: null,
    name: 'KRL',
    type: 'programming',
  },
  {
    extensions: ['.ksy'],
    group: null,
    name: 'Kaitai Struct',
    type: 'programming',
  },
  {
    extensions: ['.kak'],
    group: null,
    name: 'KakouneScript',
    type: 'programming',
  },
  {
    extensions: ['.ks'],
    group: null,
    name: 'KerboScript',
    type: 'programming',
  },
  {
    extensions: ['.kicad_pcb', '.kicad_mod', '.kicad_wks'],
    group: null,
    name: 'KiCad Layout',
    type: 'data',
  },
  {
    extensions: ['.brd'],
    group: null,
    name: 'KiCad Legacy Layout',
    type: 'data',
  },
  {
    extensions: ['.kicad_sch', '.sch'],
    group: null,
    name: 'KiCad Schematic',
    type: 'data',
  },
  {
    extensions: ['.ks'],
    group: null,
    name: 'Kickstart',
    type: 'data',
  },
  {
    extensions: ['.kit'],
    group: null,
    name: 'Kit',
    type: 'markup',
  },
  {
    extensions: ['.kt', '.ktm', '.kts'],
    group: null,
    name: 'Kotlin',
    type: 'programming',
  },
  {
    extensions: ['.csl', '.kql'],
    group: null,
    name: 'Kusto',
    type: 'data',
  },
  {
    extensions: ['.lfe'],
    group: null,
    name: 'LFE',
    type: 'programming',
  },
  {
    extensions: ['.ll'],
    group: null,
    name: 'LLVM',
    type: 'programming',
  },
  {
    extensions: ['.lol'],
    group: null,
    name: 'LOLCODE',
    type: 'programming',
  },
  {
    extensions: ['.lsl', '.lslp'],
    group: null,
    name: 'LSL',
    type: 'programming',
  },
  {
    extensions: ['.asy'],
    group: null,
    name: 'LTspice Symbol',
    type: 'data',
  },
  {
    extensions: ['.lvproj', '.lvclass', '.lvlib'],
    group: null,
    name: 'LabVIEW',
    type: 'programming',
  },
  {
    extensions: ['.lark'],
    group: null,
    name: 'Lark',
    type: 'data',
  },
  {
    extensions: ['.lasso', '.las', '.lasso8', '.lasso9'],
    group: null,
    name: 'Lasso',
    type: 'programming',
  },
  {
    extensions: ['.latte'],
    group: null,
    name: 'Latte',
    type: 'markup',
  },
  {
    extensions: ['.lean', '.hlean'],
    group: null,
    name: 'Lean',
    type: 'programming',
  },
  {
    extensions: ['.less'],
    group: null,
    name: 'Less',
    type: 'markup',
  },
  {
    extensions: ['.l', '.lex'],
    group: null,
    name: 'Lex',
    type: 'programming',
  },
  {
    extensions: ['.ligo'],
    group: 'LigoLANG',
    name: 'LigoLANG',
    type: 'programming',
  },
  {
    extensions: ['.ly', '.ily'],
    group: null,
    name: 'LilyPond',
    type: 'programming',
  },
  {
    extensions: ['.b', '.m'],
    group: null,
    name: 'Limbo',
    type: 'programming',
  },
  {
    extensions: ['.ld', '.lds', '.x'],
    group: null,
    name: 'Linker Script',
    type: 'data',
  },
  {
    extensions: ['.liquid'],
    group: null,
    name: 'Liquid',
    type: 'markup',
  },
  {
    extensions: ['.lagda'],
    group: 'Agda',
    name: 'Literate Agda',
    type: 'programming',
  },
  {
    extensions: ['.litcoffee', '.coffee.md'],
    group: 'CoffeeScript',
    name: 'Literate CoffeeScript',
    type: 'programming',
  },
  {
    extensions: ['.lhs'],
    group: 'Haskell',
    name: 'Literate Haskell',
    type: 'programming',
  },
  {
    extensions: ['.ls', '._ls'],
    group: null,
    name: 'LiveScript',
    type: 'programming',
  },
  {
    extensions: ['.xm', '.x', '.xi'],
    group: null,
    name: 'Logos',
    type: 'programming',
  },
  {
    extensions: ['.lgt', '.logtalk'],
    group: null,
    name: 'Logtalk',
    type: 'programming',
  },
  {
    extensions: ['.lookml', '.model.lkml', '.view.lkml'],
    group: null,
    name: 'LookML',
    type: 'programming',
  },
  {
    extensions: ['.ls'],
    group: null,
    name: 'LoomScript',
    type: 'programming',
  },
  {
    extensions: ['.lua', '.fcgi', '.nse', '.p8', '.pd_lua', '.rbxs', '.rockspec', '.wlua'],
    group: null,
    name: 'Lua',
    type: 'programming',
  },
  {
    extensions: ['.mumps', '.m'],
    group: null,
    name: 'M',
    type: 'programming',
  },
  {
    extensions: ['.m4', '.mc'],
    group: null,
    name: 'M4',
    type: 'programming',
  },
  {
    extensions: ['.m4'],
    group: 'M4',
    name: 'M4Sugar',
    type: 'programming',
  },
  {
    extensions: ['.matlab', '.m'],
    group: null,
    name: 'MATLAB',
    type: 'programming',
  },
  {
    extensions: ['.ms', '.mcr'],
    group: null,
    name: 'MAXScript',
    type: 'programming',
  },
  {
    extensions: ['.mlir'],
    group: null,
    name: 'MLIR',
    type: 'programming',
  },
  {
    extensions: ['.mq4', '.mqh'],
    group: null,
    name: 'MQL4',
    type: 'programming',
  },
  {
    extensions: ['.mq5', '.mqh'],
    group: null,
    name: 'MQL5',
    type: 'programming',
  },
  {
    extensions: ['.mtml'],
    group: null,
    name: 'MTML',
    type: 'markup',
  },
  {
    extensions: ['.muf', '.m'],
    group: 'Forth',
    name: 'MUF',
    type: 'programming',
  },
  {
    extensions: ['.m2'],
    group: null,
    name: 'Macaulay2',
    type: 'programming',
  },
  {
    extensions: ['.mak', '.d', '.make', '.makefile', '.mk', '.mkfile'],
    group: null,
    name: 'Makefile',
    type: 'programming',
  },
  {
    extensions: ['.mako', '.mao'],
    group: null,
    name: 'Mako',
    type: 'programming',
  },
  {
    extensions: [
      '.md',
      '.livemd',
      '.markdown',
      '.mdown',
      '.mdwn',
      '.mdx',
      '.mkd',
      '.mkdn',
      '.mkdown',
      '.ronn',
      '.scd',
      '.workbook',
    ],
    group: null,
    name: 'Markdown',
    type: 'prose',
  },
  {
    extensions: ['.marko'],
    group: null,
    name: 'Marko',
    type: 'markup',
  },
  {
    extensions: ['.mask'],
    group: null,
    name: 'Mask',
    type: 'markup',
  },
  {
    extensions: ['.mathematica', '.cdf', '.m', '.ma', '.mt', '.nb', '.nbp', '.wl', '.wlt'],
    group: null,
    name: 'Mathematica',
    type: 'programming',
  },
  {
    extensions: ['.maxpat', '.maxhelp', '.maxproj', '.mxt', '.pat'],
    group: null,
    name: 'Max',
    type: 'programming',
  },
  {
    extensions: ['.m', '.moo'],
    group: null,
    name: 'Mercury',
    type: 'programming',
  },
  {
    extensions: ['.mmd', '.mermaid'],
    group: null,
    name: 'Mermaid',
    type: 'markup',
  },
  {
    extensions: ['.metal'],
    group: null,
    name: 'Metal',
    type: 'programming',
  },
  {
    extensions: ['.dsp'],
    group: null,
    name: 'Microsoft Developer Studio Project',
    type: 'data',
  },
  {
    extensions: ['.sln'],
    group: null,
    name: 'Microsoft Visual Studio Solution',
    type: 'data',
  },
  {
    extensions: ['.minid'],
    group: null,
    name: 'MiniD',
    type: 'programming',
  },
  {
    extensions: ['.mint'],
    group: null,
    name: 'Mint',
    type: 'programming',
  },
  {
    extensions: ['.druby', '.duby', '.mirah'],
    group: null,
    name: 'Mirah',
    type: 'programming',
  },
  {
    extensions: ['.mo'],
    group: null,
    name: 'Modelica',
    type: 'programming',
  },
  {
    extensions: ['.mod'],
    group: null,
    name: 'Modula-2',
    type: 'programming',
  },
  {
    extensions: ['.i3', '.ig', '.m3', '.mg'],
    group: null,
    name: 'Modula-3',
    type: 'programming',
  },
  {
    extensions: ['.mms', '.mmk'],
    group: null,
    name: 'Module Management System',
    type: 'programming',
  },
  {
    extensions: ['.monkey', '.monkey2'],
    group: null,
    name: 'Monkey',
    type: 'programming',
  },
  {
    extensions: ['.mc'],
    group: null,
    name: 'Monkey C',
    type: 'programming',
  },
  {
    extensions: ['.moo'],
    group: null,
    name: 'Moocode',
    type: 'programming',
  },
  {
    extensions: ['.moon'],
    group: null,
    name: 'MoonScript',
    type: 'programming',
  },
  {
    extensions: ['.mo'],
    group: null,
    name: 'Motoko',
    type: 'programming',
  },
  {
    extensions: ['.asm', '.i', '.inc', '.s', '.x68'],
    group: 'Assembly',
    name: 'Motorola 68K Assembly',
    type: 'programming',
  },
  {
    extensions: ['.move'],
    group: null,
    name: 'Move',
    type: 'programming',
  },
  {
    extensions: ['.muse'],
    group: null,
    name: 'Muse',
    type: 'prose',
  },
  {
    extensions: ['.mustache'],
    group: null,
    name: 'Mustache',
    type: 'markup',
  },
  {
    extensions: ['.myt'],
    group: null,
    name: 'Myghty',
    type: 'programming',
  },
  {
    extensions: ['.nasl', '.inc'],
    group: null,
    name: 'NASL',
    type: 'programming',
  },
  {
    extensions: ['.ncl'],
    group: null,
    name: 'NCL',
    type: 'programming',
  },
  {
    extensions: ['.neon'],
    group: null,
    name: 'NEON',
    type: 'data',
  },
  {
    extensions: ['.nl'],
    group: null,
    name: 'NL',
    type: 'data',
  },
  {
    extensions: ['.nsi', '.nsh'],
    group: null,
    name: 'NSIS',
    type: 'programming',
  },
  {
    extensions: ['.nss'],
    group: null,
    name: 'NWScript',
    type: 'programming',
  },
  {
    extensions: ['.nas'],
    group: null,
    name: 'Nasal',
    type: 'programming',
  },
  {
    extensions: ['.ne', '.nearley'],
    group: null,
    name: 'Nearley',
    type: 'programming',
  },
  {
    extensions: ['.n'],
    group: null,
    name: 'Nemerle',
    type: 'programming',
  },
  {
    extensions: ['.axs', '.axi'],
    group: null,
    name: 'NetLinx',
    type: 'programming',
  },
  {
    extensions: ['.axs.erb', '.axi.erb'],
    group: null,
    name: 'NetLinx+ERB',
    type: 'programming',
  },
  {
    extensions: ['.nlogo'],
    group: null,
    name: 'NetLogo',
    type: 'programming',
  },
  {
    extensions: ['.nl', '.lisp', '.lsp'],
    group: null,
    name: 'NewLisp',
    type: 'programming',
  },
  {
    extensions: ['.nf'],
    group: null,
    name: 'Nextflow',
    type: 'programming',
  },
  {
    extensions: ['.nginx', '.nginxconf', '.vhost'],
    group: null,
    name: 'Nginx',
    type: 'data',
  },
  {
    extensions: ['.nim', '.nim.cfg', '.nimble', '.nimrod', '.nims'],
    group: null,
    name: 'Nim',
    type: 'programming',
  },
  {
    extensions: ['.ninja'],
    group: null,
    name: 'Ninja',
    type: 'data',
  },
  {
    extensions: ['.nit'],
    group: null,
    name: 'Nit',
    type: 'programming',
  },
  {
    extensions: ['.nix'],
    group: null,
    name: 'Nix',
    type: 'programming',
  },
  {
    extensions: ['.nu'],
    group: null,
    name: 'Nu',
    type: 'programming',
  },
  {
    extensions: ['.numpy', '.numpyw', '.numsc'],
    group: 'Python',
    name: 'NumPy',
    type: 'programming',
  },
  {
    extensions: ['.njk'],
    group: null,
    name: 'Nunjucks',
    type: 'markup',
  },
  {
    extensions: ['.json'],
    group: 'OpenAPI Specification v2',
    name: 'OASv2-json',
    type: 'data',
  },
  {
    extensions: ['.json'],
    group: 'OpenAPI Specification v3',
    name: 'OASv3-json',
    type: 'data',
  },
  {
    extensions: ['.ml', '.eliom', '.eliomi', '.ml4', '.mli', '.mll', '.mly'],
    group: null,
    name: 'OCaml',
    type: 'programming',
  },
  {
    extensions: ['.objdump'],
    group: null,
    name: 'ObjDump',
    type: 'data',
  },
  {
    extensions: ['.odin'],
    group: null,
    name: 'Object Data Instance Notation',
    type: 'data',
  },
  {
    extensions: ['.cls'],
    group: null,
    name: 'ObjectScript',
    type: 'programming',
  },
  {
    extensions: ['.m', '.h'],
    group: null,
    name: 'Objective-C',
    type: 'programming',
  },
  {
    extensions: ['.mm'],
    group: null,
    name: 'Objective-C++',
    type: 'programming',
  },
  {
    extensions: ['.j', '.sj'],
    group: null,
    name: 'Objective-J',
    type: 'programming',
  },
  {
    extensions: ['.odin'],
    group: null,
    name: 'Odin',
    type: 'programming',
  },
  {
    extensions: ['.omgrofl'],
    group: null,
    name: 'Omgrofl',
    type: 'programming',
  },
  {
    extensions: ['.opa'],
    group: null,
    name: 'Opa',
    type: 'programming',
  },
  {
    extensions: ['.opal'],
    group: null,
    name: 'Opal',
    type: 'programming',
  },
  {
    extensions: ['.rego'],
    group: null,
    name: 'Open Policy Agent',
    type: 'programming',
  },
  {
    extensions: ['.cl', '.opencl'],
    group: 'C',
    name: 'OpenCL',
    type: 'programming',
  },
  {
    extensions: ['.p', '.cls', '.w'],
    group: null,
    name: 'OpenEdge ABL',
    type: 'programming',
  },
  {
    extensions: ['.qasm'],
    group: null,
    name: 'OpenQASM',
    type: 'programming',
  },
  {
    extensions: ['.scad'],
    group: null,
    name: 'OpenSCAD',
    type: 'programming',
  },
  {
    extensions: ['.plist', '.glyphs'],
    group: null,
    name: 'OpenStep Property List',
    type: 'data',
  },
  {
    extensions: ['.fea'],
    group: null,
    name: 'OpenType Feature File',
    type: 'data',
  },
  {
    extensions: ['.org'],
    group: null,
    name: 'Org',
    type: 'prose',
  },
  {
    extensions: ['.ox', '.oxh', '.oxo'],
    group: null,
    name: 'Ox',
    type: 'programming',
  },
  {
    extensions: ['.oxygene'],
    group: null,
    name: 'Oxygene',
    type: 'programming',
  },
  {
    extensions: ['.oz'],
    group: null,
    name: 'Oz',
    type: 'programming',
  },
  {
    extensions: ['.p4'],
    group: null,
    name: 'P4',
    type: 'programming',
  },
  {
    extensions: ['.pddl'],
    group: null,
    name: 'PDDL',
    type: 'programming',
  },
  {
    extensions: ['.pegjs'],
    group: null,
    name: 'PEG.js',
    type: 'programming',
  },
  {
    extensions: [
      '.php',
      '.aw',
      '.ctp',
      '.fcgi',
      '.inc',
      '.php3',
      '.php4',
      '.php5',
      '.phps',
      '.phpt',
    ],
    group: null,
    name: 'PHP',
    type: 'programming',
  },
  {
    extensions: [
      '.pls',
      '.bdy',
      '.ddl',
      '.fnc',
      '.pck',
      '.pkb',
      '.pks',
      '.plb',
      '.plsql',
      '.prc',
      '.spc',
      '.sql',
      '.tpb',
      '.tps',
      '.trg',
      '.vw',
    ],
    group: null,
    name: 'PLSQL',
    type: 'programming',
  },
  {
    extensions: ['.pgsql', '.sql'],
    group: null,
    name: 'PLpgSQL',
    type: 'programming',
  },
  {
    extensions: ['.pov', '.inc'],
    group: null,
    name: 'POV-Ray SDL',
    type: 'programming',
  },
  {
    extensions: ['.pan'],
    group: null,
    name: 'Pan',
    type: 'programming',
  },
  {
    extensions: ['.psc'],
    group: null,
    name: 'Papyrus',
    type: 'programming',
  },
  {
    extensions: ['.parrot'],
    group: null,
    name: 'Parrot',
    type: 'programming',
  },
  {
    extensions: ['.pasm'],
    group: 'Parrot',
    name: 'Parrot Assembly',
    type: 'programming',
  },
  {
    extensions: ['.pir'],
    group: 'Parrot',
    name: 'Parrot Internal Representation',
    type: 'programming',
  },
  {
    extensions: ['.pas', '.dfm', '.dpr', '.inc', '.lpr', '.pascal', '.pp'],
    group: null,
    name: 'Pascal',
    type: 'programming',
  },
  {
    extensions: ['.pwn', '.inc', '.sma'],
    group: null,
    name: 'Pawn',
    type: 'programming',
  },
  {
    extensions: ['.pep'],
    group: null,
    name: 'Pep8',
    type: 'programming',
  },
  {
    extensions: ['.pl', '.al', '.cgi', '.fcgi', '.perl', '.ph', '.plx', '.pm', '.psgi', '.t'],
    group: null,
    name: 'Perl',
    type: 'programming',
  },
  {
    extensions: ['.pic', '.chem'],
    group: 'Roff',
    name: 'Pic',
    type: 'markup',
  },
  {
    extensions: ['.pkl'],
    group: null,
    name: 'Pickle',
    type: 'data',
  },
  {
    extensions: ['.l'],
    group: null,
    name: 'PicoLisp',
    type: 'programming',
  },
  {
    extensions: ['.pig'],
    group: null,
    name: 'PigLatin',
    type: 'programming',
  },
  {
    extensions: ['.pike', '.pmod'],
    group: null,
    name: 'Pike',
    type: 'programming',
  },
  {
    extensions: ['.puml', '.iuml', '.plantuml'],
    group: null,
    name: 'PlantUML',
    type: 'data',
  },
  {
    extensions: ['.pod'],
    group: null,
    name: 'Pod',
    type: 'prose',
  },
  {
    extensions: ['.pod', '.pod6'],
    group: null,
    name: 'Pod 6',
    type: 'prose',
  },
  {
    extensions: ['.pogo'],
    group: null,
    name: 'PogoScript',
    type: 'programming',
  },
  {
    extensions: ['.polar'],
    group: null,
    name: 'Polar',
    type: 'programming',
  },
  {
    extensions: ['.pony'],
    group: null,
    name: 'Pony',
    type: 'programming',
  },
  {
    extensions: ['.por'],
    group: null,
    name: 'Portugol',
    type: 'programming',
  },
  {
    extensions: ['.pcss', '.postcss'],
    group: 'CSS',
    name: 'PostCSS',
    type: 'markup',
  },
  {
    extensions: ['.ps', '.eps', '.epsi', '.pfa'],
    group: null,
    name: 'PostScript',
    type: 'markup',
  },
  {
    extensions: ['.pbt', '.sra', '.sru', '.srw'],
    group: null,
    name: 'PowerBuilder',
    type: 'programming',
  },
  {
    extensions: ['.ps1', '.psd1', '.psm1'],
    group: null,
    name: 'PowerShell',
    type: 'programming',
  },
  {
    extensions: ['.prisma'],
    group: null,
    name: 'Prisma',
    type: 'data',
  },
  {
    extensions: ['.pde'],
    group: null,
    name: 'Processing',
    type: 'programming',
  },
  {
    extensions: ['.pro'],
    group: null,
    name: 'Proguard',
    type: 'data',
  },
  {
    extensions: ['.pl', '.plt', '.pro', '.prolog', '.yap'],
    group: null,
    name: 'Prolog',
    type: 'programming',
  },
  {
    extensions: ['.pml'],
    group: null,
    name: 'Promela',
    type: 'programming',
  },
  {
    extensions: ['.spin'],
    group: null,
    name: 'Propeller Spin',
    type: 'programming',
  },
  {
    extensions: ['.proto'],
    group: null,
    name: 'Protocol Buffer',
    type: 'data',
  },
  {
    extensions: ['.textproto', '.pbt', '.pbtxt'],
    group: null,
    name: 'Protocol Buffer Text Format',
    type: 'data',
  },
  {
    extensions: ['.asc', '.pub'],
    group: null,
    name: 'Public Key',
    type: 'data',
  },
  {
    extensions: ['.jade', '.pug'],
    group: null,
    name: 'Pug',
    type: 'markup',
  },
  {
    extensions: ['.pp'],
    group: null,
    name: 'Puppet',
    type: 'programming',
  },
  {
    extensions: ['.pd'],
    group: null,
    name: 'Pure Data',
    type: 'data',
  },
  {
    extensions: ['.pb', '.pbi'],
    group: null,
    name: 'PureBasic',
    type: 'programming',
  },
  {
    extensions: ['.purs'],
    group: null,
    name: 'PureScript',
    type: 'programming',
  },
  {
    extensions: ['.arr'],
    group: null,
    name: 'Pyret',
    type: 'programming',
  },
  {
    extensions: [
      '.py',
      '.cgi',
      '.fcgi',
      '.gyp',
      '.gypi',
      '.lmi',
      '.py3',
      '.pyde',
      '.pyi',
      '.pyp',
      '.pyt',
      '.pyw',
      '.rpy',
      '.spec',
      '.tac',
      '.wsgi',
      '.xpy',
    ],
    group: null,
    name: 'Python',
    type: 'programming',
  },
  {
    extensions: ['.pytb'],
    group: 'Python',
    name: 'Python traceback',
    type: 'data',
  },
  {
    extensions: ['.qs'],
    group: null,
    name: 'Q#',
    type: 'programming',
  },
  {
    extensions: ['.qml', '.qbs'],
    group: null,
    name: 'QML',
    type: 'programming',
  },
  {
    extensions: ['.pro', '.pri'],
    group: null,
    name: 'QMake',
    type: 'programming',
  },
  {
    extensions: ['.qs'],
    group: null,
    name: 'Qt Script',
    type: 'programming',
  },
  {
    extensions: ['.r', '.rd', '.rsx'],
    group: null,
    name: 'R',
    type: 'programming',
  },
  {
    extensions: ['.raml'],
    group: null,
    name: 'RAML',
    type: 'markup',
  },
  {
    extensions: ['.rdoc'],
    group: null,
    name: 'RDoc',
    type: 'prose',
  },
  {
    extensions: ['.rbbas', '.rbfrm', '.rbmnu', '.rbres', '.rbtbar', '.rbuistate'],
    group: null,
    name: 'REALbasic',
    type: 'programming',
  },
  {
    extensions: ['.rexx', '.pprx', '.rex'],
    group: null,
    name: 'REXX',
    type: 'programming',
  },
  {
    extensions: ['.qmd', '.rmd'],
    group: null,
    name: 'RMarkdown',
    type: 'prose',
  },
  {
    extensions: ['.x'],
    group: null,
    name: 'RPC',
    type: 'programming',
  },
  {
    extensions: ['.rpgle', '.sqlrpgle'],
    group: null,
    name: 'RPGLE',
    type: 'programming',
  },
  {
    extensions: ['.spec'],
    group: null,
    name: 'RPM Spec',
    type: 'data',
  },
  {
    extensions: ['.rnh', '.rno'],
    group: null,
    name: 'RUNOFF',
    type: 'markup',
  },
  {
    extensions: ['.rkt', '.rktd', '.rktl', '.scrbl'],
    group: null,
    name: 'Racket',
    type: 'programming',
  },
  {
    extensions: ['.rl'],
    group: null,
    name: 'Ragel',
    type: 'programming',
  },
  {
    extensions: [
      '.6pl',
      '.6pm',
      '.nqp',
      '.p6',
      '.p6l',
      '.p6m',
      '.pl',
      '.pl6',
      '.pm',
      '.pm6',
      '.raku',
      '.rakumod',
      '.t',
    ],
    group: null,
    name: 'Raku',
    type: 'programming',
  },
  {
    extensions: ['.rsc'],
    group: null,
    name: 'Rascal',
    type: 'programming',
  },
  {
    extensions: ['.raw'],
    group: null,
    name: 'Raw token data',
    type: 'data',
  },
  {
    extensions: ['.res'],
    group: null,
    name: 'ReScript',
    type: 'programming',
  },
  {
    extensions: ['.re', '.rei'],
    group: null,
    name: 'Reason',
    type: 'programming',
  },
  {
    extensions: ['.religo'],
    group: 'LigoLANG',
    name: 'ReasonLIGO',
    type: 'programming',
  },
  {
    extensions: ['.reb', '.r', '.r2', '.r3', '.rebol'],
    group: null,
    name: 'Rebol',
    type: 'programming',
  },
  {
    extensions: ['.red', '.reds'],
    group: null,
    name: 'Red',
    type: 'programming',
  },
  {
    extensions: ['.cw'],
    group: null,
    name: 'Redcode',
    type: 'programming',
  },
  {
    extensions: ['.regexp', '.regex'],
    group: null,
    name: 'Regular Expression',
    type: 'data',
  },
  {
    extensions: ['.rpy'],
    group: null,
    name: "Ren'Py",
    type: 'programming',
  },
  {
    extensions: ['.rsh'],
    group: null,
    name: 'RenderScript',
    type: 'programming',
  },
  {
    extensions: ['.rtf'],
    group: null,
    name: 'Rich Text Format',
    type: 'markup',
  },
  {
    extensions: ['.ring'],
    group: null,
    name: 'Ring',
    type: 'programming',
  },
  {
    extensions: ['.riot'],
    group: null,
    name: 'Riot',
    type: 'markup',
  },
  {
    extensions: ['.robot'],
    group: null,
    name: 'RobotFramework',
    type: 'programming',
  },
  {
    extensions: [
      '.roff',
      '.1',
      '.1in',
      '.1m',
      '.1x',
      '.2',
      '.3',
      '.3in',
      '.3m',
      '.3p',
      '.3pm',
      '.3qt',
      '.3x',
      '.4',
      '.5',
      '.6',
      '.7',
      '.8',
      '.9',
      '.l',
      '.man',
      '.mdoc',
      '.me',
      '.ms',
      '.n',
      '.nr',
      '.rno',
      '.tmac',
    ],
    group: null,
    name: 'Roff',
    type: 'markup',
  },
  {
    extensions: [
      '.1',
      '.1in',
      '.1m',
      '.1x',
      '.2',
      '.3',
      '.3in',
      '.3m',
      '.3p',
      '.3pm',
      '.3qt',
      '.3x',
      '.4',
      '.5',
      '.6',
      '.7',
      '.8',
      '.9',
      '.man',
      '.mdoc',
    ],
    group: 'Roff',
    name: 'Roff Manpage',
    type: 'markup',
  },
  {
    extensions: ['.rg'],
    group: null,
    name: 'Rouge',
    type: 'programming',
  },
  {
    extensions: ['.rsc'],
    group: null,
    name: 'RouterOS Script',
    type: 'programming',
  },
  {
    extensions: [
      '.rb',
      '.builder',
      '.eye',
      '.fcgi',
      '.gemspec',
      '.god',
      '.jbuilder',
      '.mspec',
      '.pluginspec',
      '.podspec',
      '.prawn',
      '.rabl',
      '.rake',
      '.rbi',
      '.rbuild',
      '.rbw',
      '.rbx',
      '.ru',
      '.ruby',
      '.spec',
      '.thor',
      '.watchr',
    ],
    group: null,
    name: 'Ruby',
    type: 'programming',
  },
  {
    extensions: ['.rs', '.rs.in'],
    group: null,
    name: 'Rust',
    type: 'programming',
  },
  {
    extensions: ['.sas'],
    group: null,
    name: 'SAS',
    type: 'programming',
  },
  {
    extensions: ['.scss'],
    group: null,
    name: 'SCSS',
    type: 'markup',
  },
  {
    extensions: ['.te'],
    group: null,
    name: 'SELinux Policy',
    type: 'data',
  },
  {
    extensions: ['.smt2', '.smt'],
    group: null,
    name: 'SMT',
    type: 'programming',
  },
  {
    extensions: ['.sparql', '.rq'],
    group: null,
    name: 'SPARQL',
    type: 'data',
  },
  {
    extensions: ['.sqf', '.hqf'],
    group: null,
    name: 'SQF',
    type: 'programming',
  },
  {
    extensions: ['.sql', '.cql', '.ddl', '.inc', '.mysql', '.prc', '.tab', '.udf', '.viw'],
    group: null,
    name: 'SQL',
    type: 'data',
  },
  {
    extensions: ['.sql', '.db2'],
    group: null,
    name: 'SQLPL',
    type: 'programming',
  },
  {
    extensions: ['.srt'],
    group: null,
    name: 'SRecode Template',
    type: 'markup',
  },
  {
    extensions: ['.star'],
    group: null,
    name: 'STAR',
    type: 'data',
  },
  {
    extensions: ['.stl'],
    group: null,
    name: 'STL',
    type: 'data',
  },
  {
    extensions: ['.ston'],
    group: 'Smalltalk',
    name: 'STON',
    type: 'data',
  },
  {
    extensions: ['.svg'],
    group: null,
    name: 'SVG',
    type: 'data',
  },
  {
    extensions: ['.i'],
    group: null,
    name: 'SWIG',
    type: 'programming',
  },
  {
    extensions: ['.sage', '.sagews'],
    group: null,
    name: 'Sage',
    type: 'programming',
  },
  {
    extensions: ['.sls'],
    group: null,
    name: 'SaltStack',
    type: 'programming',
  },
  {
    extensions: ['.sass'],
    group: null,
    name: 'Sass',
    type: 'markup',
  },
  {
    extensions: ['.scala', '.kojo', '.sbt', '.sc'],
    group: null,
    name: 'Scala',
    type: 'programming',
  },
  {
    extensions: ['.scaml'],
    group: null,
    name: 'Scaml',
    type: 'markup',
  },
  {
    extensions: ['.scenic'],
    group: null,
    name: 'Scenic',
    type: 'programming',
  },
  {
    extensions: ['.scm', '.sch', '.sld', '.sls', '.sps', '.ss'],
    group: null,
    name: 'Scheme',
    type: 'programming',
  },
  {
    extensions: ['.sci', '.sce', '.tst'],
    group: null,
    name: 'Scilab',
    type: 'programming',
  },
  {
    extensions: ['.self'],
    group: null,
    name: 'Self',
    type: 'programming',
  },
  {
    extensions: ['.shader'],
    group: null,
    name: 'ShaderLab',
    type: 'programming',
  },
  {
    extensions: [
      '.sh',
      '.bash',
      '.bats',
      '.cgi',
      '.command',
      '.fcgi',
      '.ksh',
      '.sh.in',
      '.tmux',
      '.tool',
      '.zsh',
      '.zsh-theme',
    ],
    group: null,
    name: 'Shell',
    type: 'programming',
  },
  {
    extensions: ['.sh-session'],
    group: null,
    name: 'ShellSession',
    type: 'programming',
  },
  {
    extensions: ['.shen'],
    group: null,
    name: 'Shen',
    type: 'programming',
  },
  {
    extensions: ['.sieve'],
    group: null,
    name: 'Sieve',
    type: 'programming',
  },
  {
    extensions: ['.sfv'],
    group: 'Checksums',
    name: 'Simple File Verification',
    type: 'data',
  },
  {
    extensions: ['.sl'],
    group: null,
    name: 'Slash',
    type: 'programming',
  },
  {
    extensions: ['.ice'],
    group: null,
    name: 'Slice',
    type: 'programming',
  },
  {
    extensions: ['.slim'],
    group: null,
    name: 'Slim',
    type: 'markup',
  },
  {
    extensions: ['.cocci'],
    group: null,
    name: 'SmPL',
    type: 'programming',
  },
  {
    extensions: ['.smali'],
    group: null,
    name: 'Smali',
    type: 'programming',
  },
  {
    extensions: ['.st', '.cs'],
    group: null,
    name: 'Smalltalk',
    type: 'programming',
  },
  {
    extensions: ['.tpl'],
    group: null,
    name: 'Smarty',
    type: 'programming',
  },
  {
    extensions: ['.smithy'],
    group: null,
    name: 'Smithy',
    type: 'programming',
  },
  {
    extensions: ['.smk', '.snakefile'],
    group: 'Python',
    name: 'Snakemake',
    type: 'programming',
  },
  {
    extensions: ['.sol'],
    group: null,
    name: 'Solidity',
    type: 'programming',
  },
  {
    extensions: ['.sp', '.inc'],
    group: null,
    name: 'SourcePawn',
    type: 'programming',
  },
  {
    extensions: ['.sfd'],
    group: null,
    name: 'Spline Font Database',
    type: 'data',
  },
  {
    extensions: ['.nut'],
    group: null,
    name: 'Squirrel',
    type: 'programming',
  },
  {
    extensions: ['.stan'],
    group: null,
    name: 'Stan',
    type: 'programming',
  },
  {
    extensions: ['.ml', '.fun', '.sig', '.sml'],
    group: null,
    name: 'Standard ML',
    type: 'programming',
  },
  {
    extensions: ['.bzl', '.star'],
    group: null,
    name: 'Starlark',
    type: 'programming',
  },
  {
    extensions: ['.do', '.ado', '.doh', '.ihlp', '.mata', '.matah', '.sthlp'],
    group: null,
    name: 'Stata',
    type: 'programming',
  },
  {
    extensions: ['.st'],
    group: null,
    name: 'StringTemplate',
    type: 'markup',
  },
  {
    extensions: ['.styl'],
    group: null,
    name: 'Stylus',
    type: 'markup',
  },
  {
    extensions: ['.srt'],
    group: null,
    name: 'SubRip Text',
    type: 'data',
  },
  {
    extensions: ['.sss'],
    group: null,
    name: 'SugarSS',
    type: 'markup',
  },
  {
    extensions: ['.sc', '.scd'],
    group: null,
    name: 'SuperCollider',
    type: 'programming',
  },
  {
    extensions: ['.svelte'],
    group: null,
    name: 'Svelte',
    type: 'markup',
  },
  {
    extensions: ['.sw'],
    group: null,
    name: 'Sway',
    type: 'programming',
  },
  {
    extensions: ['.swift'],
    group: null,
    name: 'Swift',
    type: 'programming',
  },
  {
    extensions: ['.sv', '.svh', '.vh'],
    group: null,
    name: 'SystemVerilog',
    type: 'programming',
  },
  {
    extensions: ['.8xp', '.8xk', '.8xk.txt', '.8xp.txt'],
    group: null,
    name: 'TI Program',
    type: 'programming',
  },
  {
    extensions: ['.tla'],
    group: null,
    name: 'TLA',
    type: 'programming',
  },
  {
    extensions: ['.toml'],
    group: null,
    name: 'TOML',
    type: 'data',
  },
  {
    extensions: ['.sql'],
    group: null,
    name: 'TSQL',
    type: 'programming',
  },
  {
    extensions: ['.tsv'],
    group: null,
    name: 'TSV',
    type: 'data',
  },
  {
    extensions: ['.tsx'],
    group: 'TypeScript',
    name: 'TSX',
    type: 'programming',
  },
  {
    extensions: ['.txl'],
    group: null,
    name: 'TXL',
    type: 'programming',
  },
  {
    extensions: ['.talon'],
    group: null,
    name: 'Talon',
    type: 'programming',
  },
  {
    extensions: ['.tcl', '.adp', '.sdc', '.tcl.in', '.tm', '.xdc'],
    group: null,
    name: 'Tcl',
    type: 'programming',
  },
  {
    extensions: ['.tcsh', '.csh'],
    group: 'Shell',
    name: 'Tcsh',
    type: 'programming',
  },
  {
    extensions: [
      '.tex',
      '.aux',
      '.bbx',
      '.cbx',
      '.cls',
      '.dtx',
      '.ins',
      '.lbx',
      '.ltx',
      '.mkii',
      '.mkiv',
      '.mkvi',
      '.sty',
      '.toc',
    ],
    group: null,
    name: 'TeX',
    type: 'markup',
  },
  {
    extensions: ['.tea'],
    group: null,
    name: 'Tea',
    type: 'markup',
  },
  {
    extensions: ['.t'],
    group: null,
    name: 'Terra',
    type: 'programming',
  },
  {
    extensions: ['.texinfo', '.texi', '.txi'],
    group: null,
    name: 'Texinfo',
    type: 'prose',
  },
  {
    extensions: ['.txt', '.fr', '.nb', '.ncl', '.no'],
    group: null,
    name: 'Text',
    type: 'prose',
  },
  {
    extensions: ['.textile'],
    group: null,
    name: 'Textile',
    type: 'prose',
  },
  {
    extensions: ['.thrift'],
    group: null,
    name: 'Thrift',
    type: 'programming',
  },
  {
    extensions: ['.t', '.tu'],
    group: null,
    name: 'Turing',
    type: 'programming',
  },
  {
    extensions: ['.ttl'],
    group: null,
    name: 'Turtle',
    type: 'data',
  },
  {
    extensions: ['.twig'],
    group: null,
    name: 'Twig',
    type: 'markup',
  },
  {
    extensions: ['.tl'],
    group: null,
    name: 'Type Language',
    type: 'data',
  },
  {
    extensions: ['.ts', '.cts', '.mts'],
    group: null,
    name: 'TypeScript',
    type: 'programming',
  },
  {
    extensions: ['.upc'],
    group: 'C',
    name: 'Unified Parallel C',
    type: 'programming',
  },
  {
    extensions: ['.anim', '.asset', '.mask', '.mat', '.meta', '.prefab', '.unity'],
    group: null,
    name: 'Unity3D Asset',
    type: 'data',
  },
  {
    extensions: ['.s', '.ms'],
    group: 'Assembly',
    name: 'Unix Assembly',
    type: 'programming',
  },
  {
    extensions: ['.uno'],
    group: null,
    name: 'Uno',
    type: 'programming',
  },
  {
    extensions: ['.uc'],
    group: null,
    name: 'UnrealScript',
    type: 'programming',
  },
  {
    extensions: ['.ur', '.urs'],
    group: null,
    name: 'UrWeb',
    type: 'programming',
  },
  {
    extensions: ['.v'],
    group: null,
    name: 'V',
    type: 'programming',
  },
  {
    extensions: ['.bas', '.cls', '.frm', '.vba'],
    group: null,
    name: 'VBA',
    type: 'programming',
  },
  {
    extensions: ['.vbs'],
    group: null,
    name: 'VBScript',
    type: 'programming',
  },
  {
    extensions: ['.vcl'],
    group: null,
    name: 'VCL',
    type: 'programming',
  },
  {
    extensions: ['.vhdl', '.vhd', '.vhf', '.vhi', '.vho', '.vhs', '.vht', '.vhw'],
    group: null,
    name: 'VHDL',
    type: 'programming',
  },
  {
    extensions: ['.vala', '.vapi'],
    group: null,
    name: 'Vala',
    type: 'programming',
  },
  {
    extensions: ['.vdf'],
    group: null,
    name: 'Valve Data Format',
    type: 'data',
  },
  {
    extensions: ['.vtl'],
    group: null,
    name: 'Velocity Template Language',
    type: 'markup',
  },
  {
    extensions: ['.v', '.veo'],
    group: null,
    name: 'Verilog',
    type: 'programming',
  },
  {
    extensions: ['.vim', '.vba', '.vimrc', '.vmb'],
    group: null,
    name: 'Vim Script',
    type: 'programming',
  },
  {
    extensions: ['.snip', '.snippet', '.snippets'],
    group: null,
    name: 'Vim Snippet',
    type: 'markup',
  },
  {
    extensions: ['.vb', '.vbhtml'],
    group: null,
    name: 'Visual Basic .NET',
    type: 'programming',
  },
  {
    extensions: ['.cls', '.ctl', '.Dsr', '.frm'],
    group: null,
    name: 'Visual Basic 6.0',
    type: 'programming',
  },
  {
    extensions: ['.volt'],
    group: null,
    name: 'Volt',
    type: 'programming',
  },
  {
    extensions: ['.vue'],
    group: null,
    name: 'Vue',
    type: 'markup',
  },
  {
    extensions: ['.vy'],
    group: null,
    name: 'Vyper',
    type: 'programming',
  },
  {
    extensions: ['.mtl'],
    group: null,
    name: 'Wavefront Material',
    type: 'data',
  },
  {
    extensions: ['.obj'],
    group: null,
    name: 'Wavefront Object',
    type: 'data',
  },
  {
    extensions: ['.owl'],
    group: null,
    name: 'Web Ontology Language',
    type: 'data',
  },
  {
    extensions: ['.wast', '.wat'],
    group: null,
    name: 'WebAssembly',
    type: 'programming',
  },
  {
    extensions: ['.webidl'],
    group: null,
    name: 'WebIDL',
    type: 'programming',
  },
  {
    extensions: ['.vtt'],
    group: null,
    name: 'WebVTT',
    type: 'data',
  },
  {
    extensions: ['.whiley'],
    group: null,
    name: 'Whiley',
    type: 'programming',
  },
  {
    extensions: ['.mediawiki', '.wiki', '.wikitext'],
    group: null,
    name: 'Wikitext',
    type: 'prose',
  },
  {
    extensions: ['.mc'],
    group: null,
    name: 'Win32 Message File',
    type: 'data',
  },
  {
    extensions: ['.reg'],
    group: null,
    name: 'Windows Registry Entries',
    type: 'data',
  },
  {
    extensions: ['.ws'],
    group: null,
    name: 'Witcher Script',
    type: 'programming',
  },
  {
    extensions: ['.wlk'],
    group: null,
    name: 'Wollok',
    type: 'programming',
  },
  {
    extensions: ['.toc'],
    group: null,
    name: 'World of Warcraft Addon Data',
    type: 'data',
  },
  {
    extensions: ['.wren'],
    group: null,
    name: 'Wren',
    type: 'programming',
  },
  {
    extensions: ['.xbm'],
    group: 'C',
    name: 'X BitMap',
    type: 'data',
  },
  {
    extensions: ['.xpm', '.pm'],
    group: 'C',
    name: 'X PixMap',
    type: 'data',
  },
  {
    extensions: ['.x10'],
    group: null,
    name: 'X10',
    type: 'programming',
  },
  {
    extensions: ['.xc'],
    group: null,
    name: 'XC',
    type: 'programming',
  },
  {
    extensions: [
      '.xml',
      '.adml',
      '.admx',
      '.ant',
      '.axaml',
      '.axml',
      '.builds',
      '.ccproj',
      '.ccxml',
      '.clixml',
      '.cproject',
      '.cscfg',
      '.csdef',
      '.csl',
      '.csproj',
      '.ct',
      '.depproj',
      '.dita',
      '.ditamap',
      '.ditaval',
      '.dll.config',
      '.dotsettings',
      '.filters',
      '.fsproj',
      '.fxml',
      '.glade',
      '.gml',
      '.gmx',
      '.grxml',
      '.gst',
      '.hzp',
      '.iml',
      '.ivy',
      '.jelly',
      '.jsproj',
      '.kml',
      '.launch',
      '.mdpolicy',
      '.mjml',
      '.mm',
      '.mod',
      '.mxml',
      '.natvis',
      '.ncl',
      '.ndproj',
      '.nproj',
      '.nuspec',
      '.odd',
      '.osm',
      '.pkgproj',
      '.pluginspec',
      '.proj',
      '.props',
      '.ps1xml',
      '.psc1',
      '.pt',
      '.qhelp',
      '.rdf',
      '.res',
      '.resx',
      '.rss',
      '.sch',
      '.scxml',
      '.sfproj',
      '.shproj',
      '.srdf',
      '.storyboard',
      '.sublime-snippet',
      '.sw',
      '.targets',
      '.tml',
      '.tsx',
      '.ui',
      '.urdf',
      '.ux',
      '.vbproj',
      '.vcxproj',
      '.vsixmanifest',
      '.vssettings',
      '.vstemplate',
      '.vxml',
      '.wixproj',
      '.workflow',
      '.wsdl',
      '.wsf',
      '.wxi',
      '.wxl',
      '.wxs',
      '.x3d',
      '.xacro',
      '.xaml',
      '.xib',
      '.xlf',
      '.xliff',
      '.xmi',
      '.xml.dist',
      '.xmp',
      '.xproj',
      '.xsd',
      '.xspec',
      '.xul',
      '.zcml',
    ],
    group: null,
    name: 'XML',
    type: 'data',
  },
  {
    extensions: [
      '.plist',
      '.stTheme',
      '.tmCommand',
      '.tmLanguage',
      '.tmPreferences',
      '.tmSnippet',
      '.tmTheme',
    ],
    group: 'XML',
    name: 'XML Property List',
    type: 'data',
  },
  {
    extensions: ['.xsp-config', '.xsp.metadata'],
    group: null,
    name: 'XPages',
    type: 'data',
  },
  {
    extensions: ['.xpl', '.xproc'],
    group: null,
    name: 'XProc',
    type: 'programming',
  },
  {
    extensions: ['.xquery', '.xq', '.xql', '.xqm', '.xqy'],
    group: null,
    name: 'XQuery',
    type: 'programming',
  },
  {
    extensions: ['.xs'],
    group: null,
    name: 'XS',
    type: 'programming',
  },
  {
    extensions: ['.xslt', '.xsl'],
    group: null,
    name: 'XSLT',
    type: 'programming',
  },
  {
    extensions: [
      '.xojo_code',
      '.xojo_menu',
      '.xojo_report',
      '.xojo_script',
      '.xojo_toolbar',
      '.xojo_window',
    ],
    group: null,
    name: 'Xojo',
    type: 'programming',
  },
  {
    extensions: ['.xsh'],
    group: null,
    name: 'Xonsh',
    type: 'programming',
  },
  {
    extensions: ['.xtend'],
    group: null,
    name: 'Xtend',
    type: 'programming',
  },
  {
    extensions: [
      '.yml',
      '.mir',
      '.reek',
      '.rviz',
      '.sublime-syntax',
      '.syntax',
      '.yaml',
      '.yaml-tmlanguage',
      '.yaml.sed',
      '.yml.mysql',
    ],
    group: null,
    name: 'YAML',
    type: 'data',
  },
  {
    extensions: ['.yang'],
    group: null,
    name: 'YANG',
    type: 'data',
  },
  {
    extensions: ['.yar', '.yara'],
    group: null,
    name: 'YARA',
    type: 'programming',
  },
  {
    extensions: ['.yasnippet'],
    group: null,
    name: 'YASnippet',
    type: 'markup',
  },
  {
    extensions: ['.y', '.yacc', '.yy'],
    group: null,
    name: 'Yacc',
    type: 'programming',
  },
  {
    extensions: ['.yul'],
    group: null,
    name: 'Yul',
    type: 'programming',
  },
  {
    extensions: ['.zap', '.xzap'],
    group: null,
    name: 'ZAP',
    type: 'programming',
  },
  {
    extensions: ['.zil', '.mud'],
    group: null,
    name: 'ZIL',
    type: 'programming',
  },
  {
    extensions: ['.zeek', '.bro'],
    group: null,
    name: 'Zeek',
    type: 'programming',
  },
  {
    extensions: ['.zs'],
    group: null,
    name: 'ZenScript',
    type: 'programming',
  },
  {
    extensions: ['.zep'],
    group: null,
    name: 'Zephir',
    type: 'programming',
  },
  {
    extensions: ['.zig'],
    group: null,
    name: 'Zig',
    type: 'programming',
  },
  {
    extensions: ['.zimpl', '.zmpl', '.zpl'],
    group: null,
    name: 'Zimpl',
    type: 'programming',
  },
  {
    extensions: ['.desktop', '.desktop.in', '.service'],
    group: null,
    name: 'desktop',
    type: 'data',
  },
  {
    extensions: ['.dircolors'],
    group: null,
    name: 'dircolors',
    type: 'data',
  },
  {
    extensions: ['.ec', '.eh'],
    group: null,
    name: 'eC',
    type: 'programming',
  },
  {
    extensions: ['.edn'],
    group: null,
    name: 'edn',
    type: 'data',
  },
  {
    extensions: ['.fish'],
    group: 'Shell',
    name: 'fish',
    type: 'programming',
  },
  {
    extensions: ['.hoon'],
    group: null,
    name: 'hoon',
    type: 'programming',
  },
  {
    extensions: ['.jq'],
    group: null,
    name: 'jq',
    type: 'programming',
  },
  {
    extensions: ['.kv'],
    group: null,
    name: 'kvlang',
    type: 'markup',
  },
  {
    extensions: ['.mrc'],
    group: null,
    name: 'mIRC Script',
    type: 'programming',
  },
  {
    extensions: ['.mcfunction'],
    group: null,
    name: 'mcfunction',
    type: 'programming',
  },
  {
    extensions: ['.mu'],
    group: null,
    name: 'mupad',
    type: 'programming',
  },
  {
    extensions: ['.nanorc'],
    group: 'INI',
    name: 'nanorc',
    type: 'data',
  },
  {
    extensions: ['.nc'],
    group: null,
    name: 'nesC',
    type: 'programming',
  },
  {
    extensions: ['.ooc'],
    group: null,
    name: 'ooc',
    type: 'programming',
  },
  {
    extensions: ['.q'],
    group: null,
    name: 'q',
    type: 'programming',
  },
  {
    extensions: ['.rst', '.rest', '.rest.txt', '.rst.txt'],
    group: null,
    name: 'reStructuredText',
    type: 'prose',
  },
  {
    extensions: ['.sed'],
    group: null,
    name: 'sed',
    type: 'programming',
  },
  {
    extensions: ['.wdl'],
    group: null,
    name: 'wdl',
    type: 'programming',
  },
  {
    extensions: ['.wisp'],
    group: null,
    name: 'wisp',
    type: 'programming',
  },
  {
    extensions: ['.prg', '.ch', '.prw'],
    group: null,
    name: 'xBase',
    type: 'programming',
  },
];

export const languages = rawList.filter((l) => l.type === 'programming');
export const others = rawList.filter((l) => l.type !== 'programming');

/**
 * Detect language of a file at this level.
 */
export function detectLang(filename: string): LangListItem | null {
  const ext = path.extname(filename);

  for (const lang of languages) {
    if (!lang.extensions.includes(ext)) {
      continue;
    }

    return lang;
  }

  for (const lang of others) {
    if (!lang.extensions.includes(ext)) {
      continue;
    }

    return lang;
  }

  return null;
}


--- src/common/log.ts ---

import { consola } from 'consola';

import type { LogLevel } from 'consola';

export const l = consola.create({
  level: (process.env.LOG_LEVEL || process.env.CONSOLA_LEVEL || 'info') as unknown as LogLevel,
});


--- src/common/nid.ts ---

import { customAlphabet } from 'nanoid/non-secure';

export const alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
export const minSize = 10;
export const maxSize = 12;
export const nid = customAlphabet(alphabet, maxSize);


--- src/common/rules/matchFiles.ts ---

import { listIndexed } from '../../register.js';

import type { Rule } from '../../index.js';
import type { ProviderFile } from '../../provider/base.js';
import type { AllowedKeys } from '../../types/techs.js';

export function matchFiles({
  key,
  files,
  matches,
  matchFullPath,
}: {
  key: AllowedKeys;
  files: ProviderFile[];
  matches: string[];
  matchFullPath?: boolean;
}): [Rule, string] | false {
  for (const file of files) {
    const name = matchFullPath ? file.fp : file.name;
    if (matches.includes(name)) {
      return [listIndexed[key], name];
    }
  }

  return false;
}

export function matchFilesRegex({
  key,
  files,
  match,
  matchFullPath,
}: {
  key: AllowedKeys;
  files: ProviderFile[];
  match: RegExp;
  matchFullPath?: boolean;
}): [Rule, string] | false {
  for (const file of files) {
    const name = matchFullPath ? file.fp : file.name;
    if (match.test(name)) {
      return [listIndexed[key], name];
    }
  }

  return false;
}

export function matchExtensions({
  key,
  list,
  extensions,
}: {
  key: AllowedKeys;
  list: string[];
  extensions: Set<string>;
}): [Rule, string] | false {
  for (const ext of list) {
    if (extensions.has(ext)) {
      return [listIndexed[key], ext];
    }
  }

  return false;
}


--- src/github-action.ts ---

/* eslint-disable unicorn/filename-case */
import fs from 'node:fs/promises';
import path from 'node:path';

import { setFailed } from '@actions/core';

import { l } from './common/log.js';
import { FSProvider, analyser } from './index.js';
import './autoload.js';

try {
  l.log('Starting Stack Analyser');

  // Because we exec the GitHub Action in a docker env the repo path is in the env var
  const workspace = process.env.GITHUB_WORKSPACE!;
  l.log('workspace', workspace);

  if (!workspace) {
    throw new Error('No workspace env specified');
  }

  // Analyze
  const res = await analyser({
    provider: new FSProvider({ path: workspace }),
  });

  l.log('Result:', res.toJson(workspace));

  // Output to file
  const file = path.join(workspace, 'stack-output.json');
  l.log('Output to file', file);

  await fs.writeFile(file, JSON.stringify(res.toJson(workspace), undefined, 2));

  l.log('Done');
} catch (err: unknown) {
  if (err instanceof Error) {
    setFailed(err.message);
  } else {
    setFailed('Unknown error');
  }
}


--- src/index.ts ---

import { detectLang, rawList as languageList } from './common/languages.js';
import { listIndexed, listTech } from './common/techs.generated.js';
import { dependencies as dependenciesList, loadAllRules, loadOne, rawList } from './loader.js';
import { matchAllFiles } from './matchAllFiles.js';
import { matchDependencies } from './matchDependencies.js';
import { register, registeredRules, registeredTech } from './register.js';

export const rules = {
  register,
  list: registeredRules,
  loadAll: loadAllRules,
  loadOne,
};
export const dependencies = {
  detect: matchDependencies,
  raw: rawList,
  list: dependenciesList,
};

export const tech = {
  detectInFileList: matchAllFiles,
  indexed: listIndexed,
  list: listTech,
  keys: registeredTech,
};

export const lang = {
  detect: detectLang,
  list: languageList,
};

export { analyser } from './analyser/index.js';
export type { LangListItem } from './common/languages.js';
export {
  findEdgesInDependencies,
  findHosting,
  findImplicitComponent,
  flatten,
} from './payload/helpers.js';
export { Payload } from './payload/index.js';

export type { BaseProvider, ProviderFile } from './provider/base.js';
export { FakeProvider } from './provider/fake.js';
export type { FSProviderOptions } from './provider/fs.js';
export { FSProvider } from './provider/fs.js';
export type { Analyser, AnalyserJson, Dependency, GraphEdge } from './types/index.js';

export type { SupportedDeps } from './types/rule.js';
export type {
  ComponentMatcher,
  Rule,
  RuleDependency,
  RuleWithFile,
  TechMatcher,
} from './types/rule.js';
export type { AllowedKeys, TechItem, TechType } from './types/techs.js';


--- src/loader.ts ---

import { matchExtensions, matchFiles, matchFilesRegex } from './common/rules/matchFiles.js';
import { registeredRules } from './register.js';
import { matchDotEnv } from './rules/spec/dotenv/matcher.js';

import type {
  ComponentMatcher,
  DotEnvMatcher,
  ExtensionMatcher,
  Rule,
  RuleDependency,
  RuleWithDotEnv,
  RuleWithFile,
  SupportedDeps,
  TechMatcher,
} from './types/rule.js';
import type { AllowedKeys } from './types/techs.js';

export const rulesTechs: TechMatcher[] = [];
export const rulesExtensions: ExtensionMatcher[] = [];
export const rulesDotEnv: DotEnvMatcher[] = [];
export const rulesComponents: ComponentMatcher[] = [];

export const dependencies: Record<SupportedDeps, { match: RegExp; tech: AllowedKeys }[]> = {
  'terraform.resource': [],
  deno: [],
  docker: [],
  golang: [],
  npm: [],
  php: [],
  python: [],
  ruby: [],
  rust: [],
  terraform: [],
  githubAction: [],
};

export const rawList: (
  | ({ ref: RuleDependency } & { type: 'dependency' })
  | ({ ref: RuleWithDotEnv } & { type: 'dotenv' })
  | ({ ref: RuleWithFile } & { type: 'ext' })
  | ({ ref: RuleWithFile } & { type: 'file' })
)[] = [];

export function loadAllRules(): void {
  for (const rule of registeredRules) {
    loadOne(rule);
  }

  // console.debug('Loaded', registeredRules.length, 'rules');
}

export function loadOne(rule: Rule): void {
  if (rule.dependencies) {
    rule.dependencies.map((dep) => {
      if (dep.name === '') {
        throw new Error(`empty dependency name for ${rule.name} (${rule.type} > ${rule.tech})`);
      }
      dependencies[dep.type].push({
        match: typeof dep.name === 'string' ? new RegExp(`^${dep.name}$`) : dep.name,
        tech: rule.tech,
      });
      rawList.push({ type: 'dependency', ref: dep });
    });
  }

  if (rule.files !== undefined) {
    let matcher: TechMatcher;
    if (Array.isArray(rule.files)) {
      matcher = (files) => {
        return matchFiles({
          key: rule.tech,
          files,
          matches: rule.files as string[],
          matchFullPath: 'matchFullPath' in rule ? rule.matchFullPath : false,
        });
      };
    } else {
      matcher = (files) => {
        return matchFilesRegex({
          key: rule.tech,
          files,
          match: rule.files as RegExp,
          matchFullPath: 'matchFullPath' in rule ? rule.matchFullPath : false,
        });
      };
    }

    rawList.push({ type: 'file', ref: rule });
    rulesTechs.push(matcher);
  }

  if (rule.extensions !== undefined) {
    const matcher: ExtensionMatcher = (list) => {
      return matchExtensions({ key: rule.tech, list: rule.extensions!, extensions: list });
    };

    rawList.push({ type: 'ext', ref: rule });
    rulesExtensions.push(matcher);
  }

  if (Array.isArray(rule.dotenv) && rule.dotenv.length > 0) {
    const matcher: DotEnvMatcher = (content) => {
      return matchDotEnv({ key: rule.tech, list: rule.dotenv!, content });
    };

    rawList.push({ type: 'dotenv', ref: rule as RuleWithDotEnv });
    rulesDotEnv.push(matcher);
  }

  if (rule.detect) {
    rulesComponents.push(...(Array.isArray(rule.detect) ? rule.detect : [rule.detect]));
  }
}


--- src/matchAllFiles.test.ts ---

import { describe, expect, it } from 'vitest';

import { matchAllFiles } from './matchAllFiles.js';
import './autoload.js';

describe('matchAllFiles', () => {
  it('should find nothing', () => {
    const res = matchAllFiles([], '/');

    expect(res).toStrictEqual(new Map());
  });

  it('should find extension based matching: typescript', () => {
    const res = matchAllFiles([{ fp: '/index.tsx', name: 'index.tsx', type: 'file' }], '/');

    const exp = new Map();
    exp.set('typescript', ['matched extension: .tsx']);
    exp.set('jsx', ['matched extension: .tsx']);

    expect(res).toStrictEqual(exp);
  });

  it('should find file based matching: nodejs', () => {
    const res = matchAllFiles([{ fp: '/package.json', name: 'package.json', type: 'file' }], '/');

    const exp = new Map();
    exp.set('nodejs', ['matched file: package.json']);

    expect(res).toStrictEqual(exp);
  });
});


--- src/matchAllFiles.ts ---

import path from 'node:path';

import { rulesExtensions, rulesTechs } from './loader.js';

import type { AllowedKeys, ProviderFile } from './index.js';

export function matchAllFiles(files: ProviderFile[], basePath: string): Map<AllowedKeys, string[]> {
  const matched = new Map<AllowedKeys, string[]>();

  // Match files
  for (const rule of rulesTechs) {
    const res = rule(files);
    if (res === false) {
      continue;
    }

    matched.set(res[0].tech, [`matched file: ${res[1].replace(basePath, '')}`]);
  }

  // Match extensions
  const exts = new Set<string>();
  for (const file of files) {
    exts.add(path.extname(file.name));
  }
  for (const rule of rulesExtensions) {
    const res = rule(exts);
    if (res === false) {
      continue;
    }
    if (matched.has(res[0].tech)) {
      continue;
    }

    matched.set(res[0].tech, [`matched extension: ${res[1]}`]);
  }

  return matched;
}


--- src/matchDependencies.ts ---

import { dependencies } from './loader.js';

import type { AllowedKeys, SupportedDeps } from './index.js';

export function matchDependencies(pkgs: string[], type: SupportedDeps): Map<AllowedKeys, string[]> {
  const matched = new Map<AllowedKeys, string[]>();
  for (const dep of pkgs) {
    for (const ref of dependencies[type]) {
      if (ref.match.test(dep)) {
        if (matched.has(ref.tech)) {
          matched.set(ref.tech, [...matched.get(ref.tech)!, `matched: ${ref.tech}`]);
        } else {
          matched.set(ref.tech, [`${ref.tech} matched: ${ref.match}`]);
        }
      }
    }
  }

  return matched;
}


--- src/payload/helpers.test.ts ---

import { describe, expect, it } from 'vitest';

import { findEdgesInDependencies, flatten } from './helpers.js';
import { Payload } from './index.js';
import '../autoload.js';

describe('findEdgesInDependencies', () => {
  it('should find an edge', () => {
    const main = new Payload({ id: '1', name: 'main', folderPath: '' });
    main.childs.push(
      new Payload({ id: '2', name: '2', folderPath: '/' }),
      new Payload({
        id: '3',
        name: '3',
        folderPath: '/',
        dependencies: [['npm', '2', '0.0.0']],
      })
    );

    findEdgesInDependencies(main);

    expect(main).toMatchSnapshot();
  });
});

describe('flatten', () => {
  it('should flatten and merge dependencies', () => {
    const main = new Payload({ id: '1', name: 'main', folderPath: '' });
    const sub = new Payload({
      id: '2',
      name: '2',
      folderPath: '/',
      dependencies: [['npm', 'aa', '0.0.0']],
    });
    sub.childs.push(
      new Payload({
        id: '3',
        name: '3',
        folderPath: '/',
        dependencies: [['npm', 'bb', '0.0.0']],
      })
    );
    main.childs.push(sub);

    const flat = flatten(main, { merge: true });

    expect(flat.id).not.toBe(main.id);

    flat.id = 'new';

    expect(flat.toJson('')).toMatchSnapshot();
  });

  it('should flatten and merge host', () => {
    const main = new Payload({ id: '1', name: 'main', folderPath: '' });

    // first component
    const host1 = new Payload({
      id: '4',
      name: '4',
      folderPath: '/',
      tech: 'vercel',
    });
    const sub1 = new Payload({
      id: '2',
      name: '2',
      folderPath: '/',
    });
    sub1.childs.push(host1);
    sub1.inComponent = host1;

    // second component
    const host2 = new Payload({
      id: '5',
      name: '5',
      folderPath: '/',
      tech: 'vercel',
    });
    const sub2 = new Payload({
      id: '6',
      name: '6',
      folderPath: '/',
    });
    sub2.childs.push(host2);
    sub2.inComponent = host2;

    // Push everything into main
    main.childs.push(sub1, sub2);

    const flat = flatten(main, { merge: true });
    flat.id = 'new';

    expect(flat.toJson('')).toMatchSnapshot();
    expect(flat.childs[1].inComponent!.id).toBe('4');
    expect(flat.childs[2].inComponent!.id).toBe('4');
  });

  it('should flatten but not merge', () => {
    const main = new Payload({ id: '1', name: 'main', folderPath: '' });

    // first component
    const host1 = new Payload({
      id: '4',
      name: '4',
      folderPath: '/',
      tech: 'vercel',
    });
    const sub1 = new Payload({
      id: '2',
      name: '2',
      folderPath: '/',
    });
    sub1.childs.push(host1);
    sub1.inComponent = host1;

    // second component
    const host2 = new Payload({
      id: '5',
      name: '5',
      folderPath: '/',
      tech: 'vercel',
    });
    const sub2 = new Payload({
      id: '6',
      name: '6',
      folderPath: '/',
    });
    sub2.childs.push(host2);
    sub2.inComponent = host2;

    // Push everything into main
    main.childs.push(sub1, sub2);

    const flat = flatten(main, { merge: false });
    flat.id = 'new';

    expect(flat.toJson('')).toMatchSnapshot();
    expect(flat.childs[1].inComponent!.id).toBe('4');
    expect(flat.childs[2].inComponent!.id).toBe('4');
  });
});


--- src/payload/helpers.ts ---

import { listIndexed } from '../register.js';
import { Payload } from './index.js';

import type { AllowedKeys, TechType } from '../types/techs.js';

const notAComponent = new Set<TechType>([
  'ci',
  'language',
  'runtime',
  'tool',
  'framework',
  'validation',
  'builder',
  'linter',
  'test',
  'orm',
  'package_manager',
  'orm',
  'ui',
  'ui_framework',
  'iac',
]);

/**
 * When receive a tech in a component, we can deduct a new Component that was missing
 * For example we receive:
 *  - "pg" from a package.json
 *  - we deduct there is a Postgresql
 *  - Create an eponymous component
 *
 * Obviously there could be some false positive.
 */
export function findImplicitComponent({
  pl,
  tech,
  reason,
}: {
  pl: Payload;
  tech: AllowedKeys;
  reason: string[];
}): void {
  const ref = listIndexed[tech];
  if (notAComponent.has(ref.type)) {
    return;
  }

  const comp = new Payload({
    name: ref.name,
    tech: tech,
    folderPath: pl.path,
    parent: pl,
    reason,
  });
  pl.addChild(comp);
  if (ref.type !== 'hosting' && ref.type !== 'cloud') {
    pl.addEdges(comp);
  }
}

/**
 * When receive a tech in a component, we can deduct a new Hosting that was missing
 * For example we receive:
 *  - "vercel" from a folder named .vercel
 *  - we deduct this component is hosted by Vercel
 *  - Create an eponymous component
 *
 * Obviously there could be some false positive.
 */
export function findHosting(pl: Payload, tech: AllowedKeys): void {
  const ref = listIndexed[tech];
  if (ref.type !== 'hosting' && ref.type !== 'cloud') {
    return;
  }

  const find = pl.childs.find((c) => c.tech === ref.tech);
  if (!find) {
    throw new Error(`cant find hosting ${ref.tech}`);
  }

  pl.inComponent = find;
}

/**
 * Some edges can be found in the dependencies, i.e:
 * - in monorepo or in some language you can have many folders and import another folder.
 *
 * We try to find those import, using only the dependencies (not opening the code),
 * it can lead to some false positive with very generic names.
 */
export function findEdgesInDependencies(pl: Payload): void {
  const names = new Set<string>();
  for (const child of pl.childs) names.add(child.name);

  for (const child of pl.childs) {
    for (const dep of child.dependencies) {
      const name = dep[1];
      if (!names.has(name)) {
        continue;
      }

      // Self referencing
      if (name === child.name || name === child.tech) {
        continue;
      }

      // Check if we already added an edge about that
      const already = child.edges.find((edge) => edge.target.name === name);
      if (already) {
        continue;
      }

      child.addEdges(pl.childs.find((c) => c.name === name)!);
    }
  }
}

function pushChilds(src: Payload, dest: Payload): void {
  for (const pl of src.childs) {
    const cp = pl.copy();
    pushChilds(cp, dest);
    cp.childs = [];
    dest.childs.push(cp);
  }
}

/**
 * flatten takes a nested Payload and brings everything down to a single level.
 * It deduplicates components that are strictly similar, and keep references in path.
 *
 * If merge = true, it merges all fields that can be merged down to the parent (e.g: dependencies).
 * Merging is only useful to get a summary of everything at the root level.
 */
export function flatten(src: Payload, options: { merge?: boolean } = {}): Payload {
  // Generate a flat list of childs
  const merge = options.merge || false;
  const dest = new Payload({ name: 'flatten', folderPath: '/' });
  pushChilds(src, dest);

  // Find and merge duplicates
  const duplicates: string[] = [];
  for (const childA of dest.childs) {
    if (duplicates.includes(childA.id)) {
      continue;
    }

    // Check against other child
    for (const childB of dest.childs) {
      if (childA.id === childB.id) {
        continue;
      }
      if (childA.tech === null || childB.tech === null) {
        continue;
      }
      if (childA.name !== childB.name && childA.tech !== childB.tech) {
        continue;
      }

      duplicates.push(childB.id);
      childA.combine(childB);

      // Update outdated ref
      for (const childC of dest.childs) {
        if (childC.inComponent?.id === childB.id) {
          childC.inComponent = childA;
        }
        if (childC.parent?.id === childB.id) {
          childC.inComponent = childA;
        }

        for (const edge of childC.edges) {
          if (edge.target.id === childB.id) {
            edge.target = childA;
          }
        }
      }
    }
  }

  // Remove duplicates
  dest.childs = dest.childs.filter((child) => {
    return !duplicates.includes(child.id);
  });

  findEdgesInDependencies(dest);

  // Combine everything with their respective parent
  if (merge === true) {
    for (const child of dest.childs) {
      if (child.parent) {
        child.parent.combine(child);
      }

      dest.combine(child);
    }

    dest.combine(src);
  }

  return dest;
}


--- src/payload/index.test.ts ---

import { describe, expect, it, vi } from 'vitest';

import { matchAllFiles } from '../matchAllFiles.js';
import { Payload } from './index.js';
import '../autoload.js';

let id = 0;
vi.mock('../common/nid.ts', () => {
  return { nid: () => `${id++}` };
});

describe('payload', () => {
  it('should detect nested dependencies', () => {
    const root = new Payload({ name: 'root', folderPath: '/' });
    root.addChild(new Payload({ name: 'PubSub', folderPath: '/', tech: 'gcp.pubsub' }));

    expect(root.toJson()).toMatchSnapshot();
  });

  it('should reuse correctly nested dependency', () => {
    const root = new Payload({ name: 'root', folderPath: '/' });
    root.addChild(new Payload({ name: 'GCP manual', folderPath: '', tech: 'gcp' }));
    root.addChild(new Payload({ name: 'PubSub', folderPath: '/', tech: 'gcp.pubsub' }));

    expect(root.childs[0].name).toBe('GCP manual');
    expect(root.childs[0].id).toBe('4');
    expect(root.childs[1].name).toBe('PubSub');
    expect(root.childs[1].id).toBe('5');
    expect(root.childs[1].inComponent!.id).toBe('4');
  });

  it('should dedup child and path', () => {
    const root = new Payload({ name: 'root', folderPath: '/' });
    root.addChild(new Payload({ name: 'GCP1', folderPath: 'foo', tech: 'gcp' }));
    root.addChild(new Payload({ name: 'GCP2', folderPath: 'foo', tech: 'gcp' }));
    root.addChild(new Payload({ name: 'GCP3', folderPath: 'bar.xml', tech: 'gcp' }));

    expect(root.childs).toHaveLength(1);
    expect(root.childs[0].path).toStrictEqual(new Set(['foo', 'bar.xml']));
    expect(root.toJson().childs[0].path).toStrictEqual(['foo', 'bar.xml']);
  });

  it('should dedup matched tech', () => {
    const root = new Payload({ name: 'root', folderPath: '/' });
    const res = matchAllFiles(
      [
        { name: 'index.ts', fp: 'index.ts', type: 'file' },
        { name: 'script.ts', fp: 'scripts.ts', type: 'file' },
      ],
      '/'
    );
    root.addTechs(res);

    expect(root.techs).toStrictEqual(new Set(['typescript']));
    expect(root.reason).toStrictEqual(new Set(['matched extension: .ts']));
  });
});


--- src/payload/index.ts ---

import path from 'node:path';

import { cleanPath } from '../common/helpers.js';
import { detectLang } from '../common/languages.js';
import { nid } from '../common/nid.js';
import { rulesComponents } from '../loader.js';
import { matchAllFiles } from '../matchAllFiles.js';
import { IGNORED_DIVE_PATHS } from '../provider/base.js';
import { listIndexed } from '../register.js';
import { findHosting, findImplicitComponent } from './helpers.js';
import { detectInDotEnv } from '../rules/spec/dotenv/index.js';

import type { BaseProvider } from '../provider/base.js';
import type { Analyser, AnalyserJson, Dependency } from '../types/index.js';
import type { AllowedLicenses } from '../types/licenses.js';
import type { AllowedKeys } from '../types/techs.js';

export class Payload implements Analyser {
  public id;
  public name;
  public path;
  public tech;
  public languages: Analyser['languages'];
  public licenses: Analyser['licenses'];
  public childs: Analyser['childs'];
  public techs: Analyser['techs'];
  public inComponent: Analyser['inComponent'];
  public dependencies: Analyser['dependencies'];
  public edges: Analyser['edges'];
  public parent?: null | Payload;
  public reason: Set<string>;

  constructor({
    id,
    name,
    folderPath,
    parent,
    tech,
    dependencies,
    reason,
  }: {
    id?: Analyser['id'];
    name: Analyser['name'];
    folderPath: Set<string> | string;
    parent?: null | Payload;
    tech?: Analyser['tech'];
    dependencies?: Analyser['dependencies'];
    reason?: string | string[];
  }) {
    this.id = id || nid();
    this.name = name;
    this.path = new Set(typeof folderPath === 'string' ? [folderPath] : folderPath);
    this.tech = tech || null;
    this.inComponent = null;
    this.childs = [];
    this.techs = new Set();
    this.languages = {};
    this.licenses = new Set();
    this.dependencies = dependencies || [];
    this.reason = Array.isArray(reason)
      ? new Set(reason)
      : new Set(typeof reason === 'string' ? [reason] : []);

    this.parent = parent;
    this.edges = [];
  }

  /**
   * Analyze a folder recursively.
   * It will modify the current Payload.
   */
  async recurse(provider: BaseProvider, filePath: string): Promise<void> {
    const files = await provider.listDir(filePath);

    // eslint-disable-next-line unicorn/no-this-assignment, @typescript-eslint/no-this-alias
    let ctx: Payload = this;
    for (const rule of rulesComponents) {
      const res = await rule(files, provider);
      if (res === false) {
        continue;
      }

      const resArray = Array.isArray(res) ? res : [res];
      for (const pl of resArray) {
        if (pl.name === 'virtual') {
          for (const child of pl.childs) {
            this.addChild(child);
          }
          this.combine(pl);
        } else {
          ctx = pl;
          this.addChild(pl);
        }
      }
    }

    const dotenv = await detectInDotEnv(files, provider);
    if (dotenv !== false) {
      for (const child of dotenv.childs) {
        this.addChild(child);
      }
      this.combine(dotenv);
    }

    // Detect Tech
    const matched = matchAllFiles(files, provider.basePath);
    ctx.addTechs(matched);

    // Recursively dive in folders
    for (const file of files) {
      if (file.type === 'file') {
        ctx.detectLang(file.name);
        continue;
      }
      if (IGNORED_DIVE_PATHS.includes(file.name)) {
        continue;
      }

      const fp = path.join(filePath, file.name);

      await ctx.recurse(provider, fp);
    }
  }

  /**
   * Register a child to this Payload.
   * If a similar child is found at the same level, it will merge them.
   */
  addChild(service: Payload): Payload {
    const exist = this.childs.find((s) => {
      // we only merge if a tech is similar otherwise it's too easy to get a false-positive
      if (!s.tech && !service.tech) {
        return false;
      }
      if (s.name === service.name) return true;
      if (s.tech === service.tech) return true;
      return false;
    });

    if (service.tech?.includes('.')) {
      const [host] = service.tech.split('.');
      const tech = listIndexed[host as AllowedKeys];
      if (tech.type === 'hosting' || tech.type === 'cloud') {
        const pl = new Payload({
          name: tech.name,
          folderPath: service.path,
          tech: tech.tech,
          reason: `implicit: ${service.tech}`,
        });
        const child = this.addChild(pl);
        service.inComponent = child;
      }
    }

    if (exist) {
      // Log all paths were it was found
      for (const p of service.path) {
        exist.path.add(p);
      }

      // Update edges to point to the initial component
      if (service.parent) {
        for (const edge of service.parent.edges) {
          if (edge.target.id !== service.id) {
            continue;
          }

          edge.target = exist;
        }
      }

      // Merge dependencies
      exist.dependencies = [...exist.dependencies, ...service.dependencies];

      return exist;
    }

    service.setParent(this);
    this.childs.push(service);
    return service;
  }

  /**
   * Register a tech.
   */
  addTechs(tech: Map<AllowedKeys, string[]>): void {
    for (const [key, reason] of tech.entries()) {
      this.addTech(key, reason);
    }
  }

  /**
   * Declare this Payload has built with this tech.
   */
  addTech(tech: AllowedKeys, reason: string[]): void {
    this.techs.add(tech);
    for (const r of reason) {
      this.reason.add(r);
    }

    findImplicitComponent({ pl: this, tech, reason });
    findHosting(this, tech);
  }

  /**
   * Register a relationship between this Payload and an other one.
   */
  addEdges(pl: Payload): void {
    this.edges.push({
      target: pl,
      read: true,
      write: true,
    });
  }

  /**
   * Helper to add a lang entry to languages.
   */
  public addLang(name: string, count = 1): void {
    if (!this.languages[name]) {
      this.languages[name] = 0;
    }

    this.languages[name] += count;
  }

  /**
   * Register a parent of this Payload
   */
  setParent(pl: null | Payload): void {
    this.parent = pl;
  }

  /**
   * Detect language of a file at this level.
   */
  detectLang(filename: string): void {
    const lang = detectLang(filename);
    if (lang) {
      this.addLang(lang.group || lang.name);
    }
  }

  /**
   * Helper to add a licence entry
   */
  public addLicenses(names: Set<AllowedLicenses>): void {
    for (const name of names) {
      this.licenses.add(name);
    }
  }

  combineDependencies(pl: Payload): void {
    // Merge dependencies
    const dedup = new Map<string, Dependency>();
    for (const dep of this.dependencies) dedup.set(dep.join('_'), dep);
    for (const dep of pl.dependencies) dedup.set(dep.join('_'), dep);
    this.dependencies = [...dedup.values()];
  }

  /**
   * Merge this Payload and an other one.
   * There is no failsafe, it will merge whatever is passed even if they are not the same kind.
   * It's mostly used to flatten folders.
   */
  combine(pl: Payload): void {
    // Log all paths were it was found
    this.path = new Set([...this.path, ...pl.path]);

    // Merge dependencies
    this.combineDependencies(pl);

    for (const [lang, count] of Object.entries(pl.languages)) {
      this.addLang(lang, count);
    }

    for (const tech of pl.techs) {
      this.techs.add(tech);
    }
    if (pl.tech) {
      this.techs.add(pl.tech);
    }
    for (const licence of pl.licenses) {
      this.licenses.add(licence);
    }
  }

  /**
   * Create a copy of this Payload.
   * It's a deep copy, meaning the childs, parent and other stuff will still point to the original references.
   */
  copy(): Payload {
    const cp = new Payload({
      id: this.id,
      name: this.name,
      folderPath: this.path,
      parent: this.parent,
      tech: this.tech,
      dependencies: this.dependencies,
    });
    cp.techs = new Set(this.techs);
    cp.inComponent = this.inComponent;
    cp.edges = this.edges;
    cp.path = this.path;
    cp.languages = this.languages;
    cp.licenses = new Set(this.licenses);
    cp.childs = this.childs;

    return cp;
  }

  /**
   *
   */
  /**
   * Output a deep copy in JSON, free of reference.
   *
   * @param root Absolute path to remove from output
   */
  toJson(root = ''): AnalyserJson {
    return {
      id: this.id,
      name: this.name,
      path: cleanPath([...this.path], root),
      tech: this.tech,
      edges: this.edges.map((edge) => {
        return { ...edge, target: edge.target.id };
      }),
      inComponent: this.inComponent ? this.inComponent.id : null,
      childs: this.childs
        .map((service) => {
          return service.toJson(root);
        })
        .sort((a, b) => {
          return a.name > b.name ? 1 : -1;
        }),
      techs: [...this.techs].sort(),
      languages: this.languages,
      licenses: [...this.licenses.values()],
      dependencies: this.dependencies,
      reason: [...this.reason.values()],
    };
  }
}


--- src/provider/base.ts ---

export interface ProviderFile {
  name: string;
  type: 'dir' | 'file';
  fp: string;
}

export interface BaseProvider {
  basePath: string;
  listDir: (pathRelative: string) => Promise<ProviderFile[]>;
  open: (path: string) => Promise<null | string>;
  stat: (path: string) => Promise<{ size: number } | null>;
}

export const IGNORED_DIVE_PATHS = [
  'node_modules',
  'dist',
  'build',
  'bin',
  'static',
  'public',
  'vendor',
  'terraform.tfstate.d',
  'migrations',
  'tests',
  'e2e',
  '__fixtures__',
  '__snapshots__',
  'tmp',

  // -- Dot folder
  '.artifacts',
  '.assets',
  '.azure',
  '.azure-pipelines',
  '.bundle',
  '.cache',
  '.changelog',
  '.devcontainer',
  '.docker',
  '.dynamodb',
  '.fusebox',
  '.git',
  // needed to detect github actions
  // '.github',
  '.gitlab',
  '.gradle',
  '.log',
  '.metadata',
  '.npm',
  '.nuxt',
  '.react-email',
  '.release',
  '.semgrep',
  '.serverless',
  '.svn',
  '.terraform',
  '.vercel',
  '.vscode',
  '.vuepress',
];


--- src/provider/fake.ts ---

import path from 'node:path';

import type { BaseProvider, ProviderFile } from './base.js';

export class FakeProvider implements BaseProvider {
  basePath: string;
  private paths;
  private files;

  constructor(opts: { paths: Record<string, string[]>; files: Record<string, string> }) {
    this.paths = opts.paths;
    this.files = opts.files;
    this.basePath = '/';
  }

  listDir(pathRelative: string): Promise<ProviderFile[]> {
    if (!(pathRelative in this.paths)) {
      return Promise.resolve([]);
    }

    const files = this.paths[pathRelative].sort();
    return Promise.resolve(
      files.map((file) => {
        const isDir = file.endsWith('/');
        return {
          name: isDir ? file.slice(0, Math.max(0, file.length - 1)) : file,
          type: isDir ? 'dir' : 'file',
          fp: path.join(pathRelative, file),
        };
      })
    );
  }

  stat(): Promise<{ size: number }> {
    return Promise.resolve({ size: 1000 });
  }

  open(pathRelative: string): Promise<string> {
    if (!(pathRelative in this.files)) {
      throw new Error(`not found "${pathRelative}"`);
    }

    return Promise.resolve(this.files[pathRelative]);
  }
}


--- src/provider/fs.ts ---

import fs from 'node:fs/promises';
import path from 'node:path';

import { l } from '../common/log.js';

import type { BaseProvider, ProviderFile } from './base.js';
import type { Stats } from 'node:fs';

export interface FSProviderOptions {
  path: string;
  ignorePaths?: (RegExp | string)[];
}

export class FSProvider implements BaseProvider {
  opts;
  basePath;

  constructor(opts: FSProviderOptions) {
    this.opts = opts;
    this.basePath = opts.path;
  }

  async listDir(pathRelative: string): Promise<ProviderFile[]> {
    const files = await fs.readdir(pathRelative, {
      withFileTypes: true,
    });

    const list: ProviderFile[] = files.map((file) => {
      return {
        name: file.name,
        type: file.isDirectory() ? 'dir' : 'file',
        fp: path.join(pathRelative, file.name),
      };
    });

    return list;
  }

  async stat(pathRelative: string): Promise<null | Stats> {
    try {
      const content = await fs.stat(pathRelative);
      return content;
    } catch (err) {
      l.error('Failed to stat file', { pathRelative, err });
      return null;
    }
  }

  async open(pathRelative: string): Promise<null | string> {
    try {
      const content = await fs.readFile(pathRelative);
      return content.toString();
    } catch (err) {
      l.error('Failed to open file', { pathRelative, err });
      return null;
    }
  }
}


--- src/register.ts ---

import type { Rule } from './types/rule.js';
import type { AllowedKeys } from './types/techs.js';

export const registeredTech = new Set<AllowedKeys>();
export const registeredRules: Rule[] = [];
export const listIndexed = {} as Record<AllowedKeys, Rule>;

export function register(rule: Rule): void {
  if (registeredTech.has(rule.tech)) {
    throw new Error(`Already registered ${rule.tech}`);
  }

  registeredTech.add(rule.tech);
  registeredRules.push(rule);
  listIndexed[rule.tech] = rule;
}


--- src/rules/ai/anthropic.ts ---

import { register } from '../../register.js';

register({
  tech: 'anthropic',
  name: 'Anthropic',
  type: 'ai',
  dotenv: ['ANTHROPIC_'],
  dependencies: [
    { type: 'npm', name: '@anthropic-ai/sdk' },
    { type: 'npm', name: '@ai-sdk/anthropic' },
    { type: 'npm', name: '@langchain/anthropic' },
    { type: 'python', name: 'anthropic' },
    { type: 'golang', name: 'github.com/anthropics/anthropic-sdk-go' },
    { type: 'npm', name: 'genkitx-anthropic' },
    { type: 'python', name: 'langchain-anthropic' },
  ],
});


--- src/rules/ai/aws.bedrock.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.bedrock',
  name: 'AWS Bedrock',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-bedrock' },
    { type: 'npm', name: '@aws-sdk/client-bedrock-runtime' },
    { type: 'npm', name: '@aws-sdk/client-bedrock-agent-runtime' },
    { type: 'npm', name: '@ai-sdk/amazon-bedrock' },
    { type: 'npm', name: '@anthropic-ai/bedrock-sdk' },
  ],
});


--- src/rules/ai/aws.comprehend.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.comprehend',
  name: 'AWS Comprehend',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-comprehend' },
    { type: 'npm', name: '@aws-sdk/client-comprehendmedical' },
  ],
});


--- src/rules/ai/aws.polly.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.polly',
  name: 'AWS Polly',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-polly' },
    { type: 'npm', name: '@aws-cdk/aws-polly' },
    { type: 'rust', name: 'aws-sdk-polly' },
    { type: 'ruby', name: 'aws-sdk-polly' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/polly',
    },
  ],
});


--- src/rules/ai/aws.rekognition.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.rekognition',
  name: 'AWS Rekognition',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-rekognition' },
    { type: 'npm', name: '@aws-cdk/aws-rekognition' },
    { type: 'rust', name: 'aws-sdk-rekognition' },
    { type: 'ruby', name: 'aws-sdk-rekognition' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/rekognition',
    },
  ],
});


--- src/rules/ai/aws.sagemaker.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.sagemaker',
  name: 'AWS SageMaker',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-sagemaker' },
    { type: 'npm', name: '@aws-cdk/aws-sagemaker' },
    { type: 'rust', name: 'aws-sdk-sagemaker' },
    { type: 'ruby', name: 'aws-sdk-sagemaker' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/sagemaker' },
    {
      type: 'terraform.resource',
      name: /^aws_sagemaker_/,
      example: 'aws_sagemaker_app',
    },
  ],
});


--- src/rules/ai/aws.transcribe.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.transcribe',
  name: 'AWS Transcribe',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/middleware-sdk-transcribe-streaming' },
    { type: 'npm', name: '@aws-sdk/client-transcribe-streaming' },
    { type: 'npm', name: '@aws-sdk/client-transcribe' },
  ],
});


--- src/rules/ai/aws.translate.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.translate',
  name: 'AWS Translate',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-translate' },
    { type: 'npm', name: '@aws-cdk/aws-translate' },
    { type: 'rust', name: 'aws-sdk-translate' },
    { type: 'ruby', name: 'aws-sdk-translate' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/translate',
    },
  ],
});


--- src/rules/ai/azure.openai.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.openai',
  name: 'Azure Openai',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@ai-sdk/azure' },
    { type: 'npm', name: 'genkitx-azure-openai' },
  ],
});


--- src/rules/ai/cohere.ts ---

import { register } from '../../register.js';

register({
  tech: 'cohereai',
  name: 'Cohere AI',
  type: 'ai',
  dotenv: ['COHERE_'],
  dependencies: [
    { type: 'npm', name: '@langchain/cohere' },
    { type: 'npm', name: '@ai-sdk/cohere' },
    { type: 'npm', name: '@llamaindex/cohere' },
    { type: 'npm', name: 'cohere-ai' },
    { type: 'python', name: 'cohere' },
    { type: 'golang', name: 'github.com/cohere-ai/cohere-go/v2' },
  ],
});


--- src/rules/ai/deepseek.ts ---

import { register } from '../../register.js';

register({
  tech: 'deepseek',
  name: 'Deepseek',
  type: 'ai',
  dotenv: ['DEEPSEEK_'],
  dependencies: [
    { type: 'npm', name: '@ai-sdk/deepsek' },
    { type: 'npm', name: '@langchain/deepsek' },
    { type: 'npm', name: 'n8n-nodes-deepseek' },
    { type: 'python', name: 'langchain-deepseek' },
  ],
});


--- src/rules/ai/elevenlabs.ts ---

import { register } from '../../register.js';

register({
  tech: 'elevenlabs',
  name: 'Elevenlabs',
  type: 'ai',
  dotenv: ['ELEVENLABS_'],
  dependencies: [
    { type: 'python', name: 'elevenlabs' },
    { type: 'npm', name: '@elevenlabs/react' },
    { type: 'npm', name: '@elevenlabs/react-native' },
    { type: 'npm', name: '@elevenlabs/client' },
  ],
});


--- src/rules/ai/gcp.aiplatform.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.aiplatform',
  name: 'Cloud AI Platform',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@google-cloud/aiplatform' },
    {
      type: 'terraform.resource',
      name: /^google_vertex_/,
      example: 'google_vertex_ai_dataset',
    },
    {
      type: 'ruby',
      name: /^google-cloud-ai_platform/,
      example: 'google-cloud-ai_platform-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/aiplatform' },
    { type: 'php', name: 'google/cloud-ai-platform' },
    { type: 'python', name: 'google-cloud-aiplatform' },
  ],
});


--- src/rules/ai/gcp.dialogflow.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.dialogflow',
  name: 'Cloud Dialogflow',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@google-cloud/dialogflow' },
    {
      type: 'terraform.resource',
      name: /^google_dialogflow_/,
      example: 'google_dialogflow_agent',
    },
    {
      type: 'ruby',
      name: /^google-cloud-dialogflow/,
      example: 'google-cloud-dialogflow-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/dialogflow' },
    { type: 'php', name: 'google/cloud-dialogflow' },
  ],
});


--- src/rules/ai/gcp.language.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.language',
  name: 'Cloud Language',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@google-cloud/language' },
    {
      type: 'ruby',
      name: /^google-cloud-language/,
      example: 'google-cloud-language-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/language' },
    { type: 'php', name: 'google/cloud-language' },
  ],
});


--- src/rules/ai/gcp.speech.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.speech',
  name: 'Cloud Speech',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@google-cloud/speech' },
    {
      type: 'ruby',
      name: /^google-cloud-speech/,
      example: 'google-cloud-speech-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/speech' },
    { type: 'php', name: 'google/cloud-speech' },
    { type: 'python', name: 'google-cloud-speech' },
  ],
});


--- src/rules/ai/gcp.translate.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.translate',
  name: 'Google Translate',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@google-cloud/translate' },
    { type: 'npm', name: 'google-translate-api-browser' },
    { type: 'npm', name: '@vitalets/google-translate-api' },
    { type: 'npm', name: '@iamtraction/google-translate' },
    {
      type: 'ruby',
      name: /^google-cloud-translate/,
      example: 'google-cloud-translate-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/translate' },
    { type: 'php', name: 'google/cloud-translate' },
    { type: 'python', name: 'google-cloud-translate' },
  ],
});


--- src/rules/ai/gcp.vertex.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.vertex',
  name: 'Vertex AI',
  type: 'ai',
  dotenv: ['VERTEX_AI'],
  dependencies: [
    { type: 'npm', name: '@ai-sdk/google-vertex' },
    { type: 'npm', name: '@google-cloud/vertexai' },
    { type: 'npm', name: '@langchain/google-vertexai' },
    { type: 'python', name: 'vertexai' },
  ],
});


--- src/rules/ai/gcp.vision.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.vision',
  name: 'Cloud Vision',
  type: 'ai',
  dependencies: [
    { type: 'npm', name: '@google-cloud/vision' },
    {
      type: 'ruby',
      name: /^google-cloud-vision/,
      example: 'google-cloud-vision-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/vision' },
    { type: 'php', name: 'google/cloud-vision' },
    { type: 'python', name: 'google-cloud-vision' },
  ],
});


--- src/rules/ai/geminiai.ts ---

import { register } from '../../register.js';

register({
  tech: 'geminiai',
  name: 'Gemini AI',
  type: 'ai',
  dotenv: ['GEMINI_'],
  dependencies: [
    { type: 'python', name: 'genai' },
    { type: 'npm', name: '@google/genai' },
    { type: 'npm', name: 'gemini-ai' },
    { type: 'python', name: 'langchain-google-genai' },
    { type: 'python', name: 'google-generativeai' },
  ],
});


--- src/rules/ai/groq.ts ---

import { register } from '../../register.js';

register({
  tech: 'groq',
  name: 'Groq',
  type: 'ai',
  dotenv: ['GROQ_'],
  dependencies: [
    { type: 'npm', name: '@langchain/groq' },
    { type: 'npm', name: '@ai-sdk/groq' },
    { type: 'npm', name: 'groq-sdk' },
    { type: 'npm', name: 'genkitx-groq ' },
    { type: 'python', name: 'langchain-groq' },
    { type: 'python', name: 'groq' },
  ],
});


--- src/rules/ai/huggingface.ts ---

import { register } from '../../register.js';

register({
  tech: 'huggingface',
  name: 'Hugging Face',
  type: 'ai',
  dotenv: ['HUGGINGFACE_'],
  dependencies: [
    { type: 'npm', name: /^@huggingface\//, example: '@huggingface/inference' },
    { type: 'python', name: 'langchain-huggingface' },
    { type: 'python', name: 'huggingface-hub' },
  ],
});


--- src/rules/ai/index.ts ---

import './anthropic.js';
import './aws.bedrock.js';
import './aws.comprehend.js';
import './aws.polly.js';
import './aws.rekognition.js';
import './aws.sagemaker.js';
import './aws.transcribe.js';
import './aws.translate.js';
import './azure.openai.js';
import './cohere.js';
import './deepseek.js';
import './elevenlabs.js';
import './gcp.aiplatform.js';
import './gcp.dialogflow.js';
import './gcp.language.js';
import './gcp.speech.js';
import './gcp.translate.js';
import './gcp.vertex.js';
import './gcp.vision.js';
import './geminiai.js';
import './groq.js';
import './huggingface.js';
import './mistralai.js';
import './ollama.js';
import './openai.js';
import './perplexityai.js';
import './replicate.js';
import './vercel.ai.js';
import './xai.js';


--- src/rules/ai/mistralai.ts ---

import { register } from '../../register.js';

register({
  tech: 'mistralai',
  name: 'Mistral AI',
  type: 'ai',
  dotenv: ['MISTRAL'],
  dependencies: [
    { type: 'npm', name: '@ai-sdk/mistral' },
    { type: 'npm', name: 'genkitx-mistral' },
    { type: 'python', name: 'mistralai' },
    { type: 'npm', name: '@mistralai/mistralai' },
    { type: 'golang', name: 'github.com/gage-technologies/mistral-go' },
    { type: 'python', name: 'langchain-mistralai' },
  ],
});


--- src/rules/ai/ollama.ts ---

import { register } from '../../register.js';

register({
  tech: 'ollama',
  name: 'Ollama',
  type: 'ai',
  dotenv: ['OLLAMA_'],
  dependencies: [
    { type: 'npm', name: '@langchain/ollama' },
    { type: 'npm', name: 'ollama-ai-provider' },
    { type: 'npm', name: 'genkitx-ollama' },
    { type: 'npm', name: 'ollama' },
    { type: 'python', name: 'langchain-ollama' },
    { type: 'python', name: 'ollama' },
  ],
});


--- src/rules/ai/openai.ts ---

import { register } from '../../register.js';

register({
  tech: 'openai',
  name: 'Openai',
  type: 'ai',
  dotenv: ['OPENAI_'],
  dependencies: [
    { type: 'npm', name: 'openai' },
    { type: 'npm', name: '@ai-sdk/openai' },
    { type: 'php', name: 'openai-php/client' },
    { type: 'php', name: 'openai-php/laravel' },
    { type: 'npm', name: 'gpt3-tokenizer' },
    { type: 'npm', name: 'chatgpt' },
    { type: 'npm', name: 'genkitx-openai' },
    { type: 'python', name: 'langchain-openai' },
    { type: 'python', name: 'openai' },
  ],
});


--- src/rules/ai/perplexityai.ts ---

import { register } from '../../register.js';

register({
  tech: 'perplexityai',
  name: 'Perplexity AI',
  type: 'ai',
  dotenv: ['PERPLEXITY_'],
  dependencies: [
    { type: 'npm', name: '@ai-sdk/perplexity' },
    { type: 'npm', name: '@langchain/perplexity' },
    { type: 'npm', name: '@watzon/n8n-nodes-perplexity' },
  ],
});


--- src/rules/ai/replicate.ts ---

import { register } from '../../register.js';

register({
  tech: 'replicate',
  name: 'Replicate',
  type: 'ai',
  dotenv: ['REPLICATE_'],
  dependencies: [
    { type: 'npm', name: 'replicate' },
    { type: 'python', name: 'replicate' },
  ],
});


--- src/rules/ai/vercel.ai.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel.ai',
  name: 'Vercel AI',
  type: 'ai',
  dependencies: [{ type: 'npm', name: '@vercel/ai' }],
});


--- src/rules/ai/xai.ts ---

import { register } from '../../register.js';

register({
  tech: 'xai',
  name: 'X AI',
  type: 'ai',
  dotenv: ['XAI_'],
  dependencies: [
    { type: 'npm', name: '@ai-sdk/xai' },
    { type: 'python', name: 'langchain-xai' },
  ],
});


--- src/rules/all.test.ts ---

import { describe, expect, it } from 'vitest';

import { registeredTech } from '../register.js';
import '../autoload.js';

describe('all', () => {
  it('should match everything', () => {
    expect([...registeredTech.values()].sort()).toMatchSnapshot();
  });
});


--- src/rules/analytics/adobe.analytics.ts ---

import { register } from '../../register.js';

register({
  tech: 'adobe.analytics',
  name: 'Adobe Analytics',
  type: 'analytics',
  dotenv: ['ADOBE_ANALYTICS_'],
  dependencies: [{ type: 'npm', name: '@adobe/aio-lib-analytics' }],
});


--- src/rules/analytics/amplitude.ts ---

import { register } from '../../register.js';

register({
  tech: 'amplitude',
  name: 'Amplitude Analytics',
  type: 'analytics',
  dotenv: ['AMPLITUDE_'],
  dependencies: [
    { type: 'npm', name: 'amplitude-js' },
    { type: 'npm', name: '@amplitude/analytics-browser' },
    { type: 'npm', name: '@analytics/amplitude' },
    { type: 'php', name: 'zumba/amplitude-php' },
    { type: 'terraform.resource', name: 'airbyte_source_amplitude' },
  ],
});


--- src/rules/analytics/databuddy.ts ---

import { register } from '../../register.js';

register({
  tech: 'databuddy',
  name: 'Databuddy',
  type: 'analytics',
  dotenv: ['DATABUDDY_'],
  dependencies: [{ type: 'npm', name: '@databuddy/sdk' }],
});


--- src/rules/analytics/datafast.ts ---

import { register } from '../../register.js';

register({
  tech: 'datafast',
  name: 'Datafast',
  type: 'analytics',
  dependencies: [],
});


--- src/rules/analytics/fathom.ts ---

import { register } from '../../register.js';

register({
  tech: 'fathom',
  name: 'Fathom',
  type: 'analytics',
  dotenv: ['FATHOM_'],
  dependencies: [{ type: 'npm', name: 'fathom-client' }],
});


--- src/rules/analytics/google.analytics.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.analytics',
  name: 'Google Analytics',
  type: 'analytics',
  dotenv: ['GOOGLE_ANALYTICS'],
  dependencies: [
    { type: 'npm', name: 'universal-analytics' },
    { type: 'npm', name: 'react-ga' },
    { type: 'npm', name: 'react-ga4' },
    { type: 'npm', name: '@types/google.analytics' },
    { type: 'npm', name: '@docusaurus/plugin-google-analytics' },
    { type: 'npm', name: '@analytics/google-analytics' },
    { type: 'npm', name: /^@google-analytics\\/, example: '@google-analytics/data' },
    { type: 'npm', name: 'nextjs-google-analytics' },
    { type: 'npm', name: '@nuxtjs/google-analytics' },
    { type: 'npm', name: 'gatsby-plugin-google-analytics' },
    { type: 'php', name: 'google/analytics-data' },
    { type: 'php', name: 'spatie/laravel-analytics' },
    { type: 'php', name: 'theiconic/php-ga-measurement-protocol' },
    { type: 'php', name: 'google/analytics-admin' },
    { type: 'terraform.resource', name: 'airbyte_source_google_analytics_data_api' },
    { type: 'python', name: 'google-analytics-data' },
  ],
});


--- src/rules/analytics/hotjar.ts ---

import { register } from '../../register.js';

register({
  tech: 'hotjar',
  name: 'Hotjar',
  type: 'analytics',
  dotenv: ['HOTJAR_'],
  dependencies: [{ type: 'npm', name: '@hotjar/browser' }],
});


--- src/rules/analytics/index.ts ---

import './adobe.analytics.js';
import './amplitude.js';
import './databuddy.js';
import './datafast.js';
import './fathom.js';
import './google.analytics.js';
import './hotjar.js';
import './koalaanalytics.js';
import './logsnag.js';
import './matomo.js';
import './mixpanel.js';
import './pirschanalytics.js';
import './plausible.js';
import './posthog.js';
import './segment.js';
import './simpleanalytics.js';
import './tinybird.js';
import './vercel.analytics.js';


--- src/rules/analytics/koalaanalytics.ts ---

import { register } from '../../register.js';

register({
  tech: 'koalaanalytics',
  name: 'Koala Analytics',
  type: 'analytics',
  dependencies: [{ type: 'npm', name: '@getkoala/browser' }],
});


--- src/rules/analytics/logsnag.ts ---

import { register } from '../../register.js';

register({
  tech: 'logsnag',
  name: 'LogSnag',
  type: 'analytics',
  dotenv: ['LOGSNAG_'],
  dependencies: [{ type: 'npm', name: 'logsnag' }],
});


--- src/rules/analytics/matomo.ts ---

import { register } from '../../register.js';

register({
  tech: 'matomo',
  name: 'Matomo',
  type: 'analytics',
  dotenv: ['MATOMO'],
  dependencies: [
    { type: 'docker', name: 'matomo' },
    { type: 'docker', name: 'bitnami/matomo' },
  ],
});


--- src/rules/analytics/mixpanel.ts ---

import { register } from '../../register.js';

register({
  tech: 'mixpanel',
  name: 'Mixpanel',
  type: 'analytics',
  dotenv: ['MIXPANEL_'],
  dependencies: [
    { type: 'php', name: 'mixpanel/mixpanel-php' },
    { type: 'npm', name: 'mixpanel-browser' },
    { type: 'python', name: 'mixpanel' },
    { type: 'npm', name: 'mixpanel' },
    { type: 'ruby', name: 'mixpanel-ruby' },
    { type: 'golang', name: 'github.com/mixpanel/mixpanel-go' },
    { type: 'terraform.resource', name: 'airbyte_source_mixpanel' },
    { type: 'npm', name: '@analytics/mixpanel' },
  ],
});


--- src/rules/analytics/pirschanalytics.ts ---

import { register } from '../../register.js';

register({
  tech: 'pirschanalytics',
  name: 'Pirsch Analytics',
  type: 'analytics',
  dependencies: [
    { type: 'npm', name: 'pirsch-sdk' },
    { type: 'ruby', name: 'pirsch_api' },
    { type: 'php', name: 'pirsch-analytics/sdk' },
    { type: 'golang', name: 'github.com/pirsch-analytics/pirsch-go-sdk/v2' },
  ],
});


--- src/rules/analytics/plausible.ts ---

import { register } from '../../register.js';

register({
  tech: 'plausible',
  name: 'Plausible',
  type: 'analytics',
  dotenv: ['PLAUSIBLE_'],
  dependencies: [
    { type: 'docker', name: 'plausible/analytics' },
    { type: 'docker', name: 'ghcr.io/plausible/community-edition' },
    { type: 'npm', name: 'plausible-tracker' },
    { type: 'php', name: 'prestashop_plausible' },
    { type: 'ruby', name: 'plausible_api' },
    { type: 'php', name: 'vincentbean/laravel-plausible' },
    { type: 'golang', name: 'github.com/andrerfcsantos/go-plausible/plausible' },
  ],
});


--- src/rules/analytics/posthog.ts ---

import { register } from '../../register.js';

register({
  tech: 'posthog',
  name: 'PostHog',
  type: 'analytics',
  dotenv: ['POSTHOG_'],
  dependencies: [
    { type: 'npm', name: 'posthog-js' },
    { type: 'golang', name: 'github.com/posthog/posthog-go' },
    { type: 'npm', name: 'posthog-node' },
    { type: 'php', name: 'posthog/posthog-php' },
    { type: 'ruby', name: 'posthog-ruby' },
    { type: 'rust', name: 'posthog-rs' },
    { type: 'npm', name: 'posthog-react-native' },
    { type: 'python', name: 'posthog' },
  ],
});


--- src/rules/analytics/segment.ts ---

import { register } from '../../register.js';

register({
  tech: 'segment',
  name: 'Segment',
  type: 'analytics',
  dotenv: ['SEGMENT_'],
  dependencies: [
    { type: 'npm', name: 'analytics-node' },
    { type: 'npm', name: /^@segment\//, example: '@segment/analytics-node' },
    { type: 'python', name: 'analytics-python' },
    { type: 'ruby', name: 'segment-analytics' },
    { type: 'php', name: 'segmentio/analytics-php' },
    { type: 'golang', name: 'github.com/segmentio/analytics-go' },
    { type: 'npm', name: '@analytics/segment' },
  ],
});


--- src/rules/analytics/simpleanalytics.ts ---

import { register } from '../../register.js';

register({
  tech: 'simpleanalytics',
  name: 'Simple Analytics',
  type: 'analytics',
  dotenv: ['SIMPLEANALYTICS_'],
  dependencies: [{ type: 'npm', name: '@analytics/simple-analytics' }],
});


--- src/rules/analytics/tinybird.ts ---

import { register } from '../../register.js';

register({
  tech: 'tinybird',
  name: 'Tinybird',
  type: 'analytics',
  dotenv: ['TINYBIRD'],
  dependencies: [
    {
      type: 'npm',
      name: /^@tinybirdco\//,
      example: '@tinybirdco/next-tinybird',
    },
  ],
});


--- src/rules/analytics/vercel.analytics.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel.analytics',
  name: 'Vercel Analytics',
  type: 'analytics',
  dependencies: [{ type: 'npm', name: '@vercel/analytics' }],
});


--- src/rules/app/adminer.ts ---

import { register } from '../../register.js';

register({
  tech: 'adminer',
  name: 'Adminer',
  type: 'app',
  dependencies: [{ type: 'docker', name: 'adminer' }],
});


--- src/rules/app/apacheTika.ts ---

import { register } from '../../register.js';

register({
  tech: 'apachetika',
  name: 'Tika',
  type: 'app',
  dependencies: [
    { type: 'docker', name: 'apache/tika' },
    { type: 'python', name: 'tika' },
  ],
});


--- src/rules/app/caddy.ts ---

import { register } from '../../register.js';

register({
  tech: 'caddy',
  name: 'Caddy',
  type: 'app',
  files: /\.Caddyfile$/,
  example: 'test.Caddyfile',
  dependencies: [{ type: 'docker', name: /caddy/, example: 'caddy:0.0.0' }],
});


--- src/rules/app/consul.ts ---

import { register } from '../../register.js';

register({
  tech: 'consul',
  name: 'Consul',
  type: 'app',
  dependencies: [{ type: 'docker', name: 'consul' }],
});


--- src/rules/app/discourse.ts ---

import { register } from '../../register.js';

register({
  tech: 'discourse',
  name: 'Discourse',
  type: 'app',
  dependencies: [
    { type: 'docker', name: 'bitnami/discourse' },
    { type: 'docker', name: 'discourse/base' },
  ],
});


--- src/rules/app/grafana.ts ---

import { register } from '../../register.js';

register({
  tech: 'grafana',
  name: 'Grafana',
  type: 'app',
  dependencies: [
    { type: 'docker', name: 'grafana/grafana-enterprise' },
    { type: 'docker', name: 'grafana/grafana-oss' },
    { type: 'docker', name: 'grafana/grafana' },
    { type: 'docker', name: 'grafana/agent' },
    { type: 'docker', name: 'grafana/tempo' },
    { type: 'docker', name: 'grafana/agent-operator' },

    {
      type: 'terraform',
      name: 'registry.terraform.io/grafana/grafana',
    },
  ],
});


--- src/rules/app/haproxy.ts ---

import { register } from '../../register.js';

register({
  tech: 'haproxy',
  name: 'HAProxy',
  type: 'app',
  dependencies: [
    { type: 'docker', name: 'haproxy' },
    { type: 'docker', name: 'haproxytech/haproxy-debian' },
    { type: 'docker', name: 'haproxytech/haproxy-alpine' },
    { type: 'docker', name: 'haproxytech/haproxy-ubuntu' },
    { type: 'docker', name: 'haproxytech/kubernetes-ingress' },
  ],
});


--- src/rules/app/httpd.ts ---

import { register } from '../../register.js';

register({
  tech: 'httpd',
  name: 'HTTPD',
  type: 'app',
  files: ['httpd.conf'],
  dependencies: [{ type: 'docker', name: /httpd/, example: 'httpd:0.0.0' }],
});


--- src/rules/app/index.ts ---

import './adminer.js';
import './apacheTika.js';
import './caddy.js';
import './consul.js';
import './discourse.js';
import './grafana.js';
import './haproxy.js';
import './httpd.js';
import './kibana.js';
import './kong.js';
import './mongoexpress.js';
import './nginx.js';
import './postgrest.js';
import './teamspeak.js';
import './telegraf.js';
import './traefik.js';
import './zookeeper.js';


--- src/rules/app/kibana.ts ---

import { register } from '../../register.js';

register({
  tech: 'kibana',
  name: 'Kibana',
  type: 'app',
  dotenv: ['KIBANA_'],
  dependencies: [{ type: 'docker', name: /kibana/, example: 'kibana:0.0.0' }],
});


--- src/rules/app/kong.ts ---

import { register } from '../../register.js';

register({
  tech: 'kong',
  name: 'Kong',
  type: 'app',
  files: ['kong.conf'],
  dependencies: [{ type: 'docker', name: 'kong' }],
});


--- src/rules/app/mongoexpress.ts ---

import { register } from '../../register.js';

register({
  tech: 'mongoexpress',
  name: 'Mongo Express',
  type: 'app',
  dependencies: [{ type: 'docker', name: 'mongo-express' }],
});


--- src/rules/app/nginx.ts ---

import { register } from '../../register.js';

register({
  tech: 'nginx',
  name: 'Nginx',
  type: 'app',
  files: ['nginx.conf'],
  dependencies: [
    { type: 'docker', name: 'nginx' },
    { type: 'docker', name: 'unit' },
    { type: 'docker', name: 'nginxinc/nginx-unprivileged' },
    { type: 'docker', name: 'nginx/nginx-ingress' },
    { type: 'docker', name: 'nginxinc/nginx-s3-gateway' },
    { type: 'docker', name: 'nginx/unit' },
    { type: 'docker', name: 'nginxproxy/nginx-proxy' },
    { type: 'docker', name: 'bitnami/nginx' },
    { type: 'docker', name: 'bitnami/nginx-ingress-controller' },
    { type: 'docker', name: 'ubuntu/nginx' },
    { type: 'docker', name: 'kasmweb/nginx' },
    { type: 'docker', name: 'rancher/nginx-ingress-controller' },
    { type: 'docker', name: 'rancher/nginx' },
    { type: 'docker', name: 'linuxserver/nginx' },
    { type: 'docker', name: 'privatebin/nginx-fpm-alpine' },
    { type: 'docker', name: 'wodby/nginx' },
  ],
});


--- src/rules/app/postgrest.ts ---

import { register } from '../../register.js';

register({
  tech: 'postgrest',
  name: 'Postgrest',
  type: 'app',
  dependencies: [{ type: 'docker', name: 'postgrest/postgrest' }],
});


--- src/rules/app/teamspeak.ts ---

import { register } from '../../register.js';

register({
  tech: 'teamspeak',
  name: 'Teamspeak',
  type: 'app',
  dependencies: [{ type: 'docker', name: 'teamspeak' }],
});


--- src/rules/app/telegraf.ts ---

import { register } from '../../register.js';

register({
  tech: 'telegraf',
  name: 'Telegraf',
  type: 'app',
  dependencies: [{ type: 'docker', name: 'telegraf' }],
});


--- src/rules/app/traefik.ts ---

import { register } from '../../register.js';

register({
  tech: 'traefik',
  name: 'Traefik',
  type: 'app',
  files: ['traefik.yml', 'traefik.yaml', 'traefik.toml'],
  dependencies: [{ type: 'docker', name: 'traefik' }],
});


--- src/rules/app/zookeeper.ts ---

import { register } from '../../register.js';

register({
  tech: 'zookeeper',
  name: 'Zookeeper',
  type: 'app',
  dependencies: [
    { type: 'docker', name: /zookeeper/, example: 'zookeeper:0.0.0' },
    { type: 'rust', name: 'zookeeper' },
    { type: 'ruby', name: 'zookeeper' },
    { type: 'php', name: 'sparkinfluence/zookeeper' },
  ],
});


--- src/rules/auth/auth0.ts ---

import { register } from '../../register.js';

register({
  tech: 'auth0',
  name: 'Auth0',
  type: 'auth',
  dotenv: ['AUTH0_'],
  dependencies: [
    { type: 'npm', name: 'auth0' },
    { type: 'npm', name: '@pulumi/auth0' },
    { type: 'npm', name: /^@auth0\//, example: '@auth0/auth0-react' },
    { type: 'terraform', name: 'registry.terraform.io/auth0/auth0' },
    { type: 'rust', name: 'auth0' },
    { type: 'ruby', name: 'auth0' },
    { type: 'ruby', name: 'omniauth-auth0' },
    { type: 'php', name: 'auth0/auth0-php' },
    { type: 'php', name: 'auth0/login' },
  ],
});


--- src/rules/auth/aws.cognito.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.cognito',
  name: 'AWS Cognito',
  type: 'auth',
  dependencies: [
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/cognitoidentityprovider' },
    { type: 'npm', name: '@aws-sdk/client-cognito-identity-provider' },
    { type: 'ruby', name: 'aws-sdk-cognitoidentityprovider' },
  ],
});


--- src/rules/auth/betterauth.ts ---

import { register } from '../../register.js';

register({
  tech: 'betterauth',
  name: 'Better Auth',
  type: 'auth',
  dotenv: ['BETTER_AUTH_'],
  dependencies: [
    { type: 'npm', name: 'better-auth' },
    { type: 'npm', name: '@better-auth/cli' },
  ],
});


--- src/rules/auth/clerk.ts ---

import { register } from '../../register.js';

register({
  tech: 'clerk',
  name: 'Clerk',
  type: 'auth',
  dotenv: ['CLERK_'],
  dependencies: [
    { type: 'npm', name: '@clerk/types' },
    { type: 'npm', name: '@clerk/nextjs' },
    { type: 'npm', name: '@clerk/clerk-react' },
    { type: 'npm', name: '@clerk/clerk-js' },
    { type: 'npm', name: '@clerk/express' },
    { type: 'npm', name: '@clerk/fastify' },
    { type: 'npm', name: '@clerk/tanstack-start' },
    { type: 'ruby', name: 'clerk-sdk-ruby' },
    { type: 'python', name: 'clerk-backend-api' },
    { type: 'golang', name: 'github.com/clerk/clerk-sdk-go/v2' },
  ],
});


--- src/rules/auth/frontegg.ts ---

import { register } from '../../register.js';

register({
  tech: 'frontegg',
  name: 'Frontegg',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: /^@frontegg\//, example: '@frontegg/js' },
    { type: 'python', name: 'frontegg' },
    { type: 'terraform', name: 'registry.terraform.io/frontegg/frontegg' },
  ],
});


--- src/rules/auth/fusionauth.ts ---

import { register } from '../../register.js';

register({
  tech: 'fusionauth',
  name: 'Fusionauth',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: /^@fusionauth\//, example: '@fusionauth/typescript-client' },
    { type: 'golang', name: 'github.com/FusionAuth/go-client/pkg/fusionauth' },
    { type: 'php', name: 'fusionauth/fusionauth-client' },
    { type: 'python', name: 'fusionauth-client' },
    { type: 'ruby', name: 'fusionauth_client' },
  ],
});


--- src/rules/auth/hanko.ts ---

import { register } from '../../register.js';

register({
  tech: 'hanko',
  name: 'Hanko',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: /^@teamhanko\//, example: '@teamhanko/hanko-frontend-sdk' },
    { type: 'npm', name: '@nuxtjs/hanko' },
  ],
});


--- src/rules/auth/index.ts ---

import './auth0.js';
import './aws.cognito.js';
import './betterauth.js';
import './clerk.js';
import './frontegg.js';
import './fusionauth.js';
import './hanko.js';
import './kinde.js';
import './logto.js';
import './okta.js';
import './orysh.js';
import './properlauth.js';
import './stytch.js';
import './supabase.auth.js';
import './supertokens.js';
import './workos.js';


--- src/rules/auth/kinde.ts ---

import { register } from '../../register.js';

register({
  tech: 'kinde',
  name: 'Kinde',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: /^@kinde-oss\//, example: '@kinde-oss/kinde-typescript-sdk' },
    { type: 'python', name: 'kinde-python-sdk' },
    { type: 'ruby', name: 'kinde_sdk' },
    { type: 'php', name: 'kinde-oss/kinde-auth-php' },
  ],
});


--- src/rules/auth/logto.ts ---

import { register } from '../../register.js';

register({
  tech: 'logtoio',
  name: 'Logto',
  type: 'auth',
  dotenv: ['LOGTO_'],
  dependencies: [
    { type: 'npm', name: /^@logto\//, example: '@logto/js' },
    { type: 'golang', name: 'github.com/logto-io/go' },
    { type: 'php', name: 'logto/sdk' },
    { type: 'python', name: 'logto' },
    { type: 'ruby', name: 'logto' },
  ],
});


--- src/rules/auth/okta.ts ---

import { register } from '../../register.js';

register({
  tech: 'okta',
  name: 'Okta',
  type: 'auth',
  dotenv: ['OKTA_'],
  dependencies: [
    { type: 'npm', name: /^@okta\//, example: '@okta/okta-signin-widget' },
    { type: 'terraform', name: 'registry.terraform.io/okta/okta' },
    { type: 'rust', name: 'okta' },
    { type: 'ruby', name: 'oktakit' },
    { type: 'php', name: 'socialiteproviders/okta' },
    { type: 'npm', name: '@pulumi/okta' },
  ],
});


--- src/rules/auth/orysh.ts ---

import { register } from '../../register.js';

register({
  tech: 'orysh',
  name: 'Ory',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: /^@ory\//, example: '@ory/client' },
    { type: 'golang', name: 'github.com/ory/client-go' },
    { type: 'php', name: 'ory/client' },
  ],
});


--- src/rules/auth/properlauth.ts ---

import { register } from '../../register.js';

register({
  tech: 'propelauth',
  name: 'PropelAuth',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: /^@propelauth\//, example: '@propelauth/node' },
    { type: 'python', name: 'propelauth_fastapi' },
    { type: 'rust', name: 'propelauth' },
    { type: 'golang', name: 'github.com/propelauth/propelauth-go' },
  ],
});


--- src/rules/auth/stytch.ts ---

import { register } from '../../register.js';

register({
  tech: 'stytch',
  name: 'Stytch',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: /^@stytch\//, example: '@stytch/vanilla-js' },
    { type: 'npm', name: 'stytch' },
    { type: 'python', name: 'stytch' },
    { type: 'golang', name: 'github.com/stytchauth/stytch-go/v16' },
    { type: 'ruby', name: 'stytch' },
  ],
});


--- src/rules/auth/supabase.auth.ts ---

import { register } from '../../register.js';

register({
  tech: 'supabase.auth',
  name: 'Supabase Auth',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: '@supabase/gotrue-js' },
    { type: 'docker', name: 'supabase/gotrue' },
  ],
});


--- src/rules/auth/supertokens.ts ---

import { register } from '../../register.js';

register({
  tech: 'supertokens',
  name: 'SuperTokens',
  type: 'auth',
  dependencies: [
    { type: 'npm', name: 'supertokens-web-js' },
    { type: 'npm', name: 'supertokens-node' },
    { type: 'golang', name: 'github.com/supertokens/supertokens-golang' },
    { type: 'python', name: 'supertokens_python' },
    { type: 'npm', name: 'supertokens-auth-react' },
  ],
});


--- src/rules/auth/workos.ts ---

import { register } from '../../register.js';

register({
  tech: 'workos',
  name: 'WorkOS',
  type: 'auth',
  dotenv: ['WORKOS_'],
  dependencies: [
    { type: 'npm', name: '@workos-inc/node' },
    { type: 'golang', name: 'github.com/workos/workos-go' },
    { type: 'ruby', name: 'workos' },
    { type: 'ruby', name: 'omniauth-workos' },
    { type: 'ruby', name: 'ueberauth_workos' },
    { type: 'python', name: 'workos' },
    { type: 'php', name: 'workos/workos-php' },
    { type: 'python', name: 'django-workos' },
  ],
});


--- src/rules/automation/apify.ts ---

import { register } from '../../register.js';

register({
  tech: 'apify',
  name: 'Apify',
  type: 'automation',
  dotenv: ['APIFY_'],
  dependencies: [
    { type: 'npm', name: 'apify' },
    { type: 'npm', name: 'apify-client' },
    { type: 'npm', name: /^@apify\//, example: '@apify/utilities' },
    { type: 'python', name: 'apify' },
    { type: 'terraform.resource', name: 'airbyte_source_apify_dataset' },
  ],
});


--- src/rules/automation/aws.sfn.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.sfn',
  name: 'AWS Step Functions',
  type: 'automation',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-sfn' },
    { type: 'npm', name: '@aws-cdk/aws-sfn' },
    { type: 'rust', name: 'aws-sdk-sfn' },
    { type: 'ruby', name: 'aws-sdk-sfn' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/sfn' },
    {
      type: 'terraform.resource',
      name: /^aws_sfn_/,
      example: 'aws_sfn_activity',
    },
  ],
});


--- src/rules/automation/browerbase.ts ---

import { register } from '../../register.js';

register({
  tech: 'browerbase',
  name: 'Browserbase',
  type: 'automation',
  dependencies: [
    { type: 'php', name: '@browserbasehq/sdk' },
    { type: 'python', name: 'browserbase' },
  ],
});


--- src/rules/automation/browseruse.ts ---

import { register } from '../../register.js';

register({
  tech: 'browseruse',
  name: 'Browser Use',
  type: 'automation',
  dependencies: [{ type: 'python', name: 'browser-use' }],
});


--- src/rules/automation/crawl4ai.ts ---

import { register } from '../../register.js';

register({
  tech: 'crawl4ai',
  name: 'Crawl4AI',
  type: 'automation',
  dotenv: ['CRAWL4AI_'],
  dependencies: [
    { type: 'docker', name: 'unclecode/crawl4ai' },
    { type: 'python', name: 'crawl4ai' },
  ],
});


--- src/rules/automation/firecrawl.ts ---

import { register } from '../../register.js';

register({
  tech: 'firecrawl',
  name: 'Firecrawl',
  type: 'automation',
  dotenv: ['FIRECRAWL_'],
  dependencies: [
    { type: 'php', name: '@mendable/firecrawl-js' },
    { type: 'python', name: 'firecrawl-py' },
    { type: 'golang', name: 'github.com/mendableai/firecrawl-go' },
    { type: 'rust', name: 'firecrawl' },
  ],
});


--- src/rules/automation/index.ts ---

import './apify.js';
import './aws.sfn.js';
import './browerbase.js';
import './browseruse.js';
import './crawl4ai.js';
import './firecrawl.js';
import './inngest.js';
import './n8n.js';
import './playwright.js';
import './puppeteer.js';
import './selenium.js';


--- src/rules/automation/inngest.ts ---

import { register } from '../../register.js';

register({
  tech: 'inngest',
  name: 'Inngest',
  type: 'automation',
  dotenv: ['INNGEST_'],
  dependencies: [
    { type: 'npm', name: 'inngest' },
    { type: 'golang', name: 'github.com/inngest/inngestgo' },
    { type: 'python', name: 'inngest' },
  ],
});


--- src/rules/automation/n8n.ts ---

import { register } from '../../register.js';

register({
  tech: 'n8n',
  name: 'n8n',
  type: 'automation',
  dotenv: ['N8N_'],
  dependencies: [
    { type: 'docker', name: 'n8nio/n8n' },
    { type: 'npm', name: 'n8n' },
  ],
});


--- src/rules/automation/playwright.ts ---

import { register } from '../../register.js';

register({
  tech: 'playwright',
  name: 'Playwright',
  type: 'automation',
  files: ['playwright.config.ts'],
  dependencies: [
    { type: 'npm', name: 'playwright' },
    { type: 'npm', name: '@playwright/test' },
    { type: 'githubAction', name: 'microsoft/playwright-github-action' },
    { type: 'docker', name: 'mcr.microsoft.com/playwright' },
    { type: 'python', name: 'pytest-playwright' },
    // {type: 'dotnet', name: 'Microsoft.Playwright.NUnit'},
    // {type: 'java', name: 'com.microsoft.playwright.*'},
  ],
});


--- src/rules/automation/puppeteer.ts ---

import { register } from '../../register.js';

register({
  tech: 'puppeteer',
  name: 'Puppeteer',
  type: 'automation',
  dependencies: [
    { type: 'npm', name: 'puppeteer' },
    { type: 'npm', name: 'puppeteer-core' },
    { type: 'npm', name: '@puppeteer/browser' },
    { type: 'docker', name: 'itisfoundation/puppeteer' },
  ],
});


--- src/rules/automation/selenium.ts ---

import { register } from '../../register.js';

register({
  tech: 'selenium',
  name: 'Selenium',
  type: 'automation',
  dependencies: [
    { type: 'npm', name: 'selenium' },
    { type: 'npm', name: 'selenium-webdriver' },
    { type: 'npm', name: 'webdriver-js-extender' },
    { type: 'npm', name: '@wdio/selenium-standalone-service' },
    { type: 'php', name: 'php-webdriver/webdriver' },
    { type: 'php', name: 'behat/mink-selenium2-driver' },
    { type: 'php', name: 'symfony/panther' },
    { type: 'php', name: 'instaclick/php-webdriver' },
    { type: 'php', name: 'phpunit/phpunit-selenium' },
    { type: 'php', name: 'se/selenium-server-standalone' },
    { type: 'ruby', name: 'selenium-webdriver' },
    { type: 'ruby', name: 'selenium' },
    { type: 'ruby', name: 'selenium-client' },
    { type: 'ruby', name: 'capybara-selenium' },
    { type: 'rust', name: 'thirtyfour' },
    { type: 'rust', name: 'selenium-rs' },
    { type: 'githubAction', name: 'Xotabu4/selenoid-github-action' },
    { type: 'golang', name: 'github.com/tebeka/selenium' },
    { type: 'python', name: 'selenium' },
    { type: 'docker', name: 'selenium/standalone-chrome' },
    { type: 'docker', name: 'selenium/node-chrome' },
    { type: 'docker', name: 'selenium/hub' },
    { type: 'docker', name: 'selenium/node-firefox' },
    { type: 'docker', name: 'selenium/standalone-firefox' },
    { type: 'docker', name: 'selenium/standalone-chrome-debug' },
    { type: 'docker', name: 'selenium/node-chrome-debug' },
    { type: 'docker', name: 'selenium/base' },
    { type: 'docker', name: 'selenium/node-edge' },
    { type: 'docker', name: 'selenium/node-firefox-debug' },
    { type: 'docker', name: 'selenium/standalone-firefox-debug' },
    { type: 'docker', name: 'selenium/node-opera' },
  ],
});


--- src/rules/builder/babel.ts ---

import { register } from '../../register.js';

register({
  tech: 'babel',
  name: 'Babel',
  type: 'builder',
  dependencies: [{ type: 'npm', name: '@babel/core' }],
});


--- src/rules/builder/esbuild.ts ---

import { register } from '../../register.js';

register({
  tech: 'esbuild',
  name: 'Esbuild',
  type: 'builder',
  dependencies: [{ type: 'npm', name: 'esbuild' }],
});


--- src/rules/builder/index.ts ---

import './babel.js';
import './esbuild.js';
import './nxjs.js';
import './parceljs.js';
import './rolldown.js';
import './rollup.js';
import './rspack.js';
import './swc.js';
import './turborepo.js';
import './vite.js';
import './webpack.js';


--- src/rules/builder/nxjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'nxjs',
  name: 'NX',
  type: 'builder',
  files: ['nx.json'],
  dependencies: [{ type: 'npm', name: 'nx' }],
});


--- src/rules/builder/parceljs.ts ---

import { register } from '../../register.js';

register({
  tech: 'parceljs',
  name: 'Parcel',
  type: 'builder',
  dependencies: [
    { type: 'npm', name: 'parcel' },
    { type: 'npm', name: '@parcel/core' },
  ],
});


--- src/rules/builder/rolldown.ts ---

import { register } from '../../register.js';

register({
  tech: 'rolldown',
  name: 'Rolldown',
  type: 'builder',
  dependencies: [{ type: 'npm', name: 'rolldown' }],
});


--- src/rules/builder/rollup.ts ---

import { register } from '../../register.js';

register({
  tech: 'rollup',
  name: 'Rollup',
  type: 'builder',
  dependencies: [{ type: 'npm', name: 'rollup' }],
});


--- src/rules/builder/rspack.ts ---

import { register } from '../../register.js';

register({
  tech: 'rspack',
  name: 'Rspack',
  type: 'builder',
  files: ['rspack.config.js'],
  dependencies: [
    { type: 'npm', name: 'rspack' },
    { type: 'npm', name: '@rspack/core' },
  ],
});


--- src/rules/builder/swc.ts ---

import { register } from '../../register.js';

register({
  tech: 'swc',
  name: 'SWC',
  type: 'builder',
  dependencies: [{ type: 'npm', name: '@swc/core' }],
});


--- src/rules/builder/turborepo.ts ---

import { register } from '../../register.js';

register({
  tech: 'turborepo',
  name: 'Turborepo',
  type: 'builder',
  files: ['turbo.json'],
  dependencies: [{ type: 'npm', name: 'turbo' }],
});


--- src/rules/builder/vite.ts ---

import { register } from '../../register.js';

register({
  tech: 'vite',
  name: 'Vite',
  type: 'builder',
  dependencies: [{ type: 'npm', name: 'vite' }],
});


--- src/rules/builder/webpack.ts ---

import { register } from '../../register.js';

register({
  tech: 'webpack',
  name: 'Webpack',
  type: 'builder',
  dependencies: [{ type: 'npm', name: 'webpack' }],
});


--- src/rules/ci.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../analyser/index.js';
import { rawList } from '../loader.js';
import { FakeProvider } from '../provider/fake.js';
import { listIndexed } from '../register.js';

import type { AllowedKeys } from '../index.js';
import '../autoload.js';

describe('ci', () => {
  it('should match everything', async () => {
    const paths: string[] = [];
    for (const item of rawList) {
      if (item.type !== 'file' || listIndexed[item.ref.tech].type !== 'ci' || !item.ref.files) {
        continue;
      }

      paths.push('example' in item.ref ? item.ref.example : item.ref.files[0]);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': paths,
        },
        files: {
          '/.github/workflows/ci.yml': '', // we open this file
        },
      }),
    });

    expect(res.toJson('').techs).toMatchSnapshot();
  });

  it('should enforce that we match .github', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['.github/'],
          '/.github': ['workflows/'],
          '/.github/workflows': ['main.yml'],
        },
        files: {
          '/.github/workflows/main.yml': '',
        },
      }),
    });
    const match: AllowedKeys[] = ['github', 'github.actions'];

    expect(res.toJson('').techs).toStrictEqual(match);
  });
});


--- src/rules/ci/appveyor.ts ---

import { register } from '../../register.js';

register({
  tech: 'appveyor',
  name: 'AppVeyor',
  type: 'ci',
  files: ['.appveyor.yml', '.appveyor.yaml'],
});


--- src/rules/ci/atlassian.bitbucketpipelines.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlassian.bitbucketpipelines',
  name: 'Bitbucket Pipelines',
  type: 'ci',
  files: ['bitbucket-pipeline.yml'],
  dependencies: [],
});


--- src/rules/ci/aws.codebuild.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.codebuild',
  name: 'AWS Code Build',
  type: 'ci',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-codebuild' },
    { type: 'rust', name: 'aws-sdk-codebuild' },
    { type: 'ruby', name: 'aws-sdk-codebuild' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/codebuild' },
    {
      type: 'terraform.resource',
      name: /^aws_codebuild_/,
      example: 'aws_codebuild_project',
    },
    { type: 'githubAction', name: 'aws-actions/aws-codebuild-run-build' },
  ],
});


--- src/rules/ci/aws.codepipeline.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.codepipeline',
  name: 'AWS Code Pipeline',
  type: 'ci',
  dependencies: [{ type: 'githubAction', name: 'zulhfreelancer/aws-codepipeline-action' }],
});


--- src/rules/ci/azure.ci.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.ci',
  name: 'AzureCI',
  type: 'ci',
  files: ['azure-pipelines.yml', 'azure-pipelines.yaml'],
});


--- src/rules/ci/browserstack.ts ---

import { register } from '../../register.js';

register({
  tech: 'browserstack',
  name: 'Browserstack',
  type: 'ci',
  files: ['browserstack.json', 'browserstack.yml'],
  dependencies: [
    { type: 'npm', name: 'browserstack' },
    { type: 'ruby', name: 'browserstack-local' },
  ],
});


--- src/rules/ci/circleci.ts ---

import { register } from '../../register.js';

register({
  tech: 'circleci',
  name: 'CircleCI',
  type: 'ci',
  files: ['.circleci', 'circle.yml', 'circle.yaml'],
  dependencies: [
    { type: 'ruby', name: 'circleci' },
    {
      type: 'githubAction',
      name: 'CircleCI-Public/trigger-circleci-pipeline-action',
    },
  ],
});


--- src/rules/ci/cirrusci.ts ---

import { register } from '../../register.js';

register({
  tech: 'cirrusci',
  name: 'CirrusCI',
  type: 'ci',
  files: ['.cirrus.yml', '.cirrus.yaml'],
});


--- src/rules/ci/cloudbees.codeship.ts ---

import { register } from '../../register.js';

register({
  tech: 'cloudbees.codeship',
  name: 'CloudBees Codeship',
  type: 'ci',
  files: ['codeship-services.yml'],
});


--- src/rules/ci/codeclimate.ts ---

import { register } from '../../register.js';

register({
  tech: 'codeclimate',
  name: 'Code Climate',
  type: 'ci',
  files: ['.codeclimate.yml'],
  dependencies: [
    { type: 'githubAction', name: 'paambaati/codeclimate-action' },
    { type: 'githubAction', name: 'remarkablemark/setup-codeclimate' },
  ],
});


--- src/rules/ci/codecov.ts ---

import { register } from '../../register.js';

register({
  tech: 'codecov',
  name: 'Codecov',
  type: 'ci',
  files: ['.codecov.yml', 'codecov.yml'],
  dependencies: [{ type: 'githubAction', name: 'codecov/codecov-action' }],
});


--- src/rules/ci/codesandboxci.ts ---

import { register } from '../../register.js';

register({
  tech: 'codesandboxci',
  name: 'CodeSandboxCI',
  type: 'ci',
  matchFullPath: true,
  files: /.codesandbox\/ci.json/,
  example: '.codesandbox/ci.json',
});


--- src/rules/ci/concourseci.ts ---

import { register } from '../../register.js';

register({
  tech: 'concourseci',
  name: 'Concourse CI',
  type: 'ci',
  files: ['concourse-ci'],
});


--- src/rules/ci/coveralls.ts ---

import { register } from '../../register.js';

register({
  tech: 'coveralls',
  name: 'Coveralls',
  type: 'ci',
  dependencies: [
    { type: 'githubAction', name: 'coverallsapp/github-action' },
    {
      type: 'npm',
      name: 'node-coveralls',
    },
    { type: 'golang', name: 'goveralls' },
    { type: 'npm', name: 'php-coveralls' },
    { type: 'ruby', name: 'coveralls' },
    { type: 'ruby', name: 'coveralls_reborn' },
  ],
});


--- src/rules/ci/cypressci.ts ---

import { register } from '../../register.js';

register({
  tech: 'cypressci',
  name: 'CypressCI',
  type: 'ci',
  files: /cypress.config.(js|ts|mjs|cjs)/,
  example: 'cypress.config.js',
  dependencies: [
    { type: 'npm', name: 'cypress' },
    { type: 'npm', name: 'gatsby-cypress' },
    { type: 'docker', name: /cypress/, example: 'cypress:0.0.0' },
    { type: 'ruby', name: 'cypress-on-rails' },
    { type: 'githubAction', name: 'cypress-io/github-action' },
  ],
});


--- src/rules/ci/deepsource.ts ---

import { register } from '../../register.js';

register({
  tech: 'deepsource',
  name: 'Deepsource',
  type: 'ci',
  files: ['.deepsource.toml'],
  dependencies: [{ type: 'githubAction', name: 'deepsourcelabs/test-coverage-action' }],
});


--- src/rules/ci/dependabot.ts ---

import { register } from '../../register.js';

register({
  tech: 'dependabot',
  name: 'Dependabot',
  type: 'ci',
  matchFullPath: true,
  files: /.github\/dependabot.y(a)?ml/,
  example: '.github/dependabot.yml',
  dependencies: [
    { type: 'ruby', name: /^dependabot-/, example: 'dependabot-common' },
    { type: 'githubAction', name: 'ahmadnassri/action-dependabot-auto-merge' },
  ],
});


--- src/rules/ci/depotdev.ts ---

import { register } from '../../register.js';

register({
  tech: 'depotdev',
  name: 'Depot.dev',
  type: 'ci',
  files: ['depot.json'],
  dependencies: [
    { type: 'githubAction', name: 'depot/setup-action' },
    { type: 'githubAction', name: 'depot/build-push-action' },
  ],
});


--- src/rules/ci/droneci.ts ---

import { register } from '../../register.js';

register({
  tech: 'droneci',
  name: 'DroneCI',
  type: 'ci',
  files: ['.drone.yml'],
  dependencies: [{ type: 'docker', name: 'drone/drone' }],
});


--- src/rules/ci/gcp.cloudbuild.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.cloudbuild',
  name: 'Cloud Build',
  type: 'ci',
  dependencies: [
    { type: 'npm', name: '@google-cloud/cloudbuild' },
    {
      type: 'terraform.resource',
      name: /^google_cloudbuild_/,
      example: 'google_cloudbuild_trigger',
    },
    {
      type: 'ruby',
      name: /^google-cloud-build/,
      example: 'google-cloud-build-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/cloudbuild' },
    { type: 'php', name: 'google/cloud-build' },
    { type: 'python', name: 'google-cloud-build' },
  ],
});


--- src/rules/ci/github.codeql.ts ---

import { register } from '../../register.js';

register({
  tech: 'github.codeql',
  name: 'GitHub CodeQL',
  type: 'ci',
  dependencies: [{ type: 'githubAction', name: 'github/codeql-action/analyze' }],
});


--- src/rules/ci/gitlab.ci.ts ---

import { register } from '../../register.js';

register({
  tech: 'gitlab.ci',
  name: 'Gitlab CI',
  type: 'ci',
  files: ['.gitlab-ci.yml', '.gitlab-ci.yaml'],
});


--- src/rules/ci/index.ts ---

import './appveyor.js';
import './atlassian.bitbucketpipelines.js';
import './aws.codebuild.js';
import './aws.codepipeline.js';
import './azure.ci.js';
import './browserstack.js';
import './circleci.js';
import './cirrusci.js';
import './cloudbees.codeship.js';
import './codeclimate.js';
import './codecov.js';
import './codesandboxci.js';
import './concourseci.js';
import './coveralls.js';
import './cypressci.js';
import './deepsource.js';
import './dependabot.js';
import './depotdev.js';
import './droneci.js';
import './gcp.cloudbuild.js';
import './github.codeql.js';
import './gitlab.ci.js';
import './jenkins.js';
import './nxcloud.js';
import './relativeci.js';
import './renovate.js';
import './sonarcloud.js';
import './sonarqube.js';
import './styleci.js';
import './teamcity.js';
import './travisci.js';
import './trufflesecurity.js';


--- src/rules/ci/jenkins.ts ---

import { register } from '../../register.js';

register({
  tech: 'jenkins',
  name: 'Jenkins',
  type: 'ci',
  files: ['.jenkins'],
  dependencies: [
    { type: 'docker', name: /jenkins-docker/, example: 'jenkins-docker:0.0.0' },
    { type: 'ruby', name: 'jenkins_api_client' },
  ],
});


--- src/rules/ci/nxcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'nxcloud',
  name: 'NX Cloud',
  type: 'ci',
  dependencies: [{ type: 'npm', name: 'nx-cloud' }],
});


--- src/rules/ci/relativeci.ts ---

import { register } from '../../register.js';

register({
  tech: 'relativeci',
  name: 'RelativeCI',
  type: 'ci',
  files: ['relativeci.config.js'],
  dependencies: [
    { type: 'npm', name: '@relative-ci/agent' },
    { type: 'githubAction', name: 'relative-ci/agent-action' },
  ],
});


--- src/rules/ci/renovate.ts ---

import { register } from '../../register.js';

register({
  tech: 'renovate',
  name: 'Renovate',
  type: 'ci',
  files: ['.renovaterc.json', '.renovaterc', 'renovate.json', 'renovate.json5'],
  dependencies: [{ type: 'npm', name: 'renovate' }],
});


--- src/rules/ci/sonarcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'sonarcloud',
  name: 'SonarCloud',
  type: 'ci',
  dependencies: [{ type: 'githubAction', name: 'SonarSource/sonarcloud-github-action' }],
});


--- src/rules/ci/sonarqube.ts ---

import { register } from '../../register.js';

register({
  tech: 'sonarqube',
  name: 'SonarQube',
  type: 'ci',
  files: ['.sonar-project.properties'],
  dependencies: [{ type: 'docker', name: 'sonarqube' }],
});


--- src/rules/ci/styleci.ts ---

import { register } from '../../register.js';

register({
  tech: 'styleci',
  name: 'StyleCI',
  type: 'ci',
  files: ['.styleci.yml', '.styleci.yaml'],
});


--- src/rules/ci/teamcity.ts ---

import { register } from '../../register.js';

register({
  tech: 'teamcity',
  name: 'TeamCity',
  type: 'ci',
  files: ['.teamcity'],
});


--- src/rules/ci/travisci.ts ---

import { register } from '../../register.js';

register({
  tech: 'travisci',
  name: 'TravisCI',
  type: 'ci',
  files: ['.travis.yml', '.travis.yaml'],
  dependencies: [{ type: 'ruby', name: 'travis' }],
});


--- src/rules/ci/trufflesecurity.ts ---

import { register } from '../../register.js';

register({
  tech: 'trufflesecurity',
  name: 'Truffle Security',
  type: 'ci',
  dependencies: [
    { type: 'docker', name: 'trufflesecurity/trufflehog' },
    { type: 'githubAction', name: 'trufflesecurity/trufflehog' },
  ],
});


--- src/rules/cloud.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../analyser/index.js';
import { rawList } from '../loader.js';
import { FakeProvider } from '../provider/fake.js';
import { listIndexed } from '../register.js';
import '../autoload.js';

describe('hosting', () => {
  it('should match everything with files', async () => {
    const paths: string[] = [];
    for (const item of rawList) {
      if (item.type !== 'file' || listIndexed[item.ref.tech].type !== 'cloud' || !item.ref.files) {
        continue;
      }

      paths.push('example' in item.ref ? item.ref.example : item.ref.files[0]);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': paths,
        },
        files: {},
      }),
    });

    expect(res.toJson('').techs).toMatchSnapshot();
  });
});


--- src/rules/cloud/adobe.ts ---

import { register } from '../../register.js';

register({
  tech: 'adobe',
  name: 'Adobe',
  type: 'cloud',
});


--- src/rules/cloud/akamai.ts ---

import { register } from '../../register.js';

register({
  tech: 'akamai',
  name: 'Akamai',
  type: 'cloud',
  dotenv: ['AKAMAI_'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/akamai/akamai' },
    { type: 'npm', name: 'akamai-edgegrid' },
  ],
});


--- src/rules/cloud/alibabacloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'alibabacloud',
  name: 'Alibaba Cloud',
  type: 'cloud',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/aliyun/alicloud' },
    { type: 'php', name: 'alibabacloud/sdk' },
    { type: 'php', name: 'alibabacloud/client' },
    { type: 'githubAction', name: 'aliyun/acr-login' },
  ],
});


--- src/rules/cloud/apple.ts ---

import { register } from '../../register.js';

register({
  tech: 'apple',
  name: 'Apple',
  type: 'cloud',
  dotenv: ['APPLE_ID'],
});


--- src/rules/cloud/atlassian.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlassian',
  name: 'Atlassian',
  type: 'cloud',
  dependencies: [{ type: 'python', name: 'atlassian-python-api' }],
});


--- src/rules/cloud/aws.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws',
  name: 'AWS',
  type: 'cloud',
  dependencies: [
    { type: 'npm', name: 'aws-sdk' },
    { type: 'npm', name: 'aws4fetch' },
    { type: 'npm', name: /^@aws-sdk\//, example: '@aws-sdk/client-' },
    { type: 'npm', name: '@pulumi/aws' },
    { type: 'npm', name: '@pulumi/awsx' },
    { type: 'terraform', name: 'registry.terraform.io/hashicorp/aws' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2' },
    { type: 'rust', name: /^aws-sdk/, example: 'aws-sdk-e2' },
    { type: 'ruby', name: /^aws-sdk/, example: 'aws-sdk-e2' },
    { type: 'docker', name: 'amazon/aws-cli' },
    { type: 'php', name: 'aws/aws-sdk-php' },
    { type: 'githubAction', name: 'aws-actions/configure-aws-credentials' },
  ],
});


--- src/rules/cloud/azure.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure',
  name: 'Azure',
  type: 'cloud',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/hashicorp/azurerm' },
    { type: 'golang', name: 'github.com/Azure/azure-sdk-for-go' },
    { type: 'rust', name: 'azure_core' },
    { type: 'ruby', name: 'azure-armrest' },
    { type: 'githubAction', name: 'azure/login' },
    { type: 'githubAction', name: 'azure/CLI' },
    { type: 'githubAction', name: 'azure/powershell' },
    { type: 'docker', name: 'bitnami/azure-cli' },
    { type: 'docker', name: 'cimg/azure' },
    { type: 'docker', name: 'webdevops/azure-devops-exporter' },
    { type: 'docker', name: 'webdevops/azure-metrics-exporter' },
    { type: 'npm', name: '@pulumi/azure' },
    { type: 'python', name: 'azure-identity' },
    { type: 'npm', name: '@azure/identity' },
    { type: 'npm', name: '@azure/msal-browser' },
    { type: 'npm', name: '@azure/msal-node' },
  ],
});


--- src/rules/cloud/cloudbees.ts ---

import { register } from '../../register.js';

register({
  tech: 'cloudbees',
  name: 'CloudBees',
  type: 'cloud',
  dotenv: ['CLOUDBEES_'],
});


--- src/rules/cloud/cloudflare.ts ---

import { register } from '../../register.js';

register({
  tech: 'cloudflare',
  name: 'Cloudflare',
  type: 'cloud',
  dotenv: ['CLOUDFLARE_'],
  dependencies: [
    {
      type: 'npm',
      name: /^@cloudflare\//,
      example: '@cloudflare/kv-asset-handler',
    },
    { type: 'npm', name: '@pulumi/cloudflare' },
    { type: 'terraform', name: 'registry.terraform.io/cloudflare/cloudflare' },
    { type: 'rust', name: 'cloudflare' },
    { type: 'ruby', name: 'cloudflare-rails' },
    { type: 'php', name: 'cloudflare/sdk' },
  ],
});


--- src/rules/cloud/dokku.ts ---

import { register } from '../../register.js';

register({
  tech: 'dokku',
  name: 'Dokku',
  type: 'cloud',
  dotenv: ['DOKKU_'],
  dependencies: [
    { type: 'githubAction', name: 'dokku/github-action' },
    { type: 'docker', name: 'dokku/ci-docker-image' },
    { type: 'docker', name: 'dokku/dokku' },
  ],
});


--- src/rules/cloud/equinix.ts ---

import { register } from '../../register.js';

register({
  tech: 'equinix',
  name: 'Equinix',
  type: 'cloud',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/equinix/equinix' },
    { type: 'terraform', name: 'registry.terraform.io/equinix/metal' },
  ],
});


--- src/rules/cloud/firebase.ts ---

import { register } from '../../register.js';

register({
  tech: 'firebase',
  name: 'Firebase',
  type: 'cloud',
  files: ['.firebaserc'],
  dotenv: ['FIREBASE_'],
  dependencies: [
    { type: 'ruby', name: 'fastlane-plugin-firebase_app_distribution' },
    { type: 'rust', name: 'firebase-rs' },
    { type: 'npm', name: 'firebase' },
    { type: 'npm', name: /^@firebase\//, example: '@firebase/auth' },
    { type: 'githubAction', name: 'w9jds/firebase-action' },
    {
      type: 'githubAction',
      name: 'wzieba/Firebase-Distribution-Github-Action',
    },
  ],
});


--- src/rules/cloud/flyio.ts ---

import { register } from '../../register.js';

register({
  tech: 'flyio',
  name: 'Flyio',
  type: 'cloud',
  files: ['fly.toml'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/fly-apps/fly' },
    { type: 'githubAction', name: 'superfly/flyctl-actions/setup-flyctl' },
  ],
});


--- src/rules/cloud/gcp.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp',
  name: 'GCP',
  type: 'cloud',
  dotenv: ['GOOGLE_CLOUD_CREDENTIALS', 'GOOGLE_CLOUD_PROJECT'],
  dependencies: [
    { type: 'npm', name: 'googleapis' },
    { type: 'npm', name: /^@google-cloud\//, example: '@google-cloud/' },
    { type: 'terraform', name: 'registry.terraform.io/hashicorp/google' },
    { type: 'php', name: 'google/cloud' },
    { type: 'githubAction', name: 'google-github-actions/auth' },
    { type: 'githubAction', name: 'google-github-actions/setup-gcloud' },
    { type: 'npm', name: '@pulumi/gcp' },
    { type: 'npm', name: 'google-auth-library' },
    { type: 'npm', name: 'passport-google-oauth20' },
    { type: 'npm', name: 'passport-google-oauth' },
    { type: 'python', name: 'google-api-python-client' },
  ],
});


--- src/rules/cloud/google.ts ---

import { register } from '../../register.js';

register({
  tech: 'google',
  name: 'Google',
  type: 'cloud',
});


--- src/rules/cloud/heroku.ts ---

import { register } from '../../register.js';

register({
  tech: 'heroku',
  name: 'Heroku',
  type: 'cloud',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/heroku/heroku' },
    { type: 'ruby', name: 'platform-api' },
    { type: 'php', name: 'heroku/heroku-buildpack-php' },
    { type: 'githubAction', name: 'akhileshns/heroku-deploy' },
  ],
});


--- src/rules/cloud/hetzner.ts ---

import { register } from '../../register.js';

register({
  tech: 'hetzner',
  name: 'Hetzner',
  type: 'cloud',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/hetznercloud/hcloud' },
    { type: 'golang', name: 'github.com/hetznercloud/hcloud-go/v2/hcloud' },
    { type: 'python', name: 'hcloud' },
    { type: 'php', name: 'lkdevelopment/hetzner-cloud-php-sdk' },
    { type: 'ruby', name: 'hetznercloud' },
  ],
});


--- src/rules/cloud/hostinger.ts ---

import { register } from '../../register.js';

register({
  tech: 'hostinger',
  name: 'Hostinger',
  type: 'cloud',
  dependencies: [
    { type: 'php', name: 'hostinger/api-php-sdk' },
    { type: 'python', name: 'hostinger_api' },
    { type: 'npm', name: 'hostinger-api-sdk' },
  ],
});


--- src/rules/cloud/ibmcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'ibmcloud',
  name: 'IBM Cloud',
  type: 'cloud',
  dependencies: [{ type: 'terraform', name: 'registry.terraform.io/IBM-Cloud/ibm' }],
});


--- src/rules/cloud/index.ts ---

import './adobe.js';
import './akamai.js';
import './alibabacloud.js';
import './apple.js';
import './atlassian.js';
import './aws.js';
import './azure.js';
import './cloudbees.js';
import './cloudflare.js';
import './dokku.js';
import './equinix.js';
import './firebase.js';
import './flyio.js';
import './gcp.js';
import './google.js';
import './heroku.js';
import './hetzner.js';
import './hostinger.js';
import './ibmcloud.js';
import './microsoft.js';
import './netlify.js';
import './nextcloud.js';
import './oraclecloud.js';
import './ovh.js';
import './qovery.js';
import './railway.js';
import './scaleway.js';
import './supabase.js';
import './upstash.js';
import './vercel.js';


--- src/rules/cloud/microsoft.ts ---

import { register } from '../../register.js';

register({
  tech: 'microsoft',
  name: 'Microsoft',
  type: 'cloud',
});


--- src/rules/cloud/netlify.ts ---

import { register } from '../../register.js';

register({
  tech: 'netlify',
  name: 'Netlify',
  type: 'cloud',
  files: ['netlify.toml'],
  dependencies: [
    { type: 'npm', name: 'netlify' },
    { type: 'npm', name: 'netlify-cli' },
    { type: 'npm', name: '@netlify/build' },
    { type: 'npm', name: '@netlify/plugin-emails' },
    { type: 'npm', name: '@netlify/config' },
    { type: 'npm', name: '@netlify/functions-utils' },
    { type: 'npm', name: '@netlify/cache-utils' },
    { type: 'npm', name: '@netlify/run-utils' },
    { type: 'githubAction', name: 'nwtgck/actions-netlify' },
  ],
});


--- src/rules/cloud/nextcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'nextcloud',
  name: 'Nextcloud',
  type: 'cloud',
  dependencies: [
    { type: 'docker', name: 'nextcloud/all-in-one' },
    { type: 'docker', name: 'nextcloud' },
    { type: 'docker', name: 'nextcloud/aio-nextcloud' },
  ],
});


--- src/rules/cloud/oraclecloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'oraclecloud',
  name: 'Oracle Cloud',
  type: 'cloud',
  dependencies: [
    { type: 'npm', name: /^oci-/, example: 'oci-sdk' },
    { type: 'terraform', name: 'registry.terraform.io/oracle/oci' },
    { type: 'ruby', name: 'oci' },
    { type: 'php', name: 'oracle/oci-php-sdk' },
  ],
});


--- src/rules/cloud/ovh.ts ---

import { register } from '../../register.js';

register({
  tech: 'ovh',
  name: 'OVH',
  type: 'cloud',
  dotenv: ['OVH_'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/ovh/ovh' },
    { type: 'npm', name: '@ovh-api/api' },
    { type: 'npm', name: '@ovhcloud/pulumi-ovh' },
    { type: 'php', name: 'ovh/ovh' },
  ],
});


--- src/rules/cloud/qovery.ts ---

import { register } from '../../register.js';

register({
  tech: 'qovery',
  name: 'Qovery',
  type: 'cloud',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/Qovery/qovery' },
    { type: 'npm', name: 'qovery-typescript-axios' },
    { type: 'npm', name: 'qovery/qovery-client-javascript' },
    { type: 'npm', name: 'qovery_api' },
    { type: 'npm', name: 'qovery-ws-typescript-axios' },
    { type: 'docker', name: 'public.ecr.aws/r3m4q3r9/qovery-cli' },
    { type: 'golang', name: 'github.com/qovery/qovery-client-go' },
    { type: 'githubAction', name: 'Qovery/qovery-action' },
  ],
});


--- src/rules/cloud/railway.ts ---

import { register } from '../../register.js';

register({
  tech: 'railway',
  name: 'Railway',
  type: 'cloud',
  files: ['railway.toml', 'railway.json'],
  dotenv: ['RAILWAY_'],
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/terraform-community-providers/railway',
    },
    { type: 'npm', name: 'railway' },
    { type: 'npm', name: '@railway/cli' },
    { type: 'githubAction', name: 'bervProject/railway-deploy' },
  ],
});


--- src/rules/cloud/scaleway.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway',
  name: 'Scaleway',
  type: 'cloud',
  dependencies: [
    { type: 'npm', name: '@scaleway/sdk' },
    { type: 'terraform', name: 'registry.terraform.io/scaleway/scaleway' },
    { type: 'githubAction', name: 'scaleway/action-scw' },
  ],
});


--- src/rules/cloud/supabase.ts ---

import { register } from '../../register.js';

register({
  tech: 'supabase',
  name: 'Supabase',
  type: 'cloud',
  dotenv: ['SUPABASE_'],
  dependencies: [
    { type: 'npm', name: /^@supabase\//, example: '@supabase/supabase.js' },
    { type: 'githubAction', name: 'supabase/setup-cli' },
    { type: 'docker', name: 'supabase/studio' },
    { type: 'python', name: 'supabase' },
  ],
});


--- src/rules/cloud/upstash.ts ---

import { register } from '../../register.js';

register({
  tech: 'upstash',
  name: 'Upstash',
  type: 'cloud',
  dependencies: [{ type: 'npm', name: /^@upstash\//, example: '@upstash/ratelimit' }],
});


--- src/rules/cloud/vercel.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel',
  name: 'Vercel',
  type: 'cloud',
  files: ['.vercel', 'vercel.json'],
  dependencies: [
    { type: 'npm', name: 'vercel' },
    { type: 'npm', name: '@vercel/client' },
    { type: 'terraform', name: 'registry.terraform.io/vercel/vercel' },
    { type: 'rust', name: /^vercel_/, example: 'vercel_runtime' },
    { type: 'githubAction', name: 'snaplet/vercel-action' },
    { type: 'githubAction', name: 'amondnet/vercel-action' },
    { type: 'terraform.resource', name: 'airbyte_source_vercel' },
  ],
});


--- src/rules/cms/adobe.commercecloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'adobe.commercecloud',
  name: 'Adobe Commerce Cloud',
  type: 'cms',
});


--- src/rules/cms/adobe.experiencemanager.ts ---

import { register } from '../../register.js';

register({
  tech: 'adobe.experiencemanager',
  name: 'Adobe Experience Manager',
  type: 'cms',
  dotenv: ['AEM_'],
  dependencies: [{ type: 'npm', name: 'aemsync' }],
});


--- src/rules/cms/bigcommerce.ts ---

import { register } from '../../register.js';

register({
  tech: 'bigcommerce',
  name: 'BigCommerce',
  type: 'cms',
  dependencies: [
    { type: 'php', name: 'bigcommerce/api' },
    { type: 'npm', name: '@bigcommerce/checkout-sdk' },
    { type: 'terraform.resource', name: 'airbyte_source_bigcommerce' },
  ],
});


--- src/rules/cms/commercetools.ts ---

import { register } from '../../register.js';

register({
  tech: 'commercetools',
  name: 'Commercetools',
  type: 'cms',
  dependencies: [
    { type: 'npm', name: '@commercetools/platform-sdk' },
    { type: 'npm', name: '@commercetools/sdk-client-v2' },
    { type: 'npm', name: '@commercetools/sdk-middleware-http' },
  ],
});


--- src/rules/cms/contentful.ts ---

import { register } from '../../register.js';

register({
  tech: 'contentful',
  name: 'Contentful',
  type: 'cms',
  dotenv: ['CONTENTFUL_'],
  dependencies: [
    { type: 'php', name: 'contentful/contentful' },
    { type: 'php', name: 'contentful/contentful-management' },
    { type: 'npm', name: 'contentful' },
    { type: 'npm', name: 'contentful-management' },
  ],
});


--- src/rules/cms/datocms.ts ---

import { register } from '../../register.js';

register({
  tech: 'datocms',
  name: 'Dato CMS',
  type: 'cms',
  dependencies: [
    { type: 'npm', name: 'datocms-structured-text-utils' },
    { type: 'npm', name: '@datocms/cma-client' },
    { type: 'npm', name: '@datocms/cma-client-node' },
    { type: 'npm', name: 'datocms-client' },
    { type: 'npm', name: '@datocms/cli' },
    { type: 'npm', name: 'vue-datocms' },
    { type: 'npm', name: 'react-datocms' },
    { type: 'npm', name: 'datocms-react-ui' },
    { type: 'npm', name: 'datocms-plugin-sdk' },
    { type: 'npm', name: 'gatsby-source-datocms' },
  ],
});


--- src/rules/cms/drupal.ts ---

import { register } from '../../register.js';

register({
  tech: 'drupal',
  name: 'Drupal',
  type: 'cms',
  dependencies: [
    { type: 'docker', name: 'drupal' },
    { type: 'php', name: 'drupal/core' },
    { type: 'php', name: 'drupal/core-recommended' },
    { type: 'php', name: 'drupal/drupal-extension' },
    { type: 'php', name: 'webflo/drupal-finder' },
    { type: 'php', name: 'mglaman/phpstan-drupal' },
  ],
});


--- src/rules/cms/fabric.ts ---

import { register } from '../../register.js';

register({
  tech: 'fabric',
  name: 'Fabric',
  type: 'cms',
});


--- src/rules/cms/ghost.ts ---

import { register } from '../../register.js';

register({
  tech: 'ghost',
  name: 'Ghost',
  type: 'cms',
  dotenv: ['GHOST_'],
  dependencies: [
    { type: 'docker', name: 'ghost' },
    { type: 'npm', name: 'ghost-cli' },
    { type: 'npm', name: '@tryghost/content-api' },
  ],
});


--- src/rules/cms/gitbook.ts ---

import { register } from '../../register.js';

register({
  tech: 'gitbook',
  name: 'Gitbook',
  type: 'cms',
  dependencies: [{ type: 'npm', name: /^@gitbook\//, example: '@gitbook/api' }],
});


--- src/rules/cms/index.ts ---

import './adobe.commercecloud.js';
import './adobe.experiencemanager.js';
import './bigcommerce.js';
import './commercetools.js';
import './contentful.js';
import './datocms.js';
import './drupal.js';
import './fabric.js';
import './ghost.js';
import './gitbook.js';
import './joomla.js';
import './kentico.js';
import './magento.js';
import './payloadcms.js';
import './prestashop.js';
import './sanity.js';
import './shopify.js';
import './sitecore.xmcloud.js';
import './squarespace.js';
import './storyblok.js';
import './strapi.js';
import './webflow.js';
import './woocommerce.js';
import './wordpress.js';


--- src/rules/cms/joomla.ts ---

import { register } from '../../register.js';

register({
  tech: 'joomla',
  name: 'Joomla!',
  type: 'cms',
  dependencies: [
    { type: 'php', name: 'joomla/application' },
    { type: 'docker', name: 'joomla' },
  ],
});


--- src/rules/cms/kentico.ts ---

import { register } from '../../register.js';

register({
  tech: 'kentico',
  name: 'Kentico',
  type: 'cms',
  dependencies: [
    { type: 'npm', name: '@kentico/xperience-admin-components' },
    { type: 'npm', name: 'kentico-kontent-nuxt-module' },
    { type: 'npm', name: '@kentico/gatsby-source-kontent' },
    {
      type: 'npm',
      name: '@sonarsource/marketing-gatsby-transformer-kontent-graphql',
    },
    { type: 'ruby', name: 'delivery-sdk-ruby' },
  ],
});


--- src/rules/cms/magento.ts ---

import { register } from '../../register.js';

register({
  tech: 'magento',
  name: 'Magento',
  type: 'cms',
  dependencies: [
    { type: 'php', name: 'magento/composer' },
    { type: 'php', name: 'fastly/magento2' },
    { type: 'php', name: 'smile/elasticsuite' },
    { type: 'npm', name: '@adobe/magento-storefront-events-sdk' },
  ],
});


--- src/rules/cms/payloadcms.ts ---

import { register } from '../../register.js';

register({
  tech: 'payloadcms',
  name: 'Payload',
  type: 'cms',
  dependencies: [
    { type: 'npm', name: 'payload' },
    { type: 'npm', name: '@payload/plugin-seo' },
  ],
});


--- src/rules/cms/prestashop.ts ---

import { register } from '../../register.js';

register({
  tech: 'prestashop',
  name: 'Prestashop',
  type: 'cms',
  dependencies: [
    { type: 'php', name: 'prestashop/ps_facetedsearch' },
    { type: 'php', name: 'prestashop/ps_shoppingcart' },
    { type: 'php', name: 'prestashop/ps_currencyselector' },
  ],
});


--- src/rules/cms/sanity.ts ---

import { register } from '../../register.js';

register({
  tech: 'sanity',
  name: 'Sanity',
  type: 'cms',
  dependencies: [{ type: 'npm', name: 'sanity' }],
});


--- src/rules/cms/shopify.ts ---

import { register } from '../../register.js';

register({
  tech: 'shopify',
  name: 'Shopify',
  type: 'cms',
  dependencies: [
    { type: 'npm', name: '@shopify/shopify-api' },
    { type: 'npm', name: '@shopify/cli' },
    { type: 'npm', name: 'shopify-api-node' },
    { type: 'php', name: 'shopify/shopify-api' },
    { type: 'php', name: 'phpclassic/php-shopify' },
    { type: 'ruby', name: 'shopify_api' },
    { type: 'ruby', name: 'shopify_app' },
    { type: 'ruby', name: 'shopify-cli' },
  ],
});


--- src/rules/cms/sitecore.xmcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'sitecore.xmlcloud',
  name: 'Sitecore XM cloud',
  type: 'cms',
  dependencies: [
    {
      type: 'npm',
      name: /^@sitecore-jss\/sitecore-jss/,
      example: '@sitecore-jss/sitecore-jss-nextjs',
    },
  ],
});


--- src/rules/cms/squarespace.ts ---

import { register } from '../../register.js';

register({
  tech: 'squarespace',
  name: 'Squarespace',
  type: 'cms',
  dependencies: [{ type: 'npm', name: /^@squarespace\//, example: '@squarespace/server' }],
});


--- src/rules/cms/storyblok.ts ---

import { register } from '../../register.js';

register({
  tech: 'storyblok',
  name: 'Storyblok',
  type: 'cms',
  dependencies: [
    { type: 'npm', name: 'storyblok' },
    { type: 'npm', name: /^@storyblok\//, example: '@storyblok/react' },
    { type: 'php', name: 'storyblok/php-content-api-client' },
    { type: 'php', name: 'storyblok/php-client' },
    { type: 'python', name: 'storyblok' },
    { type: 'ruby', name: 'storyblok' },
  ],
});


--- src/rules/cms/strapi.ts ---

import { register } from '../../register.js';

register({
  tech: 'strapi',
  name: 'Strapi',
  type: 'cms',
  dotenv: ['STRAPI_'],
  dependencies: [
    { type: 'npm', name: 'strapi' },
    { type: 'npm', name: '@strapi/strapi' },
    { type: 'docker', name: /strapi/, example: 'strapi:0.0.0' },
  ],
});


--- src/rules/cms/webflow.ts ---

import { register } from '../../register.js';

register({
  tech: 'webflow',
  name: 'Webflow',
  type: 'cms',
  dotenv: ['WEBFLOW_'],
  dependencies: [
    { type: 'npm', name: 'webflow-api' },
    { type: 'terraform.resource', name: 'airbyte_source_webflow' },
  ],
});


--- src/rules/cms/woocommerce.ts ---

import { register } from '../../register.js';

register({
  tech: 'woocommerce',
  name: 'WooCommerce',
  type: 'cms',
  dotenv: ['WOOCOMMERCE_'],
  dependencies: [
    { type: 'php', name: 'automattic/woocommerce' },
    { type: 'terraform.resource', name: 'airbyte_source_woocommerce' },
  ],
});


--- src/rules/cms/wordpress.ts ---

import { register } from '../../register.js';

register({
  tech: 'wordpress',
  name: 'Wordpress',
  type: 'cms',
  dotenv: ['WP_'],
  dependencies: [
    { type: 'php', name: 'wp-cli/wp-cli' },
    { type: 'php', name: 'roots/wordpress' },
    { type: 'php', name: 'johnpbloch/wordpress' },
    { type: 'githubAction', name: '10up/action-wordpress-plugin-deploy' },
    { type: 'docker', name: 'wordpress' },
    { type: 'npm', name: 'gatsby-source-wordpress' },
    { type: 'npm', name: '@wordpress/block-editor' },
    { type: 'npm', name: '@wordpress/data' },
    { type: 'npm', name: '@wordpress/blocks' },
    { type: 'npm', name: '@wordpress/api-fetch' },
    { type: 'npm', name: '@wordpress/i18n' },
    { type: 'npm', name: '@wordpress/hooks' },
  ],
});


--- src/rules/collaboration/airtable.ts ---

import { register } from '../../register.js';

register({
  tech: 'airtable',
  name: 'Airtable',
  type: 'collaboration',
  dotenv: ['AIRTABLE_'],
  dependencies: [
    { type: 'npm', name: 'airtable' },
    { type: 'php', name: 'sleiman/airtable-php' },
  ],
});


--- src/rules/collaboration/asana.ts ---

import { register } from '../../register.js';

register({
  tech: 'asana',
  name: 'Asana',
  type: 'collaboration',
  dotenv: ['ASANA_'],
  dependencies: [
    { type: 'npm', name: 'asana' },
    { type: 'python', name: 'asana' },
    { type: 'ruby', name: 'asana' },
    { type: 'php', name: 'asana/asana' },
    { type: 'golang', name: 'github.com/Asana/go-asana' },
    { type: 'terraform.resource', name: 'airbyte_source_asana' },
  ],
});


--- src/rules/collaboration/atlassian.confluence.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlassian.confluence',
  name: 'Confluence',
  type: 'collaboration',
  dependencies: [
    { type: 'githubAction', name: 'Bhacaz/docs-as-code-confluence' },
    { type: 'docker', name: 'atlassian/confluence-server' },
    { type: 'docker', name: 'atlassian/confluence' },
    { type: 'npm', name: 'confluence.js' },
    { type: 'npm', name: 'confluence-api' },
  ],
});


--- src/rules/collaboration/atlassian.jira.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlassian.jira',
  name: 'Jira',
  type: 'collaboration',
  dependencies: [
    { type: 'githubAction', name: 'atlassian/gajira-todo' },
    { type: 'githubAction', name: 'github/ghas-jira-integration' },
    { type: 'githubAction', name: 'atlassian/gajira-transition' },
    { type: 'githubAction', name: 'atlassian/gajira-create' },
    { type: 'githubAction', name: 'atlassian/gajira-cli' },
    { type: 'githubAction', name: 'atlassian/gajira-find-issue-key' },
    { type: 'githubAction', name: 'atlassian/gajira-comment' },
    { type: 'docker', name: 'atlassian/jira-software' },
    { type: 'npm', name: 'jira.js' },
    { type: 'php', name: 'lesstif/php-jira-rest-client' },
    { type: 'ruby', name: 'jira-ruby' },
    { type: 'terraform.resource', name: 'gitlab_integration_jira' },
    { type: 'terraform.resource', name: 'airbyte_source_jira' },
  ],
});


--- src/rules/collaboration/atlassian.opsgenie.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlassian.opsgenie',
  name: 'Atlassian OpsGenie',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: 'opsgenie-sdk' },
    { type: 'npm', name: '@pulumi/opsgenie' },
  ],
});


--- src/rules/collaboration/atlassian.trello.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlassian.trello',
  name: 'Atlassian Trello',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: 'trello' },
    { type: 'npm', name: 'react-trello' },
    { type: 'npm', name: 'node-trello' },
    { type: 'ruby', name: 'ruby-trello' },
    { type: 'php', name: 'cdaguerre/php-trello-api' },
    { type: 'githubAction', name: 'jessicazu/trello-github-actions' },
  ],
});


--- src/rules/collaboration/calcom.ts ---

import { register } from '../../register.js';

register({
  tech: 'calcom',
  name: 'Cal.com',
  type: 'collaboration',
  dependencies: [{ type: 'npm', name: /^@calcom\//, example: '@calcom/sdk' }],
});


--- src/rules/collaboration/calendly.ts ---

import { register } from '../../register.js';

register({
  tech: 'calendly',
  name: 'Calendly',
  type: 'collaboration',
  dotenv: ['CALENDLY_'],
  dependencies: [{ type: 'npm', name: 'react-calendly' }],
});


--- src/rules/collaboration/clickup.ts ---

import { register } from '../../register.js';

register({
  tech: 'clickup',
  name: 'ClickUp',
  type: 'collaboration',
  dotenv: ['CLICKUP_'],
});


--- src/rules/collaboration/crowdin.ts ---

import { register } from '../../register.js';

register({
  tech: 'crowdin',
  name: 'Crowdin',
  type: 'collaboration',
  files: ['crowdin.yml', 'crowdin.yaml'],
  dependencies: [
    {
      type: 'npm',
      name: /^@crowdin\//,
      example: '@crowdin/crowdin-api-client',
    },
    { type: 'php', name: 'crowdin/crowdin-api-client' },
  ],
});


--- src/rules/collaboration/google.calendar.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.calendar',
  name: 'Google Calendar',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/calendar' },
    { type: 'php', name: 'spatie/laravel-google-calendar' },
    { type: 'ruby', name: 'google-apis-calendar_v3' },
    { type: 'ruby', name: 'google_calendar' },
    { type: 'python', name: 'langchain-google-calendar-tools' },
  ],
});


--- src/rules/collaboration/google.chat.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.chat',
  name: 'Google Chat',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/chat' },
    { type: 'terraform.resource', name: 'airbyte_source_google_calendar' },
    { type: 'ruby', name: 'google-apis-chat_v1' },
    { type: 'ruby', name: 'google-apps-chat-v1' },
    { type: 'ruby', name: 'google-apps-chat' },
  ],
});


--- src/rules/collaboration/google.docs.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.docs',
  name: 'Google Docs',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/docs' },
    { type: 'ruby', name: 'google-apis-docs_v1' },
  ],
});


--- src/rules/collaboration/google.drive.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.drive',
  name: 'Google Drive',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/drive' },
    { type: 'npm', name: 'react-google-drive-picker' },
    { type: 'npm', name: '@uppy/google-drive-picker' },
    { type: 'terraform.resource', name: 'airbyte_source_google_drive' },
    { type: 'ruby', name: 'google-apis-drive_v2' },
    { type: 'ruby', name: 'google-apis-drive_v3' },
    { type: 'rust', name: 'google-drive' },
  ],
});


--- src/rules/collaboration/google.forms.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.forms',
  name: 'Google Forms',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/forms' },
    { type: 'terraform.resource', name: 'airbyte_source_google_forms' },
    { type: 'ruby', name: 'google-apis-forms_v1' },
  ],
});


--- src/rules/collaboration/google.gmail.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.gmail',
  name: 'Gmail',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/gmail' },
    { type: 'ruby', name: 'google-apis-gmail_v1' },
  ],
});


--- src/rules/collaboration/google.keep.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.keep',
  name: 'Google Keep',
  type: 'collaboration',
  dependencies: [{ type: 'ruby', name: 'google-apis-keep_v1' }],
});


--- src/rules/collaboration/google.meet.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.meet',
  name: 'Google Meet',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@google-apps/meet' },
    { type: 'ruby', name: 'google-apis-meet_v2' },
    { type: 'ruby', name: 'google-apps-meet-v2' },
    { type: 'ruby', name: 'google-apps-meet' },
  ],
});


--- src/rules/collaboration/google.sheets.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.sheets',
  name: 'Google Sheets',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/sheets' },
    { type: 'npm', name: 'google-spreadsheet' },
    { type: 'php', name: 'revolution/laravel-google-sheets' },
    { type: 'ruby', name: 'google-apis-sheets_v4' },
    { type: 'rust', name: 'sheets' },
    { type: 'terraform.resource', name: 'airbyte_destination_google_sheets' },
  ],
});


--- src/rules/collaboration/google.slides.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.slides',
  name: 'Google Slides',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/slides' },
    { type: 'ruby', name: 'google-apis-slides_v1' },
  ],
});


--- src/rules/collaboration/google.tasks.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.tasks',
  name: 'Google Tasks',
  type: 'collaboration',
  dependencies: [
    { type: 'npm', name: '@googleapis/tasks' },
    { type: 'ruby', name: 'google-apis-tasks_v1' },
  ],
});


--- src/rules/collaboration/index.ts ---

import './airtable.js';
import './asana.js';
import './atlassian.confluence.js';
import './atlassian.jira.js';
import './atlassian.opsgenie.js';
import './atlassian.trello.js';
import './calcom.js';
import './calendly.js';
import './clickup.js';
import './crowdin.js';
import './google.calendar.js';
import './google.chat.js';
import './google.docs.js';
import './google.drive.js';
import './google.forms.js';
import './google.gmail.js';
import './google.keep.js';
import './google.meet.js';
import './google.sheets.js';
import './google.slides.js';
import './google.tasks.js';
import './linear.js';
import './microsoft.onedrive.js';
import './miro.js';
import './monday.js';
import './notion.js';


--- src/rules/collaboration/linear.ts ---

import { register } from '../../register.js';

register({
  tech: 'linear',
  name: 'Linear',
  type: 'collaboration',
  dotenv: ['LINEAR_'],
  dependencies: [
    { type: 'npm', name: '@linear/sdk' },
    { type: 'python', name: 'linear-cli' },
  ],
});


--- src/rules/collaboration/microsoft.onedrive.ts ---

import { register } from '../../register.js';

register({
  tech: 'microsoft.onedrive',
  name: 'OneDrive',
  type: 'collaboration',
  dependencies: [
    { type: 'rust', name: 'onedrive-api' },
    { type: 'php', name: 'krizalys/onedrive-php-sdk' },
    { type: 'npm', name: '@uppy/onedrive' },
    { type: 'terraform.resource', name: 'airbyte_source_microsoft_onedrive' },
  ],
});


--- src/rules/collaboration/miro.ts ---

import { register } from '../../register.js';

register({
  tech: 'miro',
  name: 'Miro',
  type: 'collaboration',
  dotenv: ['MIRO_'],
  dependencies: [{ type: 'npm', name: '@mirohq/miro-api' }],
});


--- src/rules/collaboration/monday.ts ---

import { register } from '../../register.js';

register({
  tech: 'monday',
  name: 'Monday',
  type: 'collaboration',
  dependencies: [
    {
      type: 'npm',
      name: 'monday-sdk-js',
    },
  ],
});


--- src/rules/collaboration/notion.ts ---

import { register } from '../../register.js';

register({
  tech: 'notion',
  name: 'Notion',
  type: 'collaboration',
  dotenv: ['NOTION_'],
  dependencies: [
    { type: 'npm', name: '@notionhq/client' },
    { type: 'npm', name: 'notion-to-md' },
    { type: 'php', name: 'fiveam-code/laravel-notion-api' },
    { type: 'ruby', name: 'notion-ruby-client' },
    { type: 'rust', name: 'notion' },
  ],
});


--- src/rules/communication/aircall.ts ---

import { register } from '../../register.js';

register({
  tech: 'aircall',
  name: 'Aircall',
  type: 'communication',
  dotenv: ['AIRCALL_'],
  dependencies: [
    { type: 'npm', name: 'aircall-everywhere' },
    { type: 'npm', name: 'aircall' },
    { type: 'terraform.resource', name: 'airbyte_source_aircall' },
  ],
});


--- src/rules/communication/discord.ts ---

import { register } from '../../register.js';

register({
  tech: 'discord',
  name: 'Discord',
  type: 'communication',
  dotenv: ['DISCORD_'],
  dependencies: [
    { type: 'npm', name: 'discord.js' },
    {
      type: 'npm',
      name: 'discord-interactions',
    },
    { type: 'githubAction', name: 'Ilshidur/action-discord' },
  ],
});


--- src/rules/communication/facebook.ts ---

import { register } from '../../register.js';

register({
  tech: 'facebook',
  name: 'Facebook',
  type: 'communication',
  dotenv: ['FACEBOOK_'],
  dependencies: [
    { type: 'npm', name: 'facebook-nodejs-business-sdk' },
    { type: 'npm', name: 'passport-facebook' },
  ],
});


--- src/rules/communication/freshdesk.ts ---

import { register } from '../../register.js';

register({
  tech: 'freshdesk',
  name: 'Freshdesk',
  type: 'communication',
  dotenv: ['FRESHDESK_'],
  dependencies: [
    { type: 'npm', name: 'freshdesk-api' },
    { type: 'npm', name: 'freshdesk' },
    { type: 'python', name: 'freshdesk' },
    { type: 'ruby', name: 'freshdesk_api' },
    { type: 'php', name: 'freshdesk/freshdesk-php' },
    { type: 'golang', name: 'github.com/freshdesk/freshdesk-go' },
  ],
});


--- src/rules/communication/index.ts ---

import './aircall.js';
import './discord.js';
import './facebook.js';
import './freshdesk.js';
import './instagram.js';
import './intercom.js';
import './linkedin.js';
import './mattermost.js';
import './reddit.js';
import './slack.js';
import './telegram.js';
import './twitch.js';
import './twitter.js';
import './whatsapp.js';
import './wikipedia.js';
import './youtube.js';
import './zendesk.js';
import './zoom.js';


--- src/rules/communication/instagram.ts ---

import { register } from '../../register.js';

register({
  tech: 'instagram',
  name: 'Instagram',
  type: 'communication',
  dotenv: ['INSTAGRAM_'],
});


--- src/rules/communication/intercom.ts ---

import { register } from '../../register.js';

register({
  tech: 'intercom',
  name: 'Intercom',
  type: 'communication',
  dotenv: ['INTERCOM_'],
  dependencies: [
    { type: 'npm', name: 'react-use-intercom' },
    { type: 'npm', name: 'intercom-client' },
    { type: 'npm', name: '@intercom/intercom-react-native' },
    { type: 'npm', name: 'ng-intercom' },
    { type: 'php', name: 'intercom/intercom-php' },
    { type: 'php', name: 'intercom/oauth2-intercom' },
    { type: 'ruby', name: 'intercom' },
    { type: 'ruby', name: 'intercom-rails' },
    { type: 'npm', name: '@analytics/intercom' },
  ],
});


--- src/rules/communication/linkedin.ts ---

import { register } from '../../register.js';

register({
  tech: 'linkedin',
  name: 'Linkedin',
  type: 'communication',
  dotenv: ['LINKEDIN_'],
});


--- src/rules/communication/mattermost.ts ---

import { register } from '../../register.js';

register({
  tech: 'mattermost',
  name: 'Mattermost',
  type: 'communication',
  dependencies: [
    { type: 'npm', name: 'mattermost-client' },
    { type: 'npm', name: '@mattermost/client' },
    { type: 'npm', name: 'hubot-matteruser' },
  ],
});


--- src/rules/communication/reddit.ts ---

import { register } from '../../register.js';

register({
  tech: 'reddit',
  name: 'Reddit',
  type: 'communication',
  dotenv: ['REDDIT_'],
  dependencies: [{ type: 'npm', name: 'snoowrap' }],
});


--- src/rules/communication/slack.ts ---

import { register } from '../../register.js';

register({
  tech: 'slack',
  name: 'Slack',
  type: 'communication',
  dotenv: ['SLACK_'],
  dependencies: [
    { type: 'npm', name: '@slack/web-api' },
    { type: 'terraform', name: 'registry.terraform.io/pablovarela/slack' },
    { type: 'rust', name: 'slack-morphism' },
    { type: 'ruby', name: 'slack-ruby-client' },
    { type: 'php', name: 'laravel/slack-notification-channel' },
    { type: 'githubAction', name: 'slackapi/slack-github-action' },
    { type: 'githubAction', name: '8398a7/action-slack' },
    { type: 'php', name: 'jolicode/slack-php-api' },
    { type: 'php', name: 'maknz/slack' },
    { type: 'php', name: 'alek13/slack' },
    { type: 'golang', name: 'github.com/slack-go/slack' },
    { type: 'docker', name: 'kasmweb/slack' },
    { type: 'npm', name: '@pulumi/slack' },
  ],
});


--- src/rules/communication/telegram.ts ---

import { register } from '../../register.js';

register({
  tech: 'telegram',
  name: 'Telegram',
  type: 'communication',
  dotenv: ['TELEGRAM_'],
  dependencies: [
    { type: 'docker', name: 'kasmweb/telegram' },
    {
      type: 'golang',
      name: 'github.com/go-telegram-bot-api/telegram-bot-api/v5',
    },
    { type: 'githubAction', name: 'appleboy/telegram-action' },
    { type: 'npm', name: 'telegram' },
    { type: 'npm', name: 'telegraf' },
    { type: 'npm', name: 'node-telegram-bot-api' },
    { type: 'npm', name: 'grammy' },
    { type: 'php', name: 'longman/telegram-bot' },
    { type: 'php', name: 'laravel-notification-channels/telegram' },
    { type: 'php', name: 'irazasyed/telegram-bot-sdk' },
    { type: 'php', name: 'telegram-bot/api' },
    { type: 'ruby', name: 'telegram-bot' },
    { type: 'ruby', name: 'telegram-bot-ruby' },
    { type: 'rust', name: 'teloxide' },
  ],
});


--- src/rules/communication/twitch.ts ---

import { register } from '../../register.js';

register({
  tech: 'twitch',
  name: 'Twitch',
  type: 'communication',
  dotenv: ['TWITCH_'],
  dependencies: [
    { type: 'npm', name: 'tmi.js' },
    { type: 'npm', name: 'passport-twitch-strategy' },
  ],
});


--- src/rules/communication/twitter.ts ---

import { register } from '../../register.js';

register({
  tech: 'twitter',
  name: 'X',
  type: 'communication',
  dotenv: ['TWITTER_'],
  dependencies: [
    { type: 'npm', name: 'twitter-api-v2' },
    { type: 'python', name: 'tweepy' },
    { type: 'npm', name: 'passport-twitter' },
    { type: 'terraform.resource', name: 'airbyte_source_twitter' },
  ],
});


--- src/rules/communication/whatsapp.ts ---

import { register } from '../../register.js';

register({
  tech: 'whatsapp',
  name: 'WhatsApp',
  type: 'communication',
  dotenv: ['WHATSAPP_'],
  dependencies: [
    { type: 'npm', name: 'whatsapp-web.js' },
    { type: 'npm', name: '@neoxr/wb' },
    { type: 'npm', name: 'whatsapp-business' },
  ],
});


--- src/rules/communication/wikipedia.ts ---

import { register } from '../../register.js';

register({
  tech: 'wikipedia',
  name: 'Wikipedia',
  type: 'communication',
  dotenv: ['WIKIPEDIA_'],
  dependencies: [
    { type: 'python', name: 'wikipedia' },
    { type: 'npm', name: 'wikipedia' },
  ],
});


--- src/rules/communication/youtube.ts ---

import { register } from '../../register.js';

register({
  tech: 'youtube',
  name: 'Youtube',
  type: 'communication',
  dotenv: ['YOUTUBE_'],
  dependencies: [
    { type: 'python', name: 'youtube-transcript-api' },
    { type: 'python', name: 'pytube' },
  ],
});


--- src/rules/communication/zendesk.ts ---

import { register } from '../../register.js';

register({
  tech: 'zendesk',
  name: 'Zendesk',
  type: 'communication',
  dotenv: ['ZENDESK_'],
  dependencies: [
    { type: 'npm', name: 'node-zendesk' },
    { type: 'ruby', name: 'zendesk_api' },
    { type: 'php', name: 'zendesk/zendesk_api_client_php' },
  ],
});


--- src/rules/communication/zoom.ts ---

import { register } from '../../register.js';

register({
  tech: 'zoom',
  name: 'Zoom',
  type: 'communication',
  dotenv: ['ZOOM_'],
  dependencies: [
    { type: 'npm', name: '@zoom/meetingsdk' },
    { type: 'terraform.resource', name: 'airbyte_source_zoom' },
  ],
});


--- src/rules/crm/hubspot.ts ---

import { register } from '../../register.js';

register({
  tech: 'hubspot',
  name: 'HubSpot',
  type: 'crm',
  dependencies: [
    { type: 'npm', name: /^@hubpost\//, example: '@hubspot/api-client' },
    { type: 'php', name: 'hubspot/hubspot-php' },
    { type: 'php', name: 'hubspot/api-client' },
    { type: 'npm', name: '@analytics/hubspot' },
  ],
});


--- src/rules/crm/index.ts ---

import './hubspot.js';
import './klaviyo.js';
import './salesforce.js';
import './twentycrm.js';


--- src/rules/crm/klaviyo.ts ---

import { register } from '../../register.js';

register({
  tech: 'klaviyo',
  name: 'Klaviyo',
  type: 'crm',
  dependencies: [
    { type: 'php', name: 'klaviyo/magento2-extension' },
    { type: 'terraform.resource', name: 'airbyte_source_klaviyo' },
  ],
});


--- src/rules/crm/salesforce.ts ---

import { register } from '../../register.js';

register({
  tech: 'salesforce',
  name: 'Salesforce',
  type: 'crm',
  dotenv: ['SALESFORCE_'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/hashicorp/salesforce' },
    {
      type: 'npm',
      name: /^@salesforce\//,
      example: '@salesforce/kit',
    },
    { type: 'npm', name: 'jsforce' },
  ],
});


--- src/rules/crm/twentycrm.ts ---

import { register } from '../../register.js';

register({
  tech: 'twentycrm',
  name: 'Twenty CRM',
  type: 'crm',
  dependencies: [{ type: 'docker', name: 'twentycrm/twenty' }],
});


--- src/rules/db/algolia.ts ---

import { register } from '../../register.js';

register({
  tech: 'algolia',
  name: 'Algolia',
  type: 'db',
  dotenv: ['ALGOLIA_'],
  dependencies: [
    { type: 'npm', name: /^@algolia\//, example: '@algolia/client' },
    { type: 'npm', name: 'algoliasearch' },
    { type: 'npm', name: 'instantsearch.js' },
    { type: 'npm', name: 'vue-instantsearch' },
    { type: 'npm', name: 'create-instantsearch-app' },
    { type: 'npm', name: 'react-instantsearch' },
    { type: 'npm', name: '@nuxtjs/algolia' },
    { type: 'npm', name: 'gatsby-plugin-algolia' },
    { type: 'npm', name: /^@docsearch\//, example: '@docsearch/react' },
    { type: 'npm', name: 'docsearch.js' },
    { type: 'npm', name: '@vuepress/plugin-docsearch' },
    { type: 'rust', name: 'algoliasearch' },
    { type: 'ruby', name: 'algolia' },
    { type: 'ruby', name: 'algoliasearch-rails' },
    { type: 'php', name: 'algolia/algoliasearch-client-php' },
    { type: 'php', name: 'algolia/scout-extended' },
    { type: 'githubAction', name: 'algolia/setup-algolia-cli' },
    {
      type: 'githubAction',
      name: 'algolia/algoliasearch-crawler-github-actions',
    },
    { type: 'python', name: 'algoliasearch' },
    { type: 'python', name: 'algoliasearch-django' },
    { type: 'terraform.resource', name: 'airbyte_source_algolia' },
  ],
});


--- src/rules/db/apacheCassandra.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_cassandra',
  name: 'Apache Cassandra',
  type: 'db',
  dependencies: [
    { type: 'docker', name: /cassandra/, example: 'cassandra:0.0.0' },
    { type: 'rust', name: 'discord-cassandra-cpp' },
    { type: 'rust', name: 'cassandra-cpp' },
    { type: 'npm', name: '@opentelemetry/instrumentation-cassandra-driver' },
  ],
});


--- src/rules/db/apacheCouchdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_couchdb',
  name: 'Apache CouchDB',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'apache/couchdb' },
    { type: 'php', name: 'doctrine/couchdb' },
  ],
});


--- src/rules/db/apacheHadoop.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_hadoop',
  name: 'Apache Hadoop',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'apache/hadoop' },
    { type: 'ruby', name: 'hadoop-metrics2' },
  ],
});


--- src/rules/db/apacheHive.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_hive',
  name: 'Apache Hive',
  type: 'db',
  dependencies: [{ type: 'docker', name: 'apache/hive' }],
});


--- src/rules/db/apacheIceberg.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_iceberg',
  name: 'Apache Iceberg',
  type: 'db',
  dependencies: [{ type: 'docker', name: 'apache/spark-iceberg' }],
});


--- src/rules/db/apacheSolr.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_solr',
  name: 'Apache Solr',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'solr' },
    { type: 'docker', name: 'bitnami/solr' },
  ],
});


--- src/rules/db/apacheSpark.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_spark',
  name: 'Apache Spark',
  type: 'db',
  dependencies: [{ type: 'docker', name: 'apache/spark' }],
});


--- src/rules/db/aws.athena.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.athena',
  name: 'AWS Athena',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-athena' },
    { type: 'npm', name: '@aws-sdk/client-athena' },
    { type: 'rust', name: 'aws-sdk-athena' },
    { type: 'ruby', name: 'aws-sdk-athena' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/athena' },
    {
      type: 'terraform.resource',
      name: /^aws_athena/,
      example: 'aws_athena_database',
    },
    { type: 'terraform.resource', name: 'airbyte_destination_aws_athena' },
  ],
});


--- src/rules/db/aws.cloudsearch.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.cloudsearch',
  name: 'AWS Cloudsearch',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-cloudsearch' },
    { type: 'npm', name: '@aws-sdk/client-cloudsearch' },
    { type: 'rust', name: 'aws-sdk-cloudsearch' },
    { type: 'ruby', name: 'aws-sdk-cloudsearch' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/cloudsearch',
    },
    {
      type: 'terraform.resource',
      name: /^aws_cloudsearch/,
      example: 'aws_cloudsearch_domain',
    },
  ],
});


--- src/rules/db/aws.documentdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.documentdb',
  name: 'AWS Document DB',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-docdb' },
    { type: 'npm', name: '@aws-cdk/aws-docdb' },
    { type: 'rust', name: 'aws-sdk-docdb' },
    { type: 'ruby', name: 'aws-sdk-docdb' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/docdb' },
    {
      type: 'terraform.resource',
      name: /^aws_docdb_/,
      example: 'aws_docdb_cluster',
    },
  ],
});


--- src/rules/db/aws.dynamodb.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.dynamodb',
  name: 'AWS DynamoDB',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-dynamodb' },
    {
      type: 'npm',
      name: /^@aws-sdk\/client-dynamodb/,
      example: '@aws-sdk/client-dynamodb-streams',
    },
    {
      type: 'docker',
      name: /amazon\/dynamodb-local/,
      example: 'amazon/dynamodb-local:0.0.0',
    },
    { type: 'rust', name: 'aws-sdk-dynamodb' },
    {
      type: 'ruby',
      name: /^aws-sdk-dynamodb/,
      example: 'aws-sdk-dynamodbstreams',
    },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/dynamodb',
    },
    {
      type: 'terraform.resource',
      name: /^aws_dynamodb/,
      example: 'aws_dynamodb_table',
    },
    { type: 'php', name: 'baopham/dynamodb' },
    { type: 'php', name: 'async-aws/dynamo-db' },
    { type: 'terraform.resource', name: 'airbyte_destination_dynamodb' },
  ],
});


--- src/rules/db/aws.elasticache.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.elasticache',
  name: 'AWS ElastiCache',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-elasticache' },
    { type: 'npm', name: '@aws-sdk/client-elasticache' },
    { type: 'rust', name: 'aws-sdk-elasticache' },
    { type: 'ruby', name: 'aws-sdk-elasticache' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/elasticache',
    },
    {
      type: 'terraform.resource',
      name: /^aws_elasticache/,
      example: 'aws_elasticache_cluster',
    },
    { type: 'php', name: 'atyagi/elasticache-laravel' },
  ],
});


--- src/rules/db/aws.memorydb.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.memorydb',
  name: 'AWS MemoryDB',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-memorydb' },
    { type: 'npm', name: '@aws-sdk/client-memorydb' },
    { type: 'rust', name: 'aws-sdk-memorydb' },
    { type: 'ruby', name: 'aws-sdk-memorydb' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/memorydb' },
    {
      type: 'terraform.resource',
      name: /^aws_memorydb_/,
      example: 'aws_memorydb_cluster',
    },
  ],
});


--- src/rules/db/aws.neptune.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.neptune',
  name: 'AWS Neptune',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-neptune' },
    { type: 'npm', name: '@aws-sdk/client-neptune' },
    { type: 'rust', name: 'aws-sdk-neptune' },
    { type: 'ruby', name: 'aws-sdk-neptune' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/neptune' },
    {
      type: 'terraform.resource',
      name: /^aws_neptune_/,
      example: 'aws_neptune_cluster',
    },
  ],
});


--- src/rules/db/aws.opensearch.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.opensearch',
  name: 'AWS Opensearch',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-opensearch' },
    { type: 'npm', name: '@aws-sdk/client-opensearch' },
    { type: 'rust', name: 'aws-sdk-opensearch' },
    { type: 'ruby', name: 'aws-sdk-opensearch' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/opensearch',
    },
    {
      type: 'terraform.resource',
      name: /^aws_opensearch/,
      example: 'aws_opensearch_domain',
    },
    { type: 'python', name: 'opensearch-py' },
  ],
});


--- src/rules/db/aws.rds.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.rds',
  name: 'AWS RDS',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-rds' },
    { type: 'npm', name: '@aws-sdk/client-rds' },
    { type: 'npm', name: '@aws-sdk/middleware-sdk-rds' },
    { type: 'rust', name: 'aws-sdk-rds' },
    { type: 'ruby', name: 'aws-sdk-rds' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/rds' },
    {
      type: 'terraform.resource',
      name: /^aws_rds/,
      example: 'aws_rds_cluster',
    },
    { type: 'php', name: 'async-aws/rds-data-service' },
    { type: 'terraform.resource', name: 'airbyte_destination_rds' },
  ],
});


--- src/rules/db/aws.redshift.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.redshift',
  name: 'AWS Redshift',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-redshift' },
    { type: 'npm', name: '@aws-sdk/aws-redshift' },
    { type: 'rust', name: 'aws-sdk-redshift' },
    { type: 'ruby', name: 'aws-sdk-redshift' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/redshift' },
    {
      type: 'terraform.resource',
      name: /^aws_redshift_/,
      example: 'aws_redshift_cluster',
    },
    { type: 'terraform.resource', name: 'airbyte_destination_redshift' },
  ],
});


--- src/rules/db/aws.secretsmanager.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.secretsmanager',
  name: 'AWS Secrets Manager',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-secretsmanager' },
    { type: 'npm', name: '@aws-sdk/client-secrets-manager' },
    { type: 'rust', name: 'aws-sdk-secretsmanager' },
    { type: 'ruby', name: 'aws-sdk-secretsmanager' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/secretsmanager',
    },
    {
      type: 'terraform.resource',
      name: /^aws_secretsmanager_/,
      example: 'aws_secretsmanager_secret',
    },
    { type: 'terraform.resource', name: 'airbyte_destination_secretsmanager' },
  ],
});


--- src/rules/db/aws.timestream.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.timestream',
  name: 'AWS Timestream',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-timestream' },
    { type: 'npm', name: '@aws-sdk/client-timestream' },
    { type: 'rust', name: 'aws-sdk-timestream' },
    { type: 'ruby', name: 'aws-sdk-timestream' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/timestream',
    },
    {
      type: 'terraform.resource',
      name: /^aws_timestream_/,
      example: 'aws_timestream_database',
    },
    { type: 'terraform.resource', name: 'airbyte_destination_timestream' },
  ],
});


--- src/rules/db/azure.cosmosdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.cosmosdb',
  name: 'Azure Cosmos DB',
  type: 'db',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_cosmosdb_/,
      example: 'azurerm_cosmosdb_table',
    },
    { type: 'ruby', name: 'azure_mgmt_cosmosdb' },
    { type: 'rust', name: 'azure_mgmt_cosmosdb' },
    { type: 'npm', name: '@azure/arm-cosmosdb' },
    { type: 'npm', name: '@azure/cosmos' },
    {
      type: 'golang',
      name: 'github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/cosmos/armcosmos',
    },
    { type: 'terraform.resource', name: 'airbyte_destination_cosmosdb' },
  ],
});


--- src/rules/db/azure.mariadb.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.mariadb',
  name: 'Azure MariaDB',
  type: 'db',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_mariadb_/,
      example: 'azurerm_mariadb_database',
    },
    { type: 'ruby', name: 'azure_mgmt_mariadb' },
    { type: 'rust', name: 'azure_mgmt_mariadb' },
    { type: 'npm', name: '@azure/arm-mariadb' },
    {
      type: 'golang',
      name: 'github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/mariadb/armmariadb',
    },
  ],
});


--- src/rules/db/azure.mysql.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.mysql',
  name: 'Azure MySQL',
  type: 'db',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_mysql_/,
      example: 'azurerm_mysql_database',
    },
    { type: 'ruby', name: 'azure_mgmt_mysql' },
    { type: 'rust', name: 'azure_mgmt_mysql' },
    { type: 'npm', name: '@azure/arm-mysql' },
    { type: 'githubAction', name: 'azure/mysql' },
    {
      type: 'golang',
      name: 'github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/mysql/armmysql',
    },
  ],
});


--- src/rules/db/azure.postgres.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.postgres',
  name: 'Azure Postgres',
  type: 'db',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_postgresql_/,
      example: 'azurerm_postgresql_database',
    },
    { type: 'ruby', name: 'azure_mgmt_postgresql' },
    { type: 'rust', name: 'azure_mgmt_postgresql' },
    { type: 'npm', name: '@azure/arm-postgresql' },
    { type: 'githubAction', name: 'azure/postgresql' },
    {
      type: 'golang',
      name: 'github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/postgresql/armpostgresql',
    },
  ],
});


--- src/rules/db/azure.redis.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.redis',
  name: 'Azure Redis',
  type: 'db',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_redis_/,
      example: 'azurerm_redis_cache',
    },
    { type: 'ruby', name: 'azure_mgmt_redis' },
    { type: 'rust', name: 'azure_mgmt_redis' },
    { type: 'npm', name: '@azure/arm-redis' },
    {
      type: 'golang',
      name: 'github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/redis/armredis/v2',
    },
  ],
});


--- src/rules/db/azure.sql.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.sql',
  name: 'Azure SQL',
  type: 'db',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_sql_/,
      example: 'azurerm_sql_database',
    },
    { type: 'githubAction', name: 'azure/sql-action' },
    { type: 'ruby', name: 'azure_mgmt_sql' },
    { type: 'rust', name: 'azure_mgmt_sql' },
    { type: 'npm', name: '@azure/arm-sql' },
    {
      type: 'golang',
      name: 'github.com/Azure/azure-sdk-for-go/sdk/resourcemanager/sql/armsql',
    },
  ],
});


--- src/rules/db/chromadb.ts ---

import { register } from '../../register.js';

register({
  tech: 'chromadb',
  name: 'ChromaDB',
  type: 'db',
  dependencies: [{ type: 'python', name: 'chromadb' }],
});


--- src/rules/db/clickhouse.ts ---

import { register } from '../../register.js';

register({
  tech: 'clickhouse',
  name: 'ClickHouse',
  type: 'db',
  dependencies: [
    { type: 'npm', name: /^@clickhouse\//, example: '@clickhouse/client' },
    { type: 'docker', name: 'clickhouse/clickhouse-server' },
    { type: 'golang', name: 'github.com/ClickHouse/clickhouse-go' },
    { type: 'golang', name: 'github.com/ClickHouse/clickhouse-go/v2' },
    {
      type: 'terraform',
      name: 'registry.terraform.io/ClickHouse/clickhouse',
    },
    { type: 'php', name: 'smi2/phpclickhouse' },
    { type: 'php', name: 'glushkovds/phpclickhouse-laravel' },
    { type: 'python', name: 'clickhouse-connect' },
    { type: 'rust', name: 'clickhouse' },
    { type: 'ruby', name: 'clickhouse-activerecord' },
    { type: 'terraform.resource', name: 'airbyte_destination_clickhouse' },
  ],
});


--- src/rules/db/cockroachdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'cockroachdb',
  name: 'CockroachDB',
  type: 'db',
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/cockroachdb/cockroach',
    },
    { type: 'php', name: 'nbj/cockroachdb-laravel' },
  ],
});


--- src/rules/db/convex.ts ---

import { register } from '../../register.js';

register({
  tech: 'convexdb',
  name: 'Convex',
  type: 'db',
  dotenv: ['CONVEX_'],
  dependencies: [
    { type: 'npm', name: 'convex' },
    { type: 'python', name: 'convex' },
    { type: 'rust', name: 'convex' },
    { type: 'terraform.resource', name: 'airbyte_destination_convex' },
    { type: 'terraform.resource', name: 'airbyte_source_convex' },
  ],
});


--- src/rules/db/couchbase.ts ---

import { register } from '../../register.js';

register({
  tech: 'couchbase',
  name: 'Couchbase',
  type: 'db',
  dependencies: [
    { type: 'npm', name: 'couchbase' },
    { type: 'docker', name: /couchbase/, example: 'couchbase:0.0.0' },
    { type: 'rust', name: 'couchbase' },
    { type: 'ruby', name: 'couchbase' },
    {
      type: 'terraform',
      name: 'registry.terraform.io/couchbasecloud/couchbasecapella',
    },
    { type: 'php', name: 'couchbase/couchbase' },
    { type: 'terraform.resource', name: 'airbyte_source_couchbase' },
  ],
});


--- src/rules/db/cratedb.ts ---

import { register } from '../../register.js';

register({
  tech: 'cratedb',
  name: 'CrateDB',
  type: 'db',
  dependencies: [{ type: 'docker', name: 'cratedb' }],
});


--- src/rules/db/datastax.ts ---

import { register } from '../../register.js';

register({
  tech: 'datastax',
  name: 'Datastax',
  type: 'db',
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/datastax/astra',
    },
    { type: 'terraform.resource', name: 'airbyte_destination_astra' },
    { type: 'php', name: 'datastax/php-driver' },
  ],
});


--- src/rules/db/duckdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'duckdb',
  name: 'DuckDB',
  type: 'db',
  dependencies: [
    { type: 'npm', name: 'duckdb' },
    { type: 'terraform.resource', name: 'airbyte_destination_duckdb' },
  ],
});


--- src/rules/db/elasticsearch.ts ---

import { register } from '../../register.js';

register({
  tech: 'elasticsearch',
  name: 'Elasticsearch',
  type: 'db',
  dotenv: ['ELASTICSEARCH_'],
  dependencies: [
    { type: 'npm', name: '@elastic/elasticsearch' },
    { type: 'docker', name: /elasticsearch/, example: 'elasticsearch:0.0.0' },
    {
      type: 'terraform',
      name: 'registry.terraform.io/phillbaker/elasticsearch',
    },
    { type: 'rust', name: 'elasticsearch' },
    { type: 'ruby', name: 'elasticsearch' },
    { type: 'php', name: 'elasticsearch/elasticsearch' },
    { type: 'php', name: 'ruflin/Elastica' },
    { type: 'golang', name: 'github.com/elastic/go-elasticsearch' },
    {
      type: 'githubAction',
      name: 'elastic/elastic-github-actions/elasticsearch',
    },
    { type: 'python', name: 'elasticsearch' },
    { type: 'terraform.resource', name: 'airbyte_destination_elasticsearch' },
  ],
});


--- src/rules/db/firebase.firestore.ts ---

import { register } from '../../register.js';

register({
  tech: 'firebase.firestore',
  name: 'Firebase Firestore',
  type: 'db',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^google_firestore_/,
      example: 'google_firestore_database',
    },
    { type: 'php', name: 'google/cloud-firestore' },
    { type: 'terraform.resource', name: 'airbyte_destination_firestore' },
  ],
});


--- src/rules/db/gcp.bigquery.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.bigquery',
  name: 'Cloud BigQuery',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@google-cloud/bigquery' },
    {
      type: 'terraform.resource',
      name: /^google_bigquery_/,
      example: 'google_bigquery_dataset',
    },
    { type: 'rust', name: 'gcp-bigquery-client' },
    { type: 'ruby', name: 'google-cloud-bigquery' },
    { type: 'golang', name: 'cloud.google.com/go/bigquery' },
    { type: 'php', name: 'google/cloud-bigquery' },
    { type: 'terraform.resource', name: 'airbyte_destination_bigquery' },
    { type: 'python', name: 'google-cloud-bigquery-logging' },
    { type: 'python', name: 'google-cloud-bigquery-datatransfer' },
  ],
});


--- src/rules/db/gcp.bigtable.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.bigtable',
  name: 'Cloud BigTable',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@google-cloud/bigtable' },
    {
      type: 'terraform.resource',
      name: /^google_bigtable_/,
      example: 'google_bigtable_instance',
    },
    { type: 'ruby', name: 'google-cloud-bigtable' },
    { type: 'golang', name: 'cloud.google.com/go/bigtable' },
    { type: 'php', name: 'google/cloud-bigtable' },
  ],
});


--- src/rules/db/gcp.datastore.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.datastore',
  name: 'Cloud Datastore',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@google-cloud/datastore' },
    {
      type: 'terraform.resource',
      name: /^google_datastore_/,
      example: 'google_datastore_index',
    },
    { type: 'ruby', name: 'google-cloud-datastore' },
    { type: 'golang', name: 'cloud.google.com/go/datastore' },
    { type: 'php', name: 'google/cloud-datastore' },
  ],
});


--- src/rules/db/gcp.memorystore.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.memorystore',
  name: 'Cloud Memorystore',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@google-cloud/redis' },
    {
      type: 'terraform.resource',
      name: /^google_redis_/,
      example: 'google_redis_cluster',
    },
    {
      type: 'ruby',
      name: /^google-cloud-redis/,
      example: 'google-cloud-redis-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/redis' },
    { type: 'php', name: 'google/cloud-redis' },
  ],
});


--- src/rules/db/gcp.secretmanager.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.secretmanager',
  name: 'Cloud Secret Manager',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@google-cloud/secret-manager' },
    {
      type: 'terraform.resource',
      name: /^google_secret_manager/,
      example: 'google_secret_manager_secret',
    },
    {
      type: 'ruby',
      name: /^google-cloud-secret_manager/,
      example: 'google-cloud-secret_manager-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/secretmanager' },
    { type: 'php', name: 'google/cloud-secret-manager' },
    {
      type: 'githubAction',
      name: 'google-github-actions/get-secretmanager-secrets',
    },
  ],
});


--- src/rules/db/gcp.spanner.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.spanner',
  name: 'Cloud Spanner',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@google-cloud/spanner' },
    {
      type: 'terraform.resource',
      name: /^google_spanner_/,
      example: 'google_spanner_database',
    },
    {
      type: 'ruby',
      name: /^google-cloud-spanner/,
      example: 'google-cloud-spanner-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/spanner' },
    { type: 'php', name: 'google/cloud-spanner' },
  ],
});


--- src/rules/db/gcp.sql.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.sql',
  name: 'Cloud SQL',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@google-cloud/cloud-sql-connector' },
    {
      type: 'terraform.resource',
      name: /^google_sql_/,
      example: 'google_sql_database_instance',
    },
    {
      type: 'ruby',
      name: /^google-apis-sql/,
      example: 'google-apis-sqladmin_v1beta4',
    },
    { type: 'php', name: 'google/cloud-sql-admin' },
  ],
});


--- src/rules/db/hashicorpVault.ts ---

import { register } from '../../register.js';

register({
  tech: 'hashicorp_vault',
  name: 'Vault',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@pulumi/vault' },
    { type: 'docker', name: 'vault' },
    { type: 'terraform', name: 'registry.terraform.io/hashicorp/vault' },
    { type: 'rust', name: 'hashicorp_vault' },
    { type: 'ruby', name: 'vault' },
    { type: 'php', name: 'csharpru/vault-php' },
    { type: 'githubAction', name: 'hashicorp/vault-action' },
  ],
});


--- src/rules/db/index.ts ---

import './algolia.js';
import './apacheCassandra.js';
import './apacheCouchdb.js';
import './apacheHadoop.js';
import './apacheHive.js';
import './apacheIceberg.js';
import './apacheSolr.js';
import './apacheSpark.js';
import './aws.athena.js';
import './aws.cloudsearch.js';
import './aws.documentdb.js';
import './aws.dynamodb.js';
import './aws.elasticache.js';
import './aws.memorydb.js';
import './aws.neptune.js';
import './aws.opensearch.js';
import './aws.rds.js';
import './aws.redshift.js';
import './aws.secretsmanager.js';
import './aws.timestream.js';
import './azure.cosmosdb.js';
import './azure.mariadb.js';
import './azure.mysql.js';
import './azure.postgres.js';
import './azure.redis.js';
import './azure.sql.js';
import './chromadb.js';
import './clickhouse.js';
import './cockroachdb.js';
import './convex.js';
import './couchbase.js';
import './cratedb.js';
import './datastax.js';
import './duckdb.js';
import './elasticsearch.js';
import './firebase.firestore.js';
import './gcp.bigquery.js';
import './gcp.bigtable.js';
import './gcp.datastore.js';
import './gcp.memorystore.js';
import './gcp.secretmanager.js';
import './gcp.spanner.js';
import './gcp.sql.js';
import './hashicorpVault.js';
import './influxdb.js';
import './libsql.js';
import './mariadb.js';
import './meilisearch.js';
import './meilisearchcloud.js';
import './memcached.js';
import './milvusdb.js';
import './mongodb.js';
import './mssql.js';
import './mysql.js';
import './neo4j.js';
import './neondb.js';
import './oceanbase.js';
import './ovh.database.js';
import './percona.js';
import './pinecone.js';
import './planetscale.js';
import './postgres.js';
import './qdrant.js';
import './qovery.database.js';
import './questdb.js';
import './railway.mongodb.js';
import './railway.mysql.js';
import './railway.postgres.js';
import './railway.redis.js';
import './redis.js';
import './replit.database.js';
import './replit.postgres.js';
import './rethinkdb.js';
import './scaleway.database.js';
import './scaleway.documentdb.js';
import './scaleway.redis.js';
import './scaleway.secretmanager.js';
import './snowflake.js';
import './sqlite.js';
import './supabase.postgres.js';
import './surrealdb.js';
import './swiftype.js';
import './tdengine.js';
import './tidb.js';
import './timescaledb.js';
import './tursodb.js';
import './typesense.js';
import './typesensecloud.js';
import './upstash.redis.js';
import './valkey.js';
import './vercel.blob.js';
import './vercel.kv.js';
import './vercel.postgres.js';
import './victoriametrics.js';


--- src/rules/db/influxdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'influxdb',
  name: 'InfluxDB',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@influxdata/influxdb-client' },
    { type: 'docker', name: /influxdb/, example: 'influxdb:0.0.0' },
    { type: 'rust', name: 'influxdb' },
    { type: 'rust', name: 'influxdb2' },
    { type: 'ruby', name: 'influxdb-client' },
    { type: 'php', name: 'influxdata/influxdb-client-php' },
  ],
});


--- src/rules/db/libsql.ts ---

import { register } from '../../register.js';

register({
  tech: 'libsql',
  name: 'libSQL',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@libsql/client' },
    { type: 'golang', name: 'github.com/tursodatabase/go-libsql' },
    { type: 'golang', name: 'github.com/tursodatabase/libsql-client-go/libsql' },
    { type: 'python', name: 'libsql-experimental' },
    { type: 'rust', name: 'libsql' },
    { type: 'php', name: 'turso/libsql' },
    { type: 'ruby', name: 'turso_libsql' },
    { type: 'ruby', name: 'libsql_activerecord' },
  ],
});


--- src/rules/db/mariadb.ts ---

import { register } from '../../register.js';

register({
  tech: 'mariadb',
  name: 'MariaDB',
  type: 'db',
  dependencies: [
    { type: 'npm', name: 'mariadb', example: 'mariadb' },
    { type: 'docker', name: /mariadb/, example: 'mariadb:0.0.0' },
    { type: 'ruby', name: 'tencentcloud-sdk-mariadb' },
  ],
});


--- src/rules/db/meilisearch.ts ---

import { register } from '../../register.js';

register({
  tech: 'meilisearch',
  name: 'Meilisearch',
  type: 'db',
  dotenv: ['MEILISEARCH_'],
  dependencies: [
    { type: 'npm', name: 'meilisearch' },
    { type: 'npm', name: '@meilisearch/instant-meilisearch' },
    { type: 'docker', name: 'getmeili/meilisearch' },
    { type: 'golang', name: 'github.com/meilisearch/meilisearch-go' },
    { type: 'rust', name: 'meilisearch-sdk' },
    { type: 'ruby', name: 'meilisearch' },
    { type: 'ruby', name: 'meilisearch-rails' },
    { type: 'php', name: 'meilisearch/meilisearch-php ' },
  ],
});


--- src/rules/db/meilisearchcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'meilisearchcloud',
  name: 'Meilisearch Cloud',
  type: 'db',
});


--- src/rules/db/memcached.ts ---

import { register } from '../../register.js';

register({
  tech: 'memcached',
  name: 'Memcached',
  type: 'db',
  dotenv: ['MEMCACHED_'],
  dependencies: [
    { type: 'npm', name: 'memcached' },
    { type: 'docker', name: /memcached/, example: 'memcached:0.0.0' },
    { type: 'rust', name: 'memcache-async' },
    { type: 'rust', name: 'memcache' },
    { type: 'ruby', name: 'dalli' },
    { type: 'npm', name: '@opentelemetry/instrumentation-memcached' },
  ],
});


--- src/rules/db/milvusdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'milvusdb',
  name: 'MilvusDB',
  type: 'db',
  dotenv: ['MILVUS_'],
  dependencies: [
    { type: 'docker', name: 'milvusdb/milvus' },
    { type: 'docker', name: 'milvusdb/milvus-dev' },
    { type: 'docker', name: 'bitnami/milvus' },
    { type: 'docker', name: 'bitnamicharts/milvus' },
    { type: 'npm', name: '@zilliz/milvus2-sdk-node' },
    { type: 'golang', name: 'github.com/milvus-io/milvus-sdk-go/v2' },
    { type: 'python', name: 'pymilvus' },
    { type: 'python', name: 'langchain-milvus' },
    { type: 'npm', name: 'genkitx-milvus' },
    { type: 'npm', name: '@llamaindex/milvus' },
    { type: 'terraform.resource', name: 'airbyte_destination_milvus' },
  ],
});


--- src/rules/db/mongodb.ts ---

import { register } from '../../register.js';

register({
  tech: 'mongodb',
  name: 'MongoDB',
  type: 'db',
  dotenv: ['MONGODB_'],
  dependencies: [
    { type: 'npm', name: 'mongodb' },
    { type: 'npm', name: /mongoose/, example: 'mongoose' },
    { type: 'npm', name: '@mikro-orm/mongodb', example: '@mikro-orm/mongodb' },
    { type: 'npm', name: '@opentelemetry/instrumentation-mongodb' },
    { type: 'npm', name: '@opentelemetry/instrumentation-mongoose' },
    { type: 'docker', name: 'mongo' },
    { type: 'docker', name: 'mongodb/mongodb-community-server' },
    { type: 'docker', name: 'mongodb/mongodb-enterprise-server' },
    { type: 'docker', name: 'bitnami/mongodb' },
    { type: 'docker', name: 'mongodb/atlas' },
    { type: 'docker', name: 'bitnami/mongodb-sharded' },
    { type: 'docker', name: 'rapidfort/mongodb' },
    { type: 'docker', name: 'circleci/mongo' },
    { type: 'rust', name: 'mongodb' },
    { type: 'ruby', name: 'mongo' },
    { type: 'php', name: 'mongodb/mongodb' },
    { type: 'python', name: 'pymongo' },
    { type: 'terraform.resource', name: 'airbyte_destination_mongodb' },
    { type: 'python', name: 'langchain-mongodb' },
  ],
});


--- src/rules/db/mssql.ts ---

import { register } from '../../register.js';

register({
  tech: 'mssql',
  name: 'MS SQL',
  type: 'db',
  dependencies: [
    { type: 'ruby', name: 'jdbc-mssql' },
    { type: 'npm', name: 'mssql' },
    { type: 'npm', name: '@opentelemetry/instrumentation-tedious' },
  ],
});


--- src/rules/db/mysql.ts ---

import { register } from '../../register.js';

register({
  tech: 'mysql',
  name: 'Mysql',
  type: 'db',
  dotenv: ['MYSQL_'],
  dependencies: [
    { type: 'npm', name: 'mysql' },
    { type: 'npm', name: '@mikro-orm/mysql' },
    { type: 'npm', name: 'mysql2' },
    { type: 'npm', name: '@opentelemetry/instrumentation-mysql' },
    { type: 'docker', name: /mysql/, example: 'mysql:0.0.0' },
    { type: 'rust', name: /^mysql/, example: 'mysql_async' },
    { type: 'ruby', name: 'ruby-mysql' },
    { type: 'ruby', name: 'mysql2' },
    { type: 'npm', name: '@pulumi/mysql' },
    { type: 'python', name: 'mysql-connector-python' },
    { type: 'python', name: 'PyMySQL' },
    { type: 'python', name: 'pymysql' }, // sic
    { type: 'python', name: 'mysqlclient' },
    { type: 'terraform.resource', name: 'airbyte_destination_mysql' },
  ],
});


--- src/rules/db/neo4j.ts ---

import { register } from '../../register.js';

register({
  tech: 'neo4j',
  name: 'Neo4j',
  type: 'db',
  dependencies: [
    { type: 'npm', name: 'neo4j-driver' },
    { type: 'docker', name: /neo4j/, example: 'neo4j:0.0.0' },
    { type: 'rust', name: 'neo4rs' },
    { type: 'ruby', name: 'neo4j-ruby-driver' },
  ],
});


--- src/rules/db/neondb.ts ---

import { register } from '../../register.js';

register({
  tech: 'neondb',
  name: 'NeonDB',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@neondatabase/serverless' },
    { type: 'npm', name: '@neondatabase/api-client' },
    { type: 'npm', name: '@prisma/adapter-neon' },
    { type: 'docker', name: 'neondatabase/neon' },
    { type: 'python', name: 'neon-api' },
  ],
});


--- src/rules/db/oceanbase.ts ---

import { register } from '../../register.js';

register({
  tech: 'oceanbase',
  name: 'Oceanbase',
  type: 'db',
  dependencies: [{ type: 'docker', name: 'oceanbase/oceanbase-ce' }],
});


--- src/rules/db/ovh.database.ts ---

import { register } from '../../register.js';

register({
  tech: 'ovh.database',
  name: 'OVH Database',
  type: 'db',
  dependencies: [{ type: 'terraform.resource', name: 'ovh_cloud_project_database' }],
});


--- src/rules/db/percona.ts ---

import { register } from '../../register.js';

register({
  tech: 'percona',
  name: 'Percona',
  type: 'db',
  dependencies: [{ type: 'docker', name: /percona/, example: 'percona:0.0.0' }],
});


--- src/rules/db/pinecone.ts ---

import { register } from '../../register.js';

register({
  tech: 'pinecone',
  name: 'Pinecone',
  type: 'db',
  dotenv: ['PINECONE_'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/pinecone-io/pinecone' },
    { type: 'python', name: 'pinecone' },
    { type: 'npm', name: '@pinecone-database/pinecone' },
    { type: 'golang', name: 'github.com/pinecone-io/go-pinecone/v3/pinecone' },
    { type: 'rust', name: 'pinecone-sdk' },
    { type: 'terraform.resource', name: 'airbyte_destination_pinecone' },
  ],
});


--- src/rules/db/planetscale.ts ---

import { register } from '../../register.js';

register({
  tech: 'planetscale',
  name: 'PlanetScale',
  type: 'db',
  dependencies: [{ type: 'githubAction', name: 'planetscale/create-branch-action' }],
});


--- src/rules/db/postgres.ts ---

import { register } from '../../register.js';

register({
  tech: 'postgresql',
  name: 'Postgres',
  type: 'db',
  dotenv: ['POSTGRES_'],
  dependencies: [
    { type: 'npm', name: 'pg' },
    { type: 'npm', name: 'postgres' },
    { type: 'npm', name: 'postgres-interval' },
    { type: 'npm', name: '@opentelemetry/instrumentation-pg' },
    { type: 'npm', name: '@mikro-orm/postgresql' },
    { type: 'npm', name: 'pg-connection-string' },
    { type: 'npm', name: '@pulumi/postgresql' },
    { type: 'docker', name: 'postgres' },
    { type: 'docker', name: 'bitnami/postgresql' },
    { type: 'docker', name: 'circleci/postgres' },
    { type: 'docker', name: 'cimg/postgres' },
    { type: 'docker', name: 'ubuntu/postgres' },
    { type: 'docker', name: 'bitnamicharts/postgresql' },
    { type: 'rust', name: 'postgres' },
    { type: 'ruby', name: 'pg' },
    {
      type: 'deno',
      name: /\/x\/postgres@/,
      example: 'https://deno.land/x/postgres@v0.17.0/mod.ts',
    },
    { type: 'php', name: 'martin-georgiev/postgresql-for-doctrine' },
    { type: 'terraform.resource', name: 'airbyte_destination_postgres' },
  ],
});


--- src/rules/db/qdrant.ts ---

import { register } from '../../register.js';

register({
  tech: 'qdrant',
  name: 'Qdrant',
  type: 'db',
  dotenv: ['QDRANT_'],
  dependencies: [
    { type: 'rust', name: 'qdrant-client' },
    { type: 'python', name: 'qdrant-client' },
    { type: 'docker', name: 'qdrant/qdrant' },
    { type: 'golang', name: 'github.com/qdrant/go-client' },
    { type: 'npm', name: '@qdrant/js-client-rest' },
    { type: 'npm', name: '@qdrant/drant-js' },
    { type: 'npm', name: '@qdrant/js-client-grpc' },
    { type: 'php', name: 'hkulekci/qdrant' },
    { type: 'php', name: 'qdrant-ruby' },
    { type: 'terraform.resource', name: 'airbyte_destination_qdrant' },
  ],
});


--- src/rules/db/qovery.database.ts ---

import { register } from '../../register.js';

register({
  tech: 'qovery.database',
  name: 'Qovery Database',
  type: 'db',
  dependencies: [{ type: 'terraform.resource', name: 'qovery_database' }],
});


--- src/rules/db/questdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'questdb',
  name: 'QuestDB',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'questdb/questdb' },
    { type: 'npm', name: '@questdb/nodejs-client' },
    { type: 'golang', name: 'github.com/questdb/go-questdb-client' },
    { type: 'rust', name: 'questdb-rs' },
  ],
});


--- src/rules/db/railway.mongodb.ts ---

import { register } from '../../register.js';

register({
  tech: 'railway.mongodb',
  name: 'Railway MongoDB',
  type: 'db',
});


--- src/rules/db/railway.mysql.ts ---

import { register } from '../../register.js';

register({
  tech: 'railway.mysql',
  name: 'Railway MySQL',
  type: 'db',
});


--- src/rules/db/railway.postgres.ts ---

import { register } from '../../register.js';

register({
  tech: 'railway.postgres',
  name: 'Railway Postgres',
  type: 'db',
});


--- src/rules/db/railway.redis.ts ---

import { register } from '../../register.js';

register({
  tech: 'railway.redis',
  name: 'Railway Redis',
  type: 'db',
});


--- src/rules/db/redis.ts ---

import { register } from '../../register.js';

register({
  tech: 'redis',
  name: 'Redis',
  type: 'db',
  dotenv: ['REDIS_'],
  dependencies: [
    { type: 'npm', name: 'redis' },
    { type: 'npm', name: '@opentelemetry/instrumentation-redis' },
    { type: 'npm', name: '@opentelemetry/instrumentation-redis-4' },
    { type: 'npm', name: '@opentelemetry/instrumentation-ioredis' },
    { type: 'npm', name: 'ioredis' },
    { type: 'docker', name: /redis/, example: 'redis:0.0.0' },
    { type: 'rust', name: 'redis' },
    { type: 'rust', name: 'redis-async' },
    { type: 'ruby', name: 'redis' },
    { type: 'ruby', name: 'redis-client' },
    { type: 'php', name: 'predis/predis' },
    { type: 'php', name: 'snc/redis-bundle' },
    { type: 'php', name: 'colinmollenhour/cache-backend-redis' },
    { type: 'terraform', name: 'registry.terraform.io/RedisLabs/rediscloud' },
    { type: 'terraform.resource', name: 'airbyte_destination_redis' },
  ],
});


--- src/rules/db/replit.database.ts ---

import { register } from '../../register.js';

register({
  tech: 'replit.database',
  name: 'Replit Database',
  type: 'db',
  dependencies: [{ type: 'npm', name: '@replit/database' }],
});


--- src/rules/db/replit.postgres.ts ---

import { register } from '../../register.js';

register({
  tech: 'replit.postgres',
  name: 'Replit Postgres',
  type: 'db',
  dependencies: [],
});


--- src/rules/db/rethinkdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'rethinkdb',
  name: 'RethinkDB',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'rethinkdb' },
    { type: 'npm', name: 'rethinkdb' },
    { type: 'php', name: 'danielmewes/php-rql' },
    { type: 'ruby', name: 'rethinkdb' },
    { type: 'golang', name: 'github.com/rethinkdb/rethinkdb-go' },
  ],
});


--- src/rules/db/scaleway.database.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.database',
  name: 'Scaleway Database',
  type: 'db',
  dependencies: [{ type: 'terraform.resource', name: 'scaleway_rdb_instance' }],
});


--- src/rules/db/scaleway.documentdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.documentdb',
  name: 'Scaleway DocumentDB',
  type: 'db',
  dependencies: [{ type: 'terraform.resource', name: 'scaleway_documentdb_instance' }],
});


--- src/rules/db/scaleway.redis.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.redis',
  name: 'Scaleway Redis',
  type: 'db',
  dependencies: [{ type: 'terraform.resource', name: 'scaleway_redis_cluster' }],
});


--- src/rules/db/scaleway.secretmanager.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.secretmanager',
  name: 'Scaleway Secret Manager',
  type: 'db',
  dependencies: [{ type: 'terraform.resource', name: 'scaleway_secret' }],
});


--- src/rules/db/snowflake.ts ---

import { register } from '../../register.js';

register({
  tech: 'snowflake',
  name: 'Snowflake',
  type: 'db',
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/Snowflake-Labs/snowflake',
    },
    { type: 'rust', name: 'snowflake' },
    { type: 'rust', name: 'rs-snowflake' },
    { type: 'npm', name: '@pulumi/snowflake' },
    { type: 'ruby', name: 'sequel-snowflake' },
    { type: 'terraform.resource', name: 'airbyte_destination_snowflake' },
  ],
});


--- src/rules/db/sqlite.ts ---

import { register } from '../../register.js';

register({
  tech: 'sqlite',
  name: 'SQLite',
  type: 'db',
  files: ['schema.sqlite'],
  dependencies: [
    { type: 'npm', name: 'sqlite' },
    { type: 'npm', name: 'better-sqlite3' },
    { type: 'npm', name: 'sqlite3' },
    { type: 'rust', name: 'sqlite' },
    { type: 'rust', name: 'rusqlite' },
    { type: 'rust', name: 'libsqlite3-sys' },
    { type: 'ruby', name: 'sqlite3' },
    {
      type: 'deno',
      name: /\/x\/sqlite3@/,
      example: 'https://deno.land/x/sqlite3@1.3.5/lib/shim.ts',
    },
  ],
});


--- src/rules/db/supabase.postgres.ts ---

import { register } from '../../register.js';

register({
  tech: 'supabase.postgres',
  name: 'Supabase Postgres',
  type: 'db',
  dependencies: [
    { type: 'npm', name: '@supabase/postgrest-js' },
    { type: 'npm', name: '@supabase/pg-admin-js' },
    { type: 'npm', name: '@supabase/postgres-meta' },
    { type: 'githubAction', name: 'supabase/embeddings-generator' },
    { type: 'docker', name: 'bitnami/supabase-postgres' },
    { type: 'docker', name: 'supabase/postgres' },
    { type: 'docker', name: 'supabase/postgres-meta' },
    { type: 'php', name: 'supabase/postgrest-php' },
  ],
});


--- src/rules/db/surrealdb.ts ---

import { register } from '../../register.js';

register({
  tech: 'surrealdb',
  name: 'SurrealDB',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'surrealdb/surrealdb' },
    { type: 'npm', name: 'surrealdb.js' },
  ],
});


--- src/rules/db/swiftype.ts ---

import { register } from '../../register.js';

register({
  tech: 'swiftype',
  name: 'Swiftype',
  type: 'db',
  dependencies: [
    { type: 'ruby', name: 'site-search-ruby' },
    { type: 'npm', name: '@elastic/site-search-node' },
    { type: 'python', name: 'elastic-site-search' },
    { type: 'php', name: 'elastic/site-search' },
  ],
});


--- src/rules/db/tdengine.ts ---

import { register } from '../../register.js';

register({
  tech: 'tdengine',
  name: 'TDengine',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'tdengine/tdengine' },
    { type: 'npm', name: '@tdengine/rest' },
    { type: 'npm', name: '@tdengine/client' },
    { type: 'golang', name: 'github.com/taosdata/driver-go/v3/taosSql' },
    { type: 'rust', name: 'taos' },
  ],
});


--- src/rules/db/tidb.ts ---

import { register } from '../../register.js';

register({
  tech: 'tidb',
  name: 'TiDB',
  type: 'db',
  dependencies: [{ type: 'docker', name: 'pingcap/tidb' }],
});


--- src/rules/db/timescaledb.ts ---

import { register } from '../../register.js';

register({
  tech: 'timescaledb',
  name: 'TimescaleDB',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'timescale/timescaledb-ha' },
    { type: 'docker', name: 'timescale/timescaledb' },
    { type: 'terraform', name: 'registry.terraform.io/timescale/timescale' },
  ],
});


--- src/rules/db/tursodb.ts ---

import { register } from '../../register.js';

register({
  tech: 'tursodb',
  name: 'Turso',
  type: 'db',
  dotenv: ['TURSO_'],
  dependencies: [{ type: 'npm', name: '@tursodatabase/api' }],
});


--- src/rules/db/typesense.ts ---

import { register } from '../../register.js';

register({
  tech: 'typesense',
  name: 'Typesense',
  type: 'db',
  dependencies: [
    { type: 'npm', name: 'typesense' },
    { type: 'npm', name: 'typesense-instantsearch-adapter' },
    { type: 'npm', name: 'gatsby-plugin-typesense' },
    { type: 'docker', name: 'typesense/typesense' },
    { type: 'golang', name: 'github.com/typesense/typesense-go/typesense' },
    { type: 'rust', name: 'typesense' },
    { type: 'ruby', name: 'typesense' },
    { type: 'php', name: 'typesense/typesense-php ' },
    { type: 'php', name: 'typesense/laravel-scout-typesense-driver' },
    { type: 'terraform.resource', name: 'airbyte_destination_typesense' },
  ],
});


--- src/rules/db/typesensecloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'typesensecloud',
  name: 'Typesense Cloud',
  type: 'db',
});


--- src/rules/db/upstash.redis.ts ---

import { register } from '../../register.js';

register({
  tech: 'upstash.redis',
  name: 'Upstash Redis',
  type: 'db',
  dotenv: ['UPSTASH_REDIS_'],
  dependencies: [{ type: 'npm', name: '@upstash/redis' }],
});


--- src/rules/db/valkey.ts ---

import { register } from '../../register.js';

register({
  tech: 'valkey',
  name: 'Valkey',
  type: 'db',
  dotenv: ['VALKEY_'],
  dependencies: [
    { type: 'python', name: 'valkey-glide' },
    { type: 'python', name: 'valkey' },
    { type: 'npm', name: '@valkey/valkey-glide' },
    { type: 'npm', name: 'iovalkey' },
    { type: 'golang', name: 'github.com/valkey-io/valkey-glide/go' },
    { type: 'golang', name: 'github.com/valkey-io/valkey-go' },
  ],
});


--- src/rules/db/vercel.blob.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel.blob',
  name: 'Vercel Blob',
  type: 'db',
  dependencies: [{ type: 'npm', name: '@vercel/blob' }],
});


--- src/rules/db/vercel.kv.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel.kv',
  name: 'Vercel KV',
  type: 'db',
  dependencies: [{ type: 'npm', name: '@vercel/kv' }],
});


--- src/rules/db/vercel.postgres.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel.postgres',
  name: 'Vercel Postgres',
  type: 'db',
  dependencies: [{ type: 'npm', name: '@vercel/postgres' }],
});


--- src/rules/db/victoriametrics.ts ---

import { register } from '../../register.js';

register({
  tech: 'victoriametrics',
  name: 'VictoriaMetrics',
  type: 'db',
  dependencies: [
    { type: 'docker', name: 'victoriametrics/victoria-metrics' },
    { type: 'docker', name: 'victoriametrics/vmagent' },
    { type: 'docker', name: 'victoriametrics/operator' },
    { type: 'docker', name: 'victoriametrics/vminsert' },
    { type: 'docker', name: 'victoriametrics/vmstorage' },
  ],
});


--- src/rules/etl/airbyte.ts ---

import { register } from '../../register.js';

register({
  tech: 'airbyte',
  name: 'Airbyte',
  type: 'etl',
  dependencies: [
    { type: 'docker', name: /^airbyte\//, example: 'airbyte/worker' },
    {
      type: 'terraform',
      name: 'registry.terraform.io/airbytehq/airbyte',
    },
  ],
});


--- src/rules/etl/apacheAirflow.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_airflow',
  name: 'Apache Airflow',
  type: 'etl',
  dependencies: [{ type: 'docker', name: 'apache/airflow' }],
});


--- src/rules/etl/apacheFlink.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_flink',
  name: 'Apache Flink',
  type: 'etl',
  dependencies: [{ type: 'docker', name: 'apache/flink' }],
});


--- src/rules/etl/apacheStorm.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_storm',
  name: 'Apache Storm',
  type: 'etl',
  dependencies: [{ type: 'docker', name: 'apache/storm' }],
});


--- src/rules/etl/apideck.ts ---

import { register } from '../../register.js';

register({
  tech: 'apideck',
  name: 'Apideck',
  type: 'etl',
  dependencies: [
    { type: 'npm', name: /^@apideck\//, example: '@apideck/unify' },
    { type: 'php', name: 'apideck-libraries/sdk-php' },
    { type: 'python', name: 'apideck-unify' },
    { type: 'golang', name: 'github.com/apideck-libraries/sdk-go' },
  ],
});


--- src/rules/etl/aws.glue.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.glue',
  name: 'AWS Glue',
  type: 'etl',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-glue' },
    { type: 'npm', name: '@aws-cdk/aws-glue' },
    { type: 'rust', name: 'aws-sdk-glue' },
    { type: 'ruby', name: 'aws-sdk-glue' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/glue' },
    {
      type: 'terraform.resource',
      name: /^aws_glue_/,
      example: 'aws_glue_crawler',
    },
  ],
});


--- src/rules/etl/composio.ts ---

import { register } from '../../register.js';

register({
  tech: 'composio',
  name: 'Composio',
  type: 'etl',
  dotenv: ['COMPOSIO_'],
  dependencies: [
    { type: 'npm', name: 'composio-core' },
    { type: 'npm', name: /@composio\//, example: '@composio/client' },
    { type: 'python', name: 'composio-core' },
  ],
});


--- src/rules/etl/databricks.ts ---

import { register } from '../../register.js';

register({
  tech: 'databricks',
  name: 'Databricks',
  type: 'etl',
  dotenv: ['DATABRICKS_'],
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/databricks/databricks',
    },
    { type: 'githubAction', name: 'databricks/run-notebook' },
    { type: 'terraform.resource', name: 'airbyte_destination_databricks' },
  ],
});


--- src/rules/etl/dataiku.ts ---

import { register } from '../../register.js';

register({
  tech: 'dataiku',
  name: 'Dataiku',
  type: 'etl',
  dependencies: [{ type: 'python', name: 'dataiku' }],
});


--- src/rules/etl/gcp.dataflow.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.dataflow',
  name: 'Cloud Dataflow',
  type: 'etl',
  dependencies: [
    { type: 'npm', name: '@google-cloud/dataflow' },
    {
      type: 'terraform.resource',
      name: /^google_dataflow_/,
      example: 'google_dataflow_job',
    },
    {
      type: 'ruby',
      name: /^google-cloud-dataflow/,
      example: 'google-cloud-dataflow-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/dataflow' },
    { type: 'php', name: 'google/cloud-dataflow' },
  ],
});


--- src/rules/etl/gcp.dataproc.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.dataproc',
  name: 'Cloud Dataproc',
  type: 'etl',
  dependencies: [
    { type: 'npm', name: '@google-cloud/dataproc' },
    {
      type: 'terraform.resource',
      name: /^google_dataproc_/,
      example: 'google_dataproc_job',
    },
    {
      type: 'ruby',
      name: /^google-cloud-dataproc/,
      example: 'google-cloud-dataproc-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/dataproc' },
    { type: 'php', name: 'google/cloud-dataproc' },
  ],
});


--- src/rules/etl/index.ts ---

import './airbyte.js';
import './apacheAirflow.js';
import './apacheFlink.js';
import './apacheStorm.js';
import './apideck.js';
import './aws.glue.js';
import './composio.js';
import './databricks.js';
import './dataiku.js';
import './gcp.dataflow.js';
import './gcp.dataproc.js';
import './integrationapp.js';
import './logstash.js';
import './mergedev.js';
import './nango.js';
import './trayio.js';
import './useparagon.js';


--- src/rules/etl/integrationapp.ts ---

import { register } from '../../register.js';

register({
  tech: 'integrationapp',
  name: 'Integration.app',
  type: 'etl',
  dependencies: [{ type: 'npm', name: /^@integration-app\//, example: '@integration-app/sdk' }],
});


--- src/rules/etl/logstash.ts ---

import { register } from '../../register.js';

register({
  tech: 'logstash',
  name: 'Logstash',
  type: 'etl',
  dependencies: [
    { type: 'docker', name: 'logstash' },
    { type: 'npm', name: 'bunyan-logstash-tcp' },
    { type: 'ruby', name: 'logstash-event' },
    { type: 'ruby', name: 'logstash-logger' },
    { type: 'ruby', name: 'logstash-output-sqs' },
    { type: 'ruby', name: 'logstash-filter-translate' },
    { type: 'ruby', name: 'logstash-output-stastd' },
    {
      type: 'golang',
      name: 'github.com/elastic/beats/libbeat/outputs/logstash',
    },
    { type: 'golang', name: 'github.com/bshuster-repo/logrus-logstash-hook' },
  ],
});


--- src/rules/etl/mergedev.ts ---

import { register } from '../../register.js';

register({
  tech: 'mergedev',
  name: 'Merge.dev',
  type: 'etl',
  dependencies: [
    { type: 'npm', name: /^@mergeapi\//, example: '@mergeapi/merge-node-client' },
    { type: 'python', name: 'MergePythonClient' },
    { type: 'python', name: 'MergePythonSDK' },
    { type: 'golang', name: 'github.com/merge-api/merge-go-client' },
    { type: 'ruby', name: 'merge_ruby_client' },
    // { type: 'rust', name: /^@mergeapi\//, example: '@mergeapi/merge-hris-rust' },
    { type: 'php', name: /^merge-api\//, example: 'merge-api/merge-ats-php' },
  ],
});


--- src/rules/etl/nango.ts ---

import { register } from '../../register.js';

register({
  tech: 'nango',
  name: 'Nango',
  type: 'etl',
  files: ['.nango', 'nango.yaml'],
  dotenv: ['NANGO_'],
  dependencies: [
    { type: 'npm', name: 'nango' },
    { type: 'npm', name: '@nangohq/node' },
    { type: 'npm', name: '@nangohq/frontend' },
    { type: 'docker', name: 'nangohq/nango' },
    { type: 'docker', name: 'nangohq/nango-server' },
  ],
});


--- src/rules/etl/trayio.ts ---

import { register } from '../../register.js';

register({
  tech: 'trayio',
  name: 'Tray.ai',
  type: 'etl',
  dependencies: [{ type: 'npm', name: /^@trayio-app\//, example: '@trayio/cdk-cli' }],
});


--- src/rules/etl/useparagon.ts ---

import { register } from '../../register.js';

register({
  tech: 'useparagon',
  name: 'Paragon',
  type: 'etl',
  dependencies: [{ type: 'npm', name: /^@useparagon\//, example: '@useparagon/connect' }],
});


--- src/rules/files.test.ts ---

/* eslint-disable vitest/no-conditional-expect */
import { describe, expect, it } from 'vitest';

import { analyser } from '../analyser/index.js';
import { FakeProvider } from '../provider/fake.js';
import { registeredRules } from '../register.js';

import '../autoload.js';

describe('all', () => {
  it('should not list multiple times the same files', () => {
    const files = new Set<string>();
    for (const rule of registeredRules) {
      if (!rule.files) {
        continue;
      }
      if (rule.files instanceof RegExp) {
        const str = rule.files.toString();
        if (files.has(str)) {
          expect(rule.files).toBe(false);

          continue;
        }

        files.add(str);
        continue;
      }

      for (const file of rule.files) {
        if (files.has(file)) {
          expect(file).toBe(false);

          continue;
        }

        files.add(file);
      }
    }
  });

  it('should not match case insensitive', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['oPenApi.yaml'],
        },
        files: {
          '/oPenApi.yaml': '',
        },
      }),
    });

    expect(res.toJson('').techs).toStrictEqual([]);
  });
});


--- src/rules/framework/apiplatform.ts ---

import { register } from '../../register.js';

register({
  tech: 'apiplatform',
  name: 'Api Platform',
  type: 'framework',
  dependencies: [
    { type: 'php', name: 'api-platform/core' },
    { type: 'npm', name: '@api-platform/client' },
  ],
});


--- src/rules/framework/blitzjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'blitzjs',
  name: 'Blitzjs',
  type: 'framework',
  dependencies: [{ type: 'npm', name: 'blitz' }],
});


--- src/rules/framework/dioxus.ts ---

import { register } from '../../register.js';

register({
  tech: 'dioxus',
  name: 'Dioxus',
  type: 'framework',
  dependencies: [
    { type: 'rust', name: 'dioxus' },
    { type: 'rust', name: 'dioxus-cli' },
  ],
});


--- src/rules/framework/django.ts ---

import { register } from '../../register.js';

register({
  tech: 'django',
  name: 'Django',
  type: 'framework',
  dependencies: [{ type: 'python', name: 'django' }],
});


--- src/rules/framework/index.ts ---

import './apiplatform.js';
import './blitzjs.js';
import './dioxus.js';
import './django.js';
import './laravel.js';
import './meteorjs.js';
import './nestjs.js';
import './nextjs.js';
import './nuxtjs.js';
import './rails.js';
import './redwoodjs.js';
import './remixrun.js';
import './remult.js';
import './sveltekit.js';
import './symfony.js';
import './tanstackstart.js';
import './tauri.js';
import './wasp.js';
import './yii2.js';


--- src/rules/framework/laravel.ts ---

import { register } from '../../register.js';

register({
  tech: 'laravel',
  name: 'Laravel',
  type: 'framework',
  files: ['artisan'],
  dependencies: [{ type: 'php', name: 'laravel/framework' }],
});


--- src/rules/framework/meteorjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'meteorjs',
  name: 'Meteor',
  type: 'framework',
  files: ['.meteor'],
  dependencies: [
    { type: 'npm', name: 'meteor' },
    { type: 'npm', name: 'meteor-node-stubs' },
  ],
});


--- src/rules/framework/nestjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'nestjs',
  name: 'NestJS',
  type: 'framework',
  files: ['nest-cli.json'],
  dependencies: [{ type: 'npm', name: '@nestjs/cli' }],
});


--- src/rules/framework/nextjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'nextjs',
  name: 'Next.js',
  type: 'framework',
  files: ['next.config.js', 'next.config.mjs'],
  dependencies: [
    { type: 'npm', name: 'next' },
    { type: 'npm', name: '@netlify/plugin-nextjs' },
  ],
});


--- src/rules/framework/nuxtjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'nuxtjs',
  name: 'Nuxt.js',
  type: 'framework',
  files: ['nuxt.config.js'],
  dependencies: [
    { type: 'npm', name: 'nuxt' },
    { type: 'npm', name: 'nuxt-edge' },
    { type: 'npm', name: 'nuxt3' },
  ],
});


--- src/rules/framework/rails.ts ---

import { register } from '../../register.js';

register({
  tech: 'rails',
  name: 'Rails',
  type: 'framework',
  dependencies: [
    { type: 'npm', name: /@rails\//, example: '@rails/actioncable' },
    { type: 'npm', name: 'rails' },
  ],
});


--- src/rules/framework/redwoodjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'redwoodjs',
  name: 'RedwoodJs',
  type: 'framework',
  files: ['redwood.toml'],
  dependencies: [
    { type: 'npm', name: '@vercel/redwood' },
    { type: 'npm', name: '@redwoodjs/api-server' },
    { type: 'npm', name: '@redwoodjs/telemetry' },
    { type: 'npm', name: '@redwoodjs/auth' },
    { type: 'npm', name: '@redwoodjs/api' },
    { type: 'npm', name: '@redwoodjs/core' },
    { type: 'npm', name: '@redwoodjs/web' },
    { type: 'npm', name: '@defer/redwood' },
    { type: 'npm', name: 'inngest-setup-redwoodjs' },
  ],
});


--- src/rules/framework/remixrun.ts ---

import { register } from '../../register.js';

register({
  tech: 'remixrun',
  name: 'Remix',
  type: 'framework',
  dependencies: [
    { type: 'npm', name: '@remix-run/node' },
    { type: 'npm', name: '@remix-run/serve' },
  ],
});


--- src/rules/framework/remult.ts ---

import { register } from '../../register.js';

register({
  tech: 'remult',
  name: 'Remult',
  type: 'framework',
  dependencies: [{ type: 'npm', name: 'remult' }],
});


--- src/rules/framework/sveltekit.ts ---

import { register } from '../../register.js';

register({
  tech: 'sveltekit',
  name: 'SvelteKit',
  type: 'framework',
  dependencies: [{ type: 'npm', name: '@sveltejs/kit' }],
});


--- src/rules/framework/symfony.ts ---

import { register } from '../../register.js';

register({
  tech: 'symfony',
  name: 'Symfony',
  type: 'framework',
  dependencies: [{ type: 'php', name: 'symfony/symfony' }],
});


--- src/rules/framework/tanstackstart.ts ---

import { register } from '../../register.js';

register({
  tech: 'tanstackstart',
  name: 'Tanstack Start',
  type: 'framework',
  dependencies: [{ type: 'npm', name: '@tanstack/react-start' }],
});


--- src/rules/framework/tauri.ts ---

import { register } from '../../register.js';

register({
  tech: 'tauri',
  name: 'Tauri',
  type: 'framework',
  files: ['tauri.conf.js'],
  dependencies: [
    { type: 'rust', name: 'tauri' },
    { type: 'npm', name: /^@tauri-apps\//, example: '@tauri-apps' },
  ],
});


--- src/rules/framework/wasp.ts ---

import { register } from '../../register.js';

register({
  tech: 'wasp',
  name: 'Wasp',
  type: 'framework',
  files: ['main.wasp', 'main.wasp.ts'],
});


--- src/rules/framework/yii2.ts ---

import { register } from '../../register.js';

register({
  tech: 'yii2',
  name: 'Yii2',
  type: 'framework',
  dependencies: [{ type: 'php', name: 'yiisoft/yii2' }],
});


--- src/rules/hosting.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../analyser/index.js';
import { rawList } from '../loader.js';
import { FakeProvider } from '../provider/fake.js';
import { listIndexed } from '../register.js';
import '../autoload.js';

describe('hosting', () => {
  it('should match everything with files', async () => {
    const paths: string[] = [];
    for (const item of rawList) {
      if (
        item.type !== 'file' ||
        listIndexed[item.ref.tech].type !== 'hosting' ||
        !item.ref.files
      ) {
        continue;
      }

      paths.push('example' in item.ref ? item.ref.example : item.ref.files[0]);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': paths,
        },
        files: {},
      }),
    });

    expect(res.toJson('').techs).toMatchSnapshot();
  });
});


--- src/rules/hosting/aws.amplifyhosting.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.amplifyhosting',
  name: 'AWS Amplify Hosting',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: 'aws-amplify' },
    { type: 'npm', name: /^@aws-amplify\//, example: '@aws-amplify/ui-react' },
    {
      type: 'terraform.resource',
      name: /^aws_amplify_/,
      example: 'aws_amplify_app',
    },
  ],
});


--- src/rules/hosting/aws.apigateway.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.apigateway',
  name: 'AWS Api Gateway',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-apigateway' },
    { type: 'npm', name: '@aws-sdk/client-apigateway' },
    { type: 'rust', name: 'aws-sdk-apigateway' },
    { type: 'ruby', name: 'aws-sdk-apigateway' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/apigateway' },
    {
      type: 'terraform.resource',
      name: /^aws_api_gateway_/,
      example: 'aws_api_gateway_deployment',
    },
  ],
});


--- src/rules/hosting/aws.ec2.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.ec2',
  name: 'AWS Compute',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-ec2' },
    { type: 'npm', name: '@aws-sdk/client-ec2' },
    { type: 'rust', name: 'aws-sdk-ec2' },
    { type: 'ruby', name: 'aws-sdk-ec2' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/ec2' },
    {
      type: 'terraform.resource',
      name: /^aws_ec2/,
      example: 'aws_ec2_instance_type',
    },
    {
      type: 'githubAction',
      name: 'bitovi/github-actions-deploy-docker-to-ec2',
    },
  ],
});


--- src/rules/hosting/aws.ecs.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.ecs',
  name: 'AWS Container',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-ecs' },
    { type: 'npm', name: '@aws-sdk/client-ecs' },
    { type: 'rust', name: 'aws-sdk-ecs' },
    { type: 'ruby', name: 'aws-sdk-ecs' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/ecs' },
    {
      type: 'terraform.resource',
      name: /^aws_ecs/,
      example: 'aws_ecs_cluster',
    },
  ],
});


--- src/rules/hosting/aws.eks.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.eks',
  name: 'AWS Kubernetes',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-eks' },
    { type: 'npm', name: '@aws-sdk/client-eks' },
    { type: 'npm', name: '@pulumi/eks' },
    { type: 'rust', name: 'aws-sdk-eks' },
    { type: 'ruby', name: 'aws-sdk-eks' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/eks' },
    {
      type: 'terraform.resource',
      name: /^aws_eks_/,
      example: 'aws_eks_cluster',
    },
  ],
});


--- src/rules/hosting/aws.fargate.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.fargate',
  name: 'AWS Fargate',
  type: 'hosting',
  dependencies: [{ type: 'githubAction', name: 'aws-actions/amazon-eks-fargate' }],
});


--- src/rules/hosting/aws.lambda.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.lambda',
  name: 'AWS Lambda',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: 'is-lambda' },
    { type: 'npm', name: '@aws-cdk/aws-lambda' },
    { type: 'npm', name: '@types/aws-lambda' },
    { type: 'npm', name: '@aws-sdk/client-lambda' },
    { type: 'npm', name: 'aws-lambda' },
    { type: 'npm', name: '@opentelemetry/instrumentation-aws-lambda' },
    {
      type: 'docker',
      name: /^amazon\/aws-lambda/,
      example: 'amazon/aws-lambda-python',
    },
    { type: 'rust', name: 'aws-sdk-lambda' },
    { type: 'rust', name: 'lambda_runtime' },
    { type: 'ruby', name: 'aws-sdk-lambda' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/lambda' },
    {
      type: 'terraform.resource',
      name: /^aws_lambda/,
      example: 'aws_lambda_alias',
    },
    { type: 'php', name: 'async-aws/lambda' },
    { type: 'githubAction', name: 'appleboy/lambda-action' },
  ],
});


--- src/rules/hosting/aws.lightsail.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.lightsail',
  name: 'AWS Lightsail',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-lightsail' },
    { type: 'npm', name: '@aws-sdk/client-lightsail' },
    { type: 'rust', name: 'aws-sdk-lightsail' },
    { type: 'ruby', name: 'aws-sdk-lightsail' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/lightsail' },
    {
      type: 'terraform.resource',
      name: /^aws_lightsail/,
      example: 'aws_lightsail_bucket',
    },
  ],
});


--- src/rules/hosting/azure.aks.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.aks',
  name: 'Azure Kubernetes',
  type: 'hosting',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_kubernetes_/,
      example: 'azurerm_kubernetes_cluster',
    },
  ],
});


--- src/rules/hosting/azure.functions.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.functions',
  name: 'Azure Functions',
  type: 'hosting',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_function_/,
      example: 'azurerm_function_app',
    },
    {
      type: 'terraform.resource',
      name: /^azurerm_linux_function_/,
      example: 'azurerm_linux_function_app',
    },
    {
      type: 'terraform.resource',
      name: /^azurerm_windows_function_/,
      example: 'azurerm_windows_function_app',
    },
    { type: 'npm', name: '@azure/functions' },
    { type: 'npm', name: 'durable-functions' },
    { type: 'npm', name: 'azure-functions-core-tools' },
    { type: 'ruby', name: 'fluent-plugin-azurefunctions' },
    { type: 'rust', name: 'azure-functions' },
    { type: 'rust', name: 'azure-functions-shared' },
    { type: 'githubAction', name: 'Azure/functions-container-action' },
    { type: 'githubAction', name: 'Azure/functions-action' },
  ],
});


--- src/rules/hosting/azure.staticwebapps.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.staticwebapps',
  name: 'Azure Static Web Apps',
  type: 'hosting',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_app_service/,
      example: 'azurerm_app_service',
    },
    {
      type: 'terraform.resource',
      name: /^azurerm_linux_web_app/,
      example: 'azurerm_linux_web_app',
    },
    {
      type: 'terraform.resource',
      name: /^azurerm_windows_web_app/,
      example: 'azurerm_windows_web_app',
    },
    { type: 'npm', name: '@azure/static-web-apps-cli' },
    { type: 'ruby', name: 'azure_mgmt_web' },
    { type: 'githubAction', name: 'Azure/webapps-deploy' },
    { type: 'githubAction', name: 'Azure/static-web-apps-deploy' },
    { type: 'githubAction', name: 'Azure/appservice-build' },
  ],
});


--- src/rules/hosting/cloudflare.pages.ts ---

import { register } from '../../register.js';

register({
  tech: 'cloudflare.pages',
  name: 'Cloudflare Pages',
  type: 'hosting',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^cloudflare_pages_/,
      example: 'cloudflare_pages_domain',
    },
    { type: 'githubAction', name: 'cloudflare/pages-action' },
  ],
});


--- src/rules/hosting/cloudflare.workers.ts ---

import { register } from '../../register.js';

register({
  tech: 'cloudflare.workers',
  name: 'Cloudflare Workers',
  type: 'hosting',
  files: ['wrangler.toml'],
  dependencies: [
    { type: 'npm', name: 'wrangler' },
    { type: 'npm', name: '@miniflare/cache' },
    { type: 'npm', name: 'miniflare' },
    { type: 'npm', name: '@cfworker/json-schema' },
    {
      type: 'terraform.resource',
      name: /^cloudflare_workers_/,
      example: 'cloudflare_workers_kv_namespace',
    },
    { type: 'githubAction', name: 'cloudflare/wrangler-action' },
  ],
});


--- src/rules/hosting/denodeploy.ts ---

import { register } from '../../register.js';

register({
  tech: 'denodeploy',
  name: 'Deno Deploy',
  type: 'hosting',
  dependencies: [
    { type: 'githubAction', name: 'denoland/deployctl' },
    {
      type: 'deno',
      name: /\/x\/deploy(@[0-9.]+)?\/deployctl.ts/,
      example: 'https://deno.land/x/deploy@1.4.07/deployctl.ts',
    },
  ],
});


--- src/rules/hosting/digitalocean.ts ---

import { register } from '../../register.js';

register({
  tech: 'digitalocean',
  name: 'DigitalOcean',
  type: 'hosting',
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/digitalocean/digitalocean',
    },
    { type: 'githubAction', name: 'digitalocean/app_action' },
    { type: 'githubAction', name: 'digitalocean/action-doctl' },
    { type: 'npm', name: '@pulumi/digitalocean' },
  ],
});


--- src/rules/hosting/elasticcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'elasticcloud',
  name: 'Elastic Cloud',
  type: 'hosting',
  dependencies: [{ type: 'terraform', name: 'registry.terraform.io/elastic/ec' }],
});


--- src/rules/hosting/expodev.ts ---

import { register } from '../../register.js';

register({
  tech: 'expodev',
  name: 'Expo.dev',
  type: 'hosting',
  files: ['expo.dev'],
  dependencies: [{ type: 'githubAction', name: 'expo/expo-github-action' }],
});


--- src/rules/hosting/fastly.ts ---

import { register } from '../../register.js';

register({
  tech: 'fastly',
  name: 'Fastly',
  type: 'hosting',
  dotenv: ['FASTLY_'],
  dependencies: [
    { type: 'rust', name: 'fastly-api' },
    {
      type: 'ruby',
      name: 'fastly',
    },
    { type: 'npm', name: 'fastly' },
    {
      type: 'npm',
      name: /^@fastly\//,
      example: '@fastly/performance-observer-polyfill',
    },
    { type: 'npm', name: 'fastly/fastly' },
  ],
});


--- src/rules/hosting/gcp.appengine.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.appengine',
  name: 'Google App Engine',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@google-cloud/appengine-admin' },
    {
      type: 'terraform.resource',
      name: /^google_app_engine_/,
      example: 'google_app_engine_application',
    },
    { type: 'ruby', name: 'appengine' },
    { type: 'golang', name: 'cloud.google.com/go/appengine' },
    { type: 'php', name: 'google/appengine-php-sdk' },
    {
      type: 'githubAction',
      name: 'google-github-actions/deploy-appengine',
    },
  ],
});


--- src/rules/hosting/gcp.cloudrun.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.cloudrun',
  name: 'Cloud Run',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@google-cloud/run' },
    {
      type: 'terraform.resource',
      name: /^google_cloud_run_/,
      example: 'google_cloud_run_v2_service',
    },
    {
      type: 'ruby',
      name: /^google-cloud-run-v/,
      example: 'google-cloud-run-v1',
    },
    {
      type: 'ruby',
      name: /^google-cloud-run_v/,
      example: 'google-cloud-run_v2',
    },
    { type: 'golang', name: 'cloud.google.com/go/run' },
    { type: 'php', name: 'google/cloud-run' },
    { type: 'githubAction', name: 'google-github-actions/deploy-cloudrun' },
  ],
});


--- src/rules/hosting/gcp.functions.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.functions',
  name: 'Cloud Functions',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@google-cloud/functions-framework' },
    {
      type: 'terraform.resource',
      name: /^google_cloudfunctions/,
      example: 'google_cloudfunctions_function',
    },
    {
      type: 'ruby',
      name: /^google-cloud-functions/,
      example: 'google-cloud-functions-v1',
    },
    { type: 'ruby', name: 'functions_framework ' },
    { type: 'golang', name: 'cloud.google.com/go/functions' },
    { type: 'php', name: 'google/cloud-functions-framework' },
    { type: 'php', name: 'google/cloud-functions' },
    {
      type: 'githubAction',
      name: 'google-github-actions/deploy-cloud-functions',
    },
  ],
});


--- src/rules/hosting/gcp.gce.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.gce',
  name: 'Google Compute',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@google-cloud/compute' },
    {
      type: 'terraform.resource',
      name: /^google_compute_/,
      example: 'google_compute_instance',
    },
    { type: 'ruby', name: 'google-cloud-compute' },
    { type: 'golang', name: 'cloud.google.com/go/compute' },
    { type: 'php', name: 'google/cloud-compute' },
    { type: 'githubAction', name: 'google-github-actions/ssh-compute' },
  ],
});


--- src/rules/hosting/gcp.gke.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.gke',
  name: 'Google Kubernetes',
  type: 'hosting',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^google_container_/,
      example: 'google_container_cluster',
    },
    { type: 'githubAction', name: 'google-github-actions/get-gke-credentials' },
  ],
});


--- src/rules/hosting/gcp.tasks.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.tasks',
  name: 'Cloud Tasks',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@google-cloud/tasks' },
    {
      type: 'terraform.resource',
      name: /^google_cloud_tasks_/,
      example: 'google_cloud_tasks_queue',
    },
    {
      type: 'ruby',
      name: /^google-cloud-tasks/,
      example: 'google-cloud-tasks-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/tasks' },
    { type: 'php', name: 'google/cloud-tasks' },
  ],
});


--- src/rules/hosting/github.pages.ts ---

import { register } from '../../register.js';

register({
  tech: 'github.pages',
  name: 'Github Pages',
  type: 'hosting',
  files: ['_config.yml', '_config.yaml'],
  dependencies: [
    { type: 'githubAction', name: 'actions/upload-pages-artifact' },
    { type: 'githubAction', name: 'actions/deploy-pages' },
    { type: 'githubAction', name: 'peaceiris/actions-gh-pages' },
    { type: 'githubAction', name: 'JamesIves/github-pages-deploy-action' },
  ],
});


--- src/rules/hosting/index.ts ---

import './aws.amplifyhosting.js';
import './aws.apigateway.js';
import './aws.ec2.js';
import './aws.ecs.js';
import './aws.eks.js';
import './aws.fargate.js';
import './aws.lambda.js';
import './aws.lightsail.js';
import './azure.aks.js';
import './azure.functions.js';
import './azure.staticwebapps.js';
import './cloudflare.pages.js';
import './cloudflare.workers.js';
import './denodeploy.js';
import './digitalocean.js';
import './elasticcloud.js';
import './expodev.js';
import './fastly.js';
import './gcp.appengine.js';
import './gcp.cloudrun.js';
import './gcp.functions.js';
import './gcp.gce.js';
import './gcp.gke.js';
import './gcp.tasks.js';
import './github.pages.js';
import './koyeb.js';
import './kubernetes.js';
import './mongodbatlas.js';
import './ovh.dedicated.js';
import './ovh.kubernetes.js';
import './ovh.vps.js';
import './platformsh.js';
import './qovery.cluster.js';
import './render.js';
import './replit.js';
import './scaleway.container.js';
import './scaleway.elasticmetal.js';
import './scaleway.functions.js';
import './scaleway.kubernetes.js';
import './sitecore.js';
import './supabase.functions.js';
import './tencentcloud.js';
import './vercel.edge.js';
import './vercel.functions.js';


--- src/rules/hosting/koyeb.ts ---

import { register } from '../../register.js';

register({
  tech: 'koyeb',
  name: 'Koyeb',
  type: 'hosting',
  files: ['.koyeb.yaml', 'Dockerfile.koyeb'],
  dependencies: [{ type: 'npm', name: 'koyeb-api-client' }],
});


--- src/rules/hosting/kubernetes.ts ---

import { register } from '../../register.js';

register({
  tech: 'kubernetes',
  name: 'Kubernetes',
  type: 'hosting',
  files: ['kustomization.yaml'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/hashicorp/kubernetes' },
    { type: 'rust', name: 'k8s-openapi' },
    { type: 'ruby', name: 'kubeclient' },
    { type: 'npm', name: '@kubernetes/client-node' },
    { type: 'php', name: 'kubernetes/php-client' },
    { type: 'githubAction', name: 'azure/setup-kubectl' },
    { type: 'githubAction', name: 'azure/k8s-set-context' },
    { type: 'githubAction', name: 'azure/k8s-deploy' },
    { type: 'githubAction', name: 'azure/k8s-create-secret' },
    { type: 'npm', name: '@pulumi/kubernetes' },
    { type: 'python', name: 'kubernetes' },
  ],
});


--- src/rules/hosting/mongodbatlas.ts ---

import { register } from '../../register.js';

register({
  tech: 'mongodbatlas',
  name: 'MongoDB Atlas',
  type: 'hosting',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/mongodb/mongodbatlas' },
    { type: 'npm', name: '@pulumi/mongodbatlas' },
  ],
});


--- src/rules/hosting/ovh.dedicated.ts ---

import { register } from '../../register.js';

register({
  tech: 'ovh.dedicated',
  name: 'OVH Dedicated Server',
  type: 'hosting',
  dependencies: [
    { type: 'terraform.resource', name: 'ovh_dedicated_server_install_task' },
    { type: 'terraform.resource', name: 'ovh_me_installation_template' },
    { type: 'terraform.resource', name: 'ovh_dedicated_server_update' },
  ],
});


--- src/rules/hosting/ovh.kubernetes.ts ---

import { register } from '../../register.js';

register({
  tech: 'ovh.kubernetes',
  name: 'OVH Kubernetes',
  type: 'hosting',
  dependencies: [{ type: 'terraform.resource', name: 'ovh_cloud_project_kube' }],
});


--- src/rules/hosting/ovh.vps.ts ---

import { register } from '../../register.js';

register({
  tech: 'ovh.vps',
  name: 'OVH VPS',
  type: 'hosting',
  dependencies: [{ type: 'terraform.resource', name: 'ovh_vps' }],
});


--- src/rules/hosting/platformsh.ts ---

import { register } from '../../register.js';

register({
  tech: 'platformsh',
  name: 'Platform.sh',
  type: 'hosting',
  files: ['.platform.app.yaml'],
});


--- src/rules/hosting/qovery.cluster.ts ---

import { register } from '../../register.js';

register({
  tech: 'qovery.cluster',
  name: 'Qovery Cluster',
  type: 'hosting',
  dependencies: [{ type: 'terraform.resource', name: 'qovery_cluster' }],
});


--- src/rules/hosting/render.ts ---

import { register } from '../../register.js';

register({
  tech: 'render',
  name: 'Render',
  type: 'hosting',
  files: ['render.yaml'],
});


--- src/rules/hosting/replit.ts ---

import { register } from '../../register.js';

register({
  tech: 'replit',
  name: 'Replit',
  type: 'hosting',
  files: ['.replit', 'replit.nix'],
  dependencies: [{ type: 'npm', name: /@replit\//, example: '@replit/connectors' }],
});


--- src/rules/hosting/scaleway.container.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.container',
  name: 'Scaleway Container',
  type: 'hosting',
  dependencies: [
    { type: 'terraform.resource', name: 'scaleway_container' },
    { type: 'terraform.resource', name: 'scaleway_container_cron' },
  ],
});


--- src/rules/hosting/scaleway.elasticmetal.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.elasticmetal',
  name: 'Scaleway Elastic Metal',
  type: 'hosting',
  dependencies: [{ type: 'terraform.resource', name: 'scaleway_baremetal_server' }],
});


--- src/rules/hosting/scaleway.functions.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.function',
  name: 'Scaleway Function',
  type: 'hosting',
  dependencies: [
    { type: 'terraform.resource', name: 'scaleway_function' },
    { type: 'terraform.resource', name: 'scaleway_function_cron' },
  ],
});


--- src/rules/hosting/scaleway.kubernetes.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.kubernetes',
  name: 'Scaleway Kubernetes',
  type: 'hosting',
  dependencies: [{ type: 'terraform.resource', name: 'scaleway_k8s_cluster' }],
});


--- src/rules/hosting/sitecore.ts ---

import { register } from '../../register.js';

register({
  tech: 'sitecore',
  name: 'Sitecore',
  type: 'hosting',
  dependencies: [{ type: 'npm', name: '@sitecore-jss/sitecore-jss' }],
});


--- src/rules/hosting/supabase.functions.ts ---

import { register } from '../../register.js';

register({
  tech: 'supabase.functions',
  name: 'Supabase Functions',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@supabase/functions-js' },
    { type: 'npm', name: 'supabase/functions-php' },
  ],
});


--- src/rules/hosting/tencentcloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'tencentcloud',
  name: 'Tencent Cloud',
  type: 'hosting',
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/tencentcloudstack/tencentcloud',
    },
    { type: 'php', name: 'encentcloud/tencentcloud-sdk-php' },
    { type: 'python', name: 'tencentcloud-sdk-python' },
  ],
});


--- src/rules/hosting/vercel.edge.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel.edge',
  name: 'Vercel Edge',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@vercel/edge' },
    { type: 'npm', name: '@vercel/edge-config' },
    { type: 'npm', name: '@vercel/edge-functions-ui' },
    { type: 'npm', name: '@edge-runtime/primitives' },
  ],
});


--- src/rules/hosting/vercel.functions.ts ---

import { register } from '../../register.js';

register({
  tech: 'vercel.functions',
  name: 'Vercel Functions',
  type: 'hosting',
  dependencies: [
    { type: 'npm', name: '@vercel/functions' },
    { type: 'npm', name: '@vercel/og' },
  ],
});


--- src/rules/iac/ansible.ts ---

import { register } from '../../register.js';

register({
  tech: 'ansible',
  name: 'Ansible',
  type: 'iac',
  dependencies: [
    { type: 'githubAction', name: 'ansible/ansible-lint' },
    { type: 'githubAction', name: 'ansible-community/ansible-test-gh-action' },
    { type: 'docker', name: 'pipelinecomponents/ansible-lint' },
    { type: 'docker', name: 'alpinelinux/ansible' },
  ],
});


--- src/rules/iac/aws.cloudformation.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.cloudformation',
  name: 'AWS CloudFormation',
  type: 'iac',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-cloudformation' },
    { type: 'npm', name: '@aws-cdk/aws-cloudformation' },
    { type: 'rust', name: 'aws-sdk-cloudformation' },
    { type: 'ruby', name: 'aws-sdk-cloudformation' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/cloudformation',
    },
    {
      type: 'terraform.resource',
      name: /^aws_cloudformation_/,
      example: 'aws_cloudformation_stack',
    },
    {
      type: 'githubAction',
      name: 'aws-actions/aws-cloudformation-github-deploy',
    },
  ],
});


--- src/rules/iac/chef.ts ---

import { register } from '../../register.js';

register({
  tech: 'chef',
  name: 'Chef',
  type: 'iac',
  dependencies: [{ type: 'docker', name: 'chef/chef' }],
});


--- src/rules/iac/helm.ts ---

import { register } from '../../register.js';

register({
  tech: 'helm',
  name: 'Helm',
  type: 'iac',
  files: ['Chart.yaml'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/hashicorp/helm' },
    { type: 'ruby', name: 'helm-rb' },
    { type: 'githubAction', name: 'azure/setup-helm' },
  ],
});


--- src/rules/iac/index.ts ---

import './ansible.js';
import './aws.cloudformation.js';
import './chef.js';
import './helm.js';
import './pulumi.js';
import './terragrunt.js';


--- src/rules/iac/pulumi.ts ---

import { register } from '../../register.js';

register({
  tech: 'pulumi',
  name: 'Pulumi',
  type: 'iac',
  files: ['Pulumi.yaml'],
  dependencies: [
    { type: 'npm', name: '@pulumi/pulumi' },
    { type: 'python', name: 'pulumi' },
    { type: 'golang', name: 'github.com/pulumi/pulumi/sdk/v3' },
  ],
});


--- src/rules/iac/terragrunt.ts ---

import { register } from '../../register.js';

register({
  tech: 'terragrunt',
  name: 'Terragrunt',
  type: 'iac',
  files: ['terragrunt.hcl', 'terragrunt.hcl.json'],
});


--- src/rules/iconset/antdicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'antdicons',
  name: 'Ant Design Icons',
  type: 'iconset',
  dependencies: [{ type: 'npm', name: '@ant-design/icons' }],
});


--- src/rules/iconset/bootstrapicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'bootstrapicons',
  name: 'Bootstrap Icons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: 'bootstrap-icons' },
    { type: 'npm', name: 'react-bootstrap-icons' },
    { type: 'npm', name: '@iconify-json/bi' },
    { type: 'npm', name: 'svelte-bootstrap-icons' },
  ],
});


--- src/rules/iconset/feathericons.ts ---

import { register } from '../../register.js';

register({
  tech: 'feathericons',
  name: 'Feather Icons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: 'feather-icons' },
    { type: 'npm', name: 'react-feather' },
    { type: 'npm', name: 'react-native-feather' },
  ],
});


--- src/rules/iconset/fontawesome.ts ---

import { register } from '../../register.js';

register({
  tech: 'fontawesome',
  name: 'Font Awesome',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: '@fortawesome/react-fontawesome' },
    { type: 'npm', name: '@fortawesome/vue-fontawesome' },
    { type: 'npm', name: '@iconify-json/fa6-brands' },
    { type: 'npm', name: '@iconify-json/fa6-regular' },
    { type: 'npm', name: '@iconify-json/fa6-solid' },
    { type: 'npm', name: '@iconify-json/fa' },
  ],
});


--- src/rules/iconset/heroicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'heroicons',
  name: 'Heroicons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: '@heroicons/react' },
    { type: 'npm', name: '@heroicons/vue' },
    { type: 'npm', name: '@iconify-json/heroicons' },
  ],
});


--- src/rules/iconset/hugeicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'hugeicons',
  name: 'HugeIcons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: '@hugeicons/react' },
    { type: 'npm', name: '@hugeicons/vue' },
    { type: 'npm', name: '@hugeicons/svelte' },
    { type: 'npm', name: '@hugeicons/angular' },
    { type: 'npm', name: '@hugeicons/react-native' },
    { type: 'npm', name: '@hugeicons/core-free-icons' },
    { type: 'npm', name: '@iconify-json/hugeicons' },
  ],
});


--- src/rules/iconset/index.ts ---

import './antdicons.js';
import './bootstrapicons.js';
import './feathericons.js';
import './fontawesome.js';
import './heroicons.js';
import './hugeicons.js';
import './ionicons.js';
import './lordicon.js';
import './lucideicons.js';
import './materialdesignicons.js';
import './muiicons.js';
import './phosphoreicons.js';
import './radixicons.js';
import './reacticons.js';
import './remixicons.js';
import './simpleicons.js';
import './tablericons.js';


--- src/rules/iconset/ionicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'ionicons',
  name: 'Ionicons',
  type: 'iconset',
  dependencies: [{ type: 'npm', name: 'ionicosn' }],
});


--- src/rules/iconset/lordicon.ts ---

import { register } from '../../register.js';

register({
  tech: 'lordicon',
  name: 'Lord Icon',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: '@lordicon/element' },
    { type: 'npm', name: '@lordicon/react' },
    { type: 'npm', name: '@lordicon/web' },
  ],
});


--- src/rules/iconset/lucideicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'lucideicons',
  name: 'Lucide Icons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: 'lucide-react' },
    { type: 'npm', name: 'lucide-svelte' },
    { type: 'npm', name: 'lucide-vue-next' },
    { type: 'npm', name: 'lucide-react-native' },
    { type: 'npm', name: '@iconify-json/lucide' },
    { type: 'npm', name: '@lucide/svelte' },
    { type: 'npm', name: 'lucide-angular' },
  ],
});


--- src/rules/iconset/materialdesignicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'materialdesignicons',
  name: 'Material Design Icons',
  type: 'iconset',
  dependencies: [{ type: 'npm', name: '@iconify-json/mdi' }],
});


--- src/rules/iconset/muiicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'muiicons',
  name: 'MUI Icons',
  type: 'iconset',
  dependencies: [{ type: 'npm', name: '@mui/icons-material' }],
});


--- src/rules/iconset/phosphoreicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'phosphoreicons',
  name: 'Phosphor Icons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: '@phosphor-icons/react' },
    { type: 'npm', name: '@phosphor-icons/vue' },
    { type: 'npm', name: '@phosphor-icons/webcomponents' },
    { type: 'npm', name: '@phosphor-icons/web' },
    { type: 'npm', name: '@iconify-json/ph' },
  ],
});


--- src/rules/iconset/radixicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'radixicons',
  name: 'Radix Icons',
  type: 'iconset',
  dependencies: [{ type: 'npm', name: '@radix-ui/react-icons' }],
});


--- src/rules/iconset/reacticons.ts ---

import { register } from '../../register.js';

register({
  tech: 'reacticons',
  name: 'React Icons',
  type: 'iconset',
  dependencies: [{ type: 'npm', name: 'react-icons' }],
});


--- src/rules/iconset/remixicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'remixicons',
  name: 'Remix Icons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: 'remixicon' },
    { type: 'npm', name: '@remixicon/react' },
    { type: 'npm', name: '@remixicon/vue' },
    { type: 'npm', name: '@iconify-json/ri' },
  ],
});


--- src/rules/iconset/simpleicons.ts ---

import { register } from '../../register.js';

register({
  tech: 'simpleicons',
  name: 'Simple Icons',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: '@icons-pack/react-simple-icons' },
    { type: 'npm', name: 'simple-icons' },
    { type: 'npm', name: '@iconify/json/simple-icons' },
  ],
});


--- src/rules/iconset/tablericons.ts ---

import { register } from '../../register.js';

register({
  tech: 'tablericons',
  name: 'Tabler',
  type: 'iconset',
  dependencies: [
    { type: 'npm', name: '@tabler/icons-react' },
    { type: 'npm', name: '@tabler/icons' },
    { type: 'npm', name: '@tabler/icons-vue' },
    { type: 'npm', name: '@steeze-ui/tabler-icons' },
    { type: 'npm', name: '@iconify-json/tabler' },
  ],
});


--- src/rules/index.ts ---

import './ai/index.js';
import './analytics/index.js';
import './auth/index.js';
import './app/index.js';
import './automation/index.js';
import './builder/index.js';
import './ci/index.js';
import './cms/index.js';
import './collaboration/index.js';
import './communication/index.js';
import './cloud/index.js';
import './crm/index.js';
import './db/index.js';
import './etl/index.js';
import './framework/index.js';
import './hosting/index.js';
import './iac/index.js';
import './iconset/index.js';
import './language/index.js';
import './linter/index.js';
import './maps/index.js';
import './monitoring/index.js';
import './notification/index.js';
import './network/index.js';
import './payment/index.js';
import './package_manager/index.js';
import './orm/index.js';
import './queue/index.js';
import './runtime/index.js';
import './saas/index.js';
import './security/index.js';
import './spec/index.js';
import './ssg/index.js';
import './storage/index.js';
import './test/index.js';
import './tool/index.js';
import './ui/index.js';
import './ui_framework/index.js';
import './validation/index.js';


--- src/rules/language/ada.ts ---

import { register } from '../../register.js';

register({
  tech: 'ada',
  name: 'Ada',
  type: 'language',
  extensions: ['.ada', '.adb', '.ads'],
});


--- src/rules/language/aspnet.ts ---

import { register } from '../../register.js';

register({
  tech: 'aspnet',
  name: 'ASP.NET',
  type: 'language',
  extensions: ['.asax', '.ascx', '.ashx', '.asmx', '.aspx', '.axd'],
});


--- src/rules/language/bash.ts ---

import { register } from '../../register.js';

register({
  tech: 'bash',
  name: 'Bash',
  type: 'language',
  extensions: ['.sh'],
});


--- src/rules/language/c.ts ---

import { register } from '../../register.js';

register({
  tech: 'c',
  name: 'C',
  type: 'language',
  extensions: ['.c', '.h', '.idc'],
});


--- src/rules/language/clojure.ts ---

import { register } from '../../register.js';

register({
  tech: 'clojure',
  name: 'Clojure',
  type: 'language',
  extensions: ['.clj'],
});


--- src/rules/language/cobol.ts ---

import { register } from '../../register.js';

register({
  tech: 'cobol',
  name: 'COBOL',
  type: 'language',
  extensions: ['.cob', '.cbl', '.ccp', '.cobol', '.cpy'],
});


--- src/rules/language/coffeescript.ts ---

import { register } from '../../register.js';

register({
  tech: 'coffeescript',
  name: 'CoffeeScript',
  type: 'language',
  extensions: ['.coffee', '._coffee', '.cake', '.cjsx', '.iced'],
});


--- src/rules/language/cplusplus.ts ---

import { register } from '../../register.js';

register({
  tech: 'cplusplus',
  name: 'C++',
  type: 'language',
  extensions: ['.cpp', '.c++', '.cc', '.cp', '.cppm', '.h++', '.hh', '.hpp'],
});


--- src/rules/language/csharp.ts ---

import { register } from '../../register.js';

register({
  tech: 'csharp',
  name: 'C#',
  type: 'language',
  extensions: ['.cs', '.cake', '.csx', '.linq'],
});


--- src/rules/language/css.ts ---

import { register } from '../../register.js';

register({
  tech: 'css',
  name: 'CSS',
  type: 'language',
  extensions: ['.css'],
});


--- src/rules/language/dart.ts ---

import { register } from '../../register.js';

register({
  tech: 'dart',
  name: 'Dart',
  type: 'language',
  extensions: ['.dart'],
});


--- src/rules/language/elixir.ts ---

import { register } from '../../register.js';

register({
  tech: 'elixir',
  name: 'Elixir',
  type: 'language',
  extensions: ['.ex', '.exs'],
});


--- src/rules/language/glsl.ts ---

import { register } from '../../register.js';

register({
  tech: 'glsl',
  name: 'GLSL',
  type: 'language',
  extensions: ['.glsl'],
});


--- src/rules/language/haskell.ts ---

import { register } from '../../register.js';

register({
  tech: 'haskell',
  name: 'Haskell',
  type: 'language',
  extensions: ['.hs'],
});


--- src/rules/language/index.ts ---

import './ada.js';
import './aspnet.js';
import './bash.js';
import './c.js';
import './clojure.js';
import './cobol.js';
import './coffeescript.js';
import './cplusplus.js';
import './csharp.js';
import './css.js';
import './dart.js';
import './elixir.js';
import './glsl.js';
import './haskell.js';
import './java.js';
import './javascript.js';
import './jsx.js';
import './kotlin.js';
import './lua.js';
import './matlab.js';
import './objectivec.js';
import './perl.js';
import './r.js';
import './scala.js';
import './scss.js';
import './swift.js';
import './typescript.js';
import './visualbasicnet.js';
import './vue.js';


--- src/rules/language/java.ts ---

import { register } from '../../register.js';

register({
  tech: 'java',
  name: 'Java',
  type: 'language',
  extensions: ['.java', '.jav', '.jsh'],
});


--- src/rules/language/javascript.ts ---

import { register } from '../../register.js';

register({
  tech: 'javascript',
  name: 'JavaScript',
  type: 'language',
  extensions: ['.js', '.mjs', '.cjs'],
});


--- src/rules/language/jsx.ts ---

import { register } from '../../register.js';

register({
  tech: 'jsx',
  name: 'JSX',
  type: 'language',
  extensions: ['.jsx', '.tsx'],
});


--- src/rules/language/kotlin.ts ---

import { register } from '../../register.js';

register({
  tech: 'kotlin',
  name: 'Kotlin',
  type: 'language',
  extensions: ['.kt', '.ktm', '.kts'],
});


--- src/rules/language/lua.ts ---

import { register } from '../../register.js';

register({
  tech: 'lua',
  name: 'Lua',
  type: 'language',
  extensions: ['.lua'],
});


--- src/rules/language/matlab.ts ---

import { register } from '../../register.js';

register({
  tech: 'matlab',
  name: 'MATLAB',
  type: 'language',
  extensions: ['.matlab', '.m'],
});


--- src/rules/language/objectivec.ts ---

import { register } from '../../register.js';

register({
  tech: 'objectivec',
  name: 'Objective-C',
  type: 'language',
  extensions: ['.m', '.mm', '.h'],
});


--- src/rules/language/perl.ts ---

import { register } from '../../register.js';

register({
  tech: 'perl',
  name: 'Perl',
  type: 'language',
  extensions: ['.pl', '.al', '.cgi', '.fcgi', '.perl', '.ph', '.plx', '.pm', '.psgi', '.t'],
});


--- src/rules/language/r.ts ---

import { register } from '../../register.js';

register({
  tech: 'r',
  name: 'R',
  type: 'language',
  extensions: ['.r', '.rd', '.rsx'],
});


--- src/rules/language/scala.ts ---

import { register } from '../../register.js';

register({
  tech: 'scala',
  name: 'Scala',
  type: 'language',
  extensions: ['.scala'],
});


--- src/rules/language/scss.ts ---

import { register } from '../../register.js';

register({
  tech: 'scss',
  name: 'SCSS',
  type: 'language',
  extensions: ['.scss'],
});


--- src/rules/language/swift.ts ---

import { register } from '../../register.js';

register({
  tech: 'swift',
  name: 'Swift',
  type: 'language',
  extensions: ['.swift'],
});


--- src/rules/language/typescript.ts ---

import { register } from '../../register.js';

register({
  tech: 'typescript',
  name: 'Typescript',
  type: 'language',
  files: /tsconfig(.[a-zA-Z0-9_-]+)?.json/,
  example: 'tsconfig.json',
  extensions: ['.ts', '.tsx'],
  dependencies: [{ type: 'npm', name: 'typescript' }],
});


--- src/rules/language/visualbasicnet.ts ---

import { register } from '../../register.js';

register({
  tech: 'visualbasicnet',
  name: 'Visual Basic .NET',
  type: 'language',
  extensions: ['.vb', '.vbhtml'],
});


--- src/rules/language/vue.ts ---

import { register } from '../../register.js';

register({
  tech: 'vuejs',
  name: 'Vue',
  type: 'language',
  extensions: ['.vue'],
});


--- src/rules/linter/biomejs.ts ---

import { register } from '../../register.js';

register({
  tech: 'biomejs',
  name: 'Biome JS',
  type: 'linter',
  files: ['biome.json', 'biome.jsonc'],
  dependencies: [{ type: 'npm', name: '@biomejs/biome' }],
});


--- src/rules/linter/eslint.ts ---

import { register } from '../../register.js';

register({
  tech: 'eslint',
  name: 'Eslint',
  type: 'linter',
  files: [
    '.eslintrc',
    '.eslintrc.cjs',
    '.eslintrc.json',
    '.eslintrc.js',
    'eslint.config.js',
    'eslint.config.cjs',
    'eslint.config.mjs',
  ],
  dependencies: [{ type: 'npm', name: 'eslint' }],
});


--- src/rules/linter/golangcilint.ts ---

import { register } from '../../register.js';

register({
  tech: 'golangcilint',
  name: 'GolangCI Lint',
  type: 'linter',
  files: ['.golangcit.yml'],
  dependencies: [
    { type: 'golang', name: 'github.com/golangci/golangci-lint' },
    { type: 'githubAction', name: 'golangci/golangci-lint-action' },
    { type: 'docker', name: 'golangci/golangci-lint' },
  ],
});


--- src/rules/linter/index.ts ---

import './biomejs.js';
import './eslint.js';
import './golangcilint.js';
import './oxlint.js';
import './phpstan.js';
import './prettier.js';
import './rubocop.js';
import './sonarlint.js';
import './stylelint.js';
import './ultracite.js';
import './vale.js';


--- src/rules/linter/oxlint.ts ---

import { register } from '../../register.js';

register({
  tech: 'oxlint',
  name: 'OxLint',
  type: 'linter',
  files: ['.oxlintrc.json'],
  dependencies: [{ type: 'npm', name: 'oxlint' }],
});


--- src/rules/linter/phpstan.ts ---

import { register } from '../../register.js';

register({
  tech: 'phpstan',
  name: 'PHPStan',
  type: 'linter',
  files: ['phpstan.neon'],
  dependencies: [{ type: 'php', name: 'phpstan/phpstan' }],
});


--- src/rules/linter/prettier.ts ---

import { register } from '../../register.js';

register({
  tech: 'prettier',
  name: 'Prettier',
  type: 'linter',
  files: ['.prettierrc', '.prettierignore'],
  dependencies: [{ type: 'npm', name: 'prettier' }],
});


--- src/rules/linter/rubocop.ts ---

import { register } from '../../register.js';

register({
  tech: 'rubocop',
  name: 'Rubocop',
  type: 'linter',
  files: ['.rubocop.yml'],
});


--- src/rules/linter/sonarlint.ts ---

import { register } from '../../register.js';

register({
  tech: 'sonarlint',
  name: 'SonarLint',
  type: 'linter',
  files: ['.sonarlint'],
  dependencies: [],
});


--- src/rules/linter/stylelint.ts ---

import { register } from '../../register.js';

register({
  tech: 'stylelint',
  name: 'Stylelint',
  type: 'linter',
  files: ['.stylelint', '.stylelintrc.cjs', '.stylelintrc.json', '.stylelintrc.js'],
});


--- src/rules/linter/ultracite.ts ---

import { register } from '../../register.js';

register({
  tech: 'ultracite',
  name: 'Ultracite',
  type: 'linter',
  dependencies: [{ type: 'npm', name: 'ultracite' }],
});


--- src/rules/linter/vale.ts ---

import { register } from '../../register.js';

register({
  tech: 'vale',
  name: 'Vale',
  type: 'linter',
  files: ['.vale.ini'],
  dependencies: [
    { type: 'docker', name: 'jdkato/vale' },
    { type: 'githubAction', name: 'errata-ai/vale-action' },
  ],
});


--- src/rules/maps/apple.maps.ts ---

import { register } from '../../register.js';

register({
  tech: 'apple.maps',
  name: 'Apple Maps',
  type: 'maps',
});


--- src/rules/maps/azure.maps.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.maps',
  name: 'Bing Maps',
  type: 'maps',
  dotenv: ['AZURE_MAPS_'],
  dependencies: [
    { type: 'npm', name: '@azure/maps-control' },
    { type: 'npm', name: 'bingmaps' },
    { type: 'npm', name: 'azure-maps-control' },
    { type: 'npm', name: '@azure-rest/maps-search' },
    { type: 'terraform.resource', name: 'azurerm_maps_account' },
  ],
});


--- src/rules/maps/gcp.maps.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.maps',
  name: 'Google Maps',
  type: 'maps',
  dotenv: ['GOOGLE_MAPS_'],
  dependencies: [
    { type: 'npm', name: '@google-cloud/maps' },
    { type: 'npm', name: /^@googlemaps\//, example: '@googlemaps/places' },
    { type: 'ruby', name: 'google_maps_service' },
    { type: 'golang', name: 'cloud.google.com/go/maps' },
    { type: 'python', name: 'google-maps-mapsplatformdatasets' },
  ],
});


--- src/rules/maps/heremaps.ts ---

import { register } from '../../register.js';

register({
  tech: 'heremaps',
  name: 'HERE Maps',
  type: 'maps',
  dotenv: ['HERE_MAPS_'],
  dependencies: [{ type: 'npm', name: '@types/heremaps' }],
});


--- src/rules/maps/index.ts ---

import './apple.maps.js';
import './azure.maps.js';
import './gcp.maps.js';
import './heremaps.js';
import './mapbox.js';


--- src/rules/maps/mapbox.ts ---

import { register } from '../../register.js';

register({
  tech: 'mapbox',
  name: 'Mapbox',
  type: 'maps',
  dotenv: ['MAPBOX_'],
  dependencies: [
    { type: 'npm', name: 'mapbox-gl' },
    { type: 'npm', name: '@mapbox/mapbox-sdk' },
    { type: 'npm', name: '@mapbox/mapbox-gl-geocoder' },
    { type: 'rust', name: 'mapboxgl' },
    { type: 'ruby', name: 'mapbox-sdk' },
    { type: 'ruby', name: 'mapbox-rails' },
    { type: 'ruby', name: 'mapbox-gl-rails' },
    { type: 'python', name: 'mapbox-tilesets' },
    { type: 'php', name: 'geocoder-php/mapbox-provider' },
  ],
});


--- src/rules/monitoring/appsignal.ts ---

import { register } from '../../register.js';

register({
  tech: 'appsignal',
  name: 'AppSignal',
  type: 'monitoring',
  dependencies: [
    { type: 'npm', name: 'appsignal' },
    { type: 'ruby', name: 'appsignal' },
    { type: 'python', name: 'appsignal' },
    { type: 'npm', name: '@appsignal/nodejs' },
    { type: 'npm', name: '@appsignal/javascript' },
    { type: 'npm', name: '@appsignal/react' },
    { type: 'npm', name: '@appsignal/angular' },
    { type: 'npm', name: '@appsignal/vue' },
    { type: 'npm', name: '@appsignal/ember' },
    { type: 'docker', name: 'appsignal/collector' },
  ],
});


--- src/rules/monitoring/aws.cloudwatch.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.cloudwatch',
  name: 'AWS Cloudwatch',
  type: 'monitoring',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-cloudwatch' },
    { type: 'npm', name: '@aws-sdk/client-cloudwatch' },
    { type: 'rust', name: 'aws-sdk-cloudwatch' },
    { type: 'ruby', name: 'aws-sdk-cloudwatch' },
    {
      type: 'golang',
      name: 'github.com/aws/aws-sdk-go-v2/service/cloudwatch',
    },
    {
      type: 'terraform.resource',
      name: /^aws_cloudwatch_/,
      example: 'aws_cloudwatch_dashboard',
    },
  ],
});


--- src/rules/monitoring/betterstack.ts ---

import { register } from '../../register.js';

register({
  tech: 'betterstack',
  name: 'Better Stack',
  type: 'monitoring',
  dotenv: ['LOGTAIL_', 'BETTERSTACK_'],
  dependencies: [
    { type: 'npm', name: '@logtail/node' },
    { type: 'ruby', name: 'logtail-rails' },
    { type: 'php', name: 'logtail/monolog-logtail' },
    { type: 'terraform', name: 'registry.terraform.io/BetterStackHQ/better-uptime' },
    { type: 'terraform', name: 'registry.terraform.io/BetterStackHQ/logtail' },
  ],
});


--- src/rules/monitoring/blackfire.ts ---

import { register } from '../../register.js';

register({
  tech: 'blackfire',
  name: 'Blackfire',
  type: 'monitoring',
  dotenv: ['BLACKFIRE_'],
  dependencies: [
    { type: 'php', name: 'blackfire/php-sdk' },
    { type: 'docker', name: 'blackfire/blackfire' },
  ],
});


--- src/rules/monitoring/bugsnag.ts ---

import { register } from '../../register.js';

register({
  tech: 'bugsnag',
  name: 'Bugsnag',
  type: 'monitoring',
  dotenv: ['BUGSNAG_'],
  dependencies: [
    { type: 'npm', name: '@bugsnag/js' },
    { type: 'npm', name: '@bugsnag/node' },
    { type: 'npm', name: '@bugsnag/react-native' },
    { type: 'python', name: 'bugsnag' },
    { type: 'php', name: 'bugsnag/bugsnag' },
    { type: 'php', name: 'bugsnag/bugsnag-laravel' },
    { type: 'ruby', name: 'bugsnag' },
    { type: 'golang', name: 'github.com/bugsnag/bugsnag-go' },
    { type: 'npm', name: '@bugsnag/expo' },
  ],
});


--- src/rules/monitoring/datadog.ts ---

import { register } from '../../register.js';

register({
  tech: 'datadog',
  name: 'Datadog',
  type: 'monitoring',
  dotenv: ['DD_'],
  dependencies: [
    { type: 'npm', name: /^@datadog\//, example: '@datadog/cli' },
    { type: 'npm', name: 'dd-trace' },
    { type: 'npm', name: 'datadog-metrics' },
    { type: 'npm', name: '@datadog/datadog-api-client' },
    { type: 'npm', name: '@pulumi/datadog' },
    { type: 'terraform', name: 'registry.terraform.io/datadog/datadog' },
    {
      type: 'terraform.resource',
      name: /^datadog_/,
      example: 'datadog_metric_metadata',
    },
    { type: 'rust', name: 'ddtrace' },
    { type: 'rust', name: 'datadog-apm' },
    { type: 'ruby', name: 'ddtrace' },
    { type: 'ruby', name: /datadog/, example: 'datadog-lambda' },
    { type: 'php', name: 'datadog/php-datadogstatsd' },
    { type: 'php', name: 'datadog/dd-trace' },
    { type: 'githubAction', name: 'DataDog/synthetics-ci-github-action' },
    { type: 'githubAction', name: 'datadog/agent-github-action' },
    { type: 'python', name: 'datadog' },
    { type: 'docker', name: 'datadog/agent' },
  ],
});


--- src/rules/monitoring/dynatrace.ts ---

import { register } from '../../register.js';

register({
  tech: 'dynatrace',
  name: 'Dynatrace',
  type: 'monitoring',
  dotenv: ['DYNATRACE_'],
  dependencies: [
    {
      type: 'npm',
      name: /^@dynatrace\//,
      example: '@dynatrace/opentelemetry-core',
    },
  ],
});


--- src/rules/monitoring/gcp.logging.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.logging',
  name: 'Cloud Logging',
  type: 'monitoring',
  dependencies: [
    { type: 'npm', name: '@google-cloud/logging' },
    { type: 'golang', name: 'cloud.google.com/go/logging' },
    { type: 'ruby', name: 'google-cloud-logging' },
    { type: 'rust', name: 'google-cloud-logging' },
    { type: 'php', name: 'google/cloud-logging' },
    {
      type: 'terraform.resource',
      name: /^google_logging_/,
      example: 'google_logging_metric',
    },
  ],
});


--- src/rules/monitoring/healthchecksio.ts ---

import { register } from '../../register.js';

register({
  tech: 'healthchecksio',
  name: 'Healthchecks.io',
  type: 'monitoring',
});


--- src/rules/monitoring/honeybadger.ts ---

import { register } from '../../register.js';

register({
  tech: 'honeybadger',
  name: 'Honeybadger',
  type: 'monitoring',
  dotenv: ['HONEYBADGER_'],
  dependencies: [
    { type: 'npm', name: /^@honeybadger-io\//, example: '@honeybadger-io/js' },
    { type: 'npm', name: 'honeybadger' },
    { type: 'ruby', name: 'honeybadger' },
    { type: 'python', name: 'honeybadger' },
    { type: 'golang', name: 'github.com/honeybadger-io/honeybadger-go' },
    { type: 'php', name: 'honeybadger-io/honeybadger-laravel' },
    { type: 'php', name: 'honeybadger-io/honeybadger-php' },
    // { type: 'elixir', name: 'honeybadger' },
  ],
});


--- src/rules/monitoring/hyperdx.ts ---

import { register } from '../../register.js';

register({
  tech: 'hyperdx',
  name: 'HyperDX',
  type: 'monitoring',
  dependencies: [
    { type: 'npm', name: '@hyperdx/browser' },
    { type: 'npm', name: '@hyperdx/node-logger' },
    { type: 'npm', name: '@hyperdx/node-opentelemetry' },
    { type: 'npm', name: '@hyperdx/deno' },
    { type: 'npm', name: '@hyperdx/otel-react-native' },
    { type: 'golang', name: 'github.com/hyperdxio/hyperdx-go' },
  ],
});


--- src/rules/monitoring/index.ts ---

import './appsignal.js';
import './aws.cloudwatch.js';
import './betterstack.js';
import './blackfire.js';
import './bugsnag.js';
import './datadog.js';
import './dynatrace.js';
import './gcp.logging.js';
import './healthchecksio.js';
import './honeybadger.js';
import './hyperdx.js';
import './newrelic.js';
import './onlineornot.js';
import './opentelemetry.js';
import './papertrail.js';
import './pingdom.js';
import './prometheus.js';
import './rollbar.js';
import './scoutapm.js';
import './sentry.js';
import './signoz.js';
import './uptimekuma.js';
import './zipkin.js';


--- src/rules/monitoring/newrelic.ts ---

import { register } from '../../register.js';

register({
  tech: 'newrelic',
  name: 'New Relic',
  type: 'monitoring',
  dotenv: ['NEW_RELIC_'],
  dependencies: [
    { type: 'npm', name: 'newrelic' },
    { type: 'terraform', name: 'registry.terraform.io/newrelic/newrelic' },
    { type: 'ruby', name: 'newrelic_rpm' },
    { type: 'php', name: 'ekino/newrelic-bundle' },
    { type: 'php', name: 'intouch/newrelic' },
    { type: 'npm', name: '@pulumi/newrelic' },
  ],
});


--- src/rules/monitoring/onlineornot.ts ---

import { register } from '../../register.js';

register({
  tech: 'onlineornot',
  name: 'OnlineOrNot',
  type: 'monitoring',
  dependencies: [{ type: 'npm', name: 'onlineornot' }],
});


--- src/rules/monitoring/opentelemetry.ts ---

import { register } from '../../register.js';

register({
  tech: 'opentelemetry',
  name: 'OpenTelemetry',
  type: 'monitoring',
  dotenv: ['OTEL_'],
  dependencies: [
    { type: 'npm', name: '@opentelemetry/core' },
    { type: 'npm', name: '@opentelemetry/api' },
    { type: 'npm', name: '@opentelemetry/sdk-node' },
    { type: 'npm', name: '@opentelemetry/semantic-conventions' },
    { type: 'npm', name: '@sentry/opentelemetry-node' },
    { type: 'docker', name: 'otel/opentelemetry-collector-contrib' },
    { type: 'docker', name: 'otel/opentelemetry-collector' },
    { type: 'docker', name: 'otel/opentelemetry-operator' },
    { type: 'golang', name: 'go.opentelemetry.io/otel' },
    { type: 'php', name: 'open-telemetry/sdk' },
    { type: 'python', name: 'opentelemetry-distro' },
    { type: 'ruby', name: 'opentelemetry-sdk' },
    { type: 'ruby', name: 'sentry-opentelemetry' },
    { type: 'rust', name: 'opentelemetry' },
    { type: 'githubAction', name: 'plengauer/Thoth' },
    { type: 'golang', name: 'github.com/getsentry/sentry-go/otel' },
  ],
});


--- src/rules/monitoring/papertrail.ts ---

import { register } from '../../register.js';

register({
  tech: 'papertrail',
  name: 'Papertrail',
  type: 'monitoring',
  dotenv: ['PAPERTRAIL_'],
  dependencies: [
    { type: 'npm', name: 'winston-papertrail' },
    { type: 'npm', name: 'pino-papertrail' },
    { type: 'php', name: 'stephanecoinon/papertrail' },
    { type: 'ruby', name: 'papertrail' },
    { type: 'golang', name: 'github.com/papertrail/go-tail/follower' },
  ],
});


--- src/rules/monitoring/pingdom.ts ---

import { register } from '../../register.js';

register({
  tech: 'pingdom',
  name: 'Pingdom',
  type: 'monitoring',
  dotenv: ['PINGDOM_'],
  dependencies: [{ type: 'terraform', name: 'registry.terraform.io/russellcardullo/pingdom' }],
});


--- src/rules/monitoring/prometheus.ts ---

import { register } from '../../register.js';

register({
  tech: 'prometheus',
  name: 'Prometheus',
  type: 'monitoring',
  dependencies: [
    { type: 'npm', name: 'prom-client' },
    { type: 'npm', name: 'prometheus-gc-stats' },
    { type: 'docker', name: 'prom/prometheus' },
    { type: 'docker', name: 'bitnami/prometheus' },
    { type: 'docker', name: 'bitnami/prometheus-operator' },
    { type: 'docker', name: 'rancher/prometheus-auth' },
    { type: 'docker', name: 'ubuntu/prometheus' },
    { type: 'docker', name: 'newrelic/newrelic-prometheus-configurator' },
    { type: 'docker', name: 'nginx/nginx-prometheus-exporter' },
    { type: 'docker', name: 'newrelic/nri-prometheus' },
    { type: 'docker', name: 'grafana/mimir' },
    { type: 'docker', name: 'bitnami/nginx-exporter' },
    { type: 'rust', name: 'prometheus' },
    { type: 'php', name: 'promphp/prometheus_client_php' },
    { type: 'php', name: 'artprima/prometheus-metrics-bundle' },
    { type: 'ruby', name: 'prometheus-client' },
    { type: 'ruby', name: 'prometheus' },
    { type: 'ruby', name: 'prometheus_exporter' },
    { type: 'ruby', name: 'prometheus-client-mmap' },
    { type: 'ruby', name: 'fluent-plugin-prometheus' },
    {
      type: 'golang',
      name: 'github.com/prometheus/client_golang/prometheus',
    },
    { type: 'golang', name: 'github.com/go-kit/kit/metrics/prometheus' },
    { type: 'golang', name: 'github.com/grpc-ecosystem/go-grpc-prometheus' },
  ],
});


--- src/rules/monitoring/rollbar.ts ---

import { register } from '../../register.js';

register({
  tech: 'rollbar',
  name: 'Rollbar',
  type: 'monitoring',
  dotenv: ['ROOLBAR_'],
  dependencies: [
    { type: 'golang', name: 'github.com/rollbar/rollbar-go' },
    { type: 'npm', name: 'rollbar' },
    { type: 'npm', name: '@rollbar/react' },
    { type: 'npm', name: 'rollbar-react-native' },
    { type: 'php', name: 'rollbar/rollbar' },
    { type: 'php', name: 'rollbar/rollbar-laravel' },
    { type: 'php', name: 'rollbar/rollbar-magento2' },
    { type: 'php', name: 'rollbar/rollbar-php-symfony-bundle' },
    { type: 'php', name: 'wpackagist-plugin/rollbar' },
    { type: 'ruby', name: 'rollbar' },
    { type: 'githubAction', name: 'rollbar/github-deploy-action' },
    { type: 'terraform', name: 'registry.terraform.io/rollbar/rollbar' },
  ],
});


--- src/rules/monitoring/scoutapm.ts ---

import { register } from '../../register.js';

register({
  tech: 'scoutapm',
  name: 'Scout APM',
  type: 'monitoring',
  dependencies: [
    { type: 'ruby', name: 'scout_apm' },
    { type: 'php', name: 'scoutapp/scout-apm-php' },
    { type: 'php', name: 'scoutapp/scout-apm-laravel' },
    { type: 'npm', name: 'scoutapp/scout-apm-laravel' },
  ],
});


--- src/rules/monitoring/sentry.ts ---

import { register } from '../../register.js';

register({
  tech: 'sentry',
  name: 'Sentry',
  type: 'monitoring',
  dotenv: ['SENTRY_'],
  dependencies: [
    { type: 'docker', name: 'sentry' },
    { type: 'docker', name: 'getsentry/sentry' },
    { type: 'docker', name: 'getsentry/sentry-cli' },
    { type: 'docker', name: 'sentryintegrations/sentry-github-action-release' },
    { type: 'docker', name: 'daprio/sentry' },
    { type: 'docker', name: 'us.gcr.io/sentryio/sentry' },
    { type: 'npm', name: '@sentry/browser' },
    { type: 'npm', name: '@sentry/nextjs' },
    { type: 'npm', name: '@sentry/core' },
    { type: 'npm', name: '@sentry/node' },
    { type: 'npm', name: '@sentry/react' },
    { type: 'npm', name: '@sentry/react-native' },
    { type: 'npm', name: '@sentry/replay' },
    { type: 'npm', name: '@sentry/vercel-edge' },
    { type: 'npm', name: '@sentry/minimal' },
    { type: 'npm', name: '@sentry/integrations' },
    { type: 'npm', name: '@sentry/nestjs' },
    { type: 'npm', name: '@sentry/vue' },
    { type: 'npm', name: '@sentry/serveless' },
    { type: 'npm', name: '@sentry/electron' },
    { type: 'npm', name: '@sentry/aws-serverless' },
    { type: 'npm', name: '@sentry/remix' },
    { type: 'npm', name: '@sentry/svelte' },
    { type: 'npm', name: '@sentry/cloudflare' },
    { type: 'npm', name: '@sentry/nuxt' },
    { type: 'npm', name: '@sentry/bun' },
    { type: 'rust', name: 'sentry' },
    { type: 'ruby', name: 'sentry-ruby' },
    { type: 'ruby', name: 'sentry-rails' },
    { type: 'php', name: 'sentry/sentry' },
    { type: 'php', name: 'sentry/sentry-symfony' },
    { type: 'php', name: 'sentry/sentry-laravel' },
    { type: 'php', name: 'sentry/sdk' },
    { type: 'githubAction', name: 'getsentry/action-release' },
    { type: 'golang', name: 'github.com/getsentry/sentry-go' },
    { type: 'python', name: 'sentry_sdk' },
  ],
});


--- src/rules/monitoring/signoz.ts ---

import { register } from '../../register.js';

register({
  tech: 'signoz',
  name: 'Signoz',
  type: 'monitoring',
  dotenv: ['SIGNOZ_'],
  dependencies: [
    { type: 'docker', name: 'signoz/frontend' },
    { type: 'docker', name: 'signoz/alertmanager' },
    { type: 'docker', name: 'signoz/query-service' },
    { type: 'docker', name: 'signoz/signoz-otel-collector' },
    { type: 'docker', name: 'signoz/locust' },
  ],
});


--- src/rules/monitoring/uptimekuma.ts ---

import { register } from '../../register.js';

register({
  tech: 'uptimekuma',
  name: 'Uptime Kuma',
  type: 'monitoring',
  dependencies: [{ type: 'docker', name: 'louislam/uptime-kuma' }],
});


--- src/rules/monitoring/zipkin.ts ---

import { register } from '../../register.js';

register({
  tech: 'zipkin',
  name: 'Zipkin',
  type: 'monitoring',
  dependencies: [
    { type: 'docker', name: 'openzipkin/zipkin' },
    { type: 'golang', name: 'github.com/openzipkin/zipkin-go' },
    {
      type: 'golang',
      name: 'github.com/openzipkin-contrib/zipkin-go-opentracing',
    },
    { type: 'golang', name: 'github.com/go-kit/kit/tracing/zipkin' },
    { type: 'golang', name: 'go.opentelemetry.io/otel/exporters/zipkin' },
    { type: 'golang', name: 'contrib.go.opencensus.io/exporter/zipkin' },
    { type: 'npm', name: 'zipkin' },
    { type: 'npm', name: 'zipkin-context-cls' },
    { type: 'npm', name: 'zipkin-transport-http' },
    { type: 'npm', name: '@opentelemetry/exporter-zipkin' },
    { type: 'ruby', name: 'zipkin-tracer' },
    { type: 'php', name: 'openzipkin/zipkin' },
  ],
});


--- src/rules/network/gcp.dns.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.dns',
  name: 'Google DNS',
  type: 'network',
  dependencies: [
    { type: 'npm', name: '@google-cloud/dns' },
    {
      type: 'terraform.resource',
      name: /^google_dns_/,
      example: 'google_dns_record_set',
    },
    { type: 'ruby', name: 'google-cloud-dns' },
  ],
});


--- src/rules/network/index.ts ---

import './gcp.dns.js';


--- src/rules/notification/aws.ses.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.ses',
  name: 'AWS Simple Email Service',
  type: 'notification',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-ses' },
    { type: 'npm', name: 'aws-ses-v2-local' },
    { type: 'npm', name: 'nodemailer-ses-transport' },
    { type: 'npm', name: '@aws-sdk/client-ses' },
    { type: 'rust', name: 'aws-sdk-ses' },
    { type: 'rust', name: 'aws-sdk-sesv2' },
    { type: 'ruby', name: 'aws-ses' },
    { type: 'ruby', name: 'aws-sdk-ses' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/ses' },
    {
      type: 'terraform.resource',
      name: /^aws_ses/,
      example: 'aws_ses_queue',
    },
    { type: 'php', name: 'async-aws/ses' },
  ],
});


--- src/rules/notification/aws.sns.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.sns',
  name: 'AWS Notification Service',
  type: 'notification',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-sns' },
    { type: 'npm', name: '@aws-sdk/client-sns' },
    { type: 'rust', name: 'aws-sdk-sns' },
    { type: 'ruby', name: 'aws-sdk-sns' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/sns' },
    {
      type: 'terraform.resource',
      name: /^aws_sns/,
      example: 'aws_sns_topic',
    },
    { type: 'php', name: 'aws/aws-php-sns-message-validator' },
    { type: 'php', name: 'async-aws/sns' },
  ],
});


--- src/rules/notification/beehiiv.ts ---

import { register } from '../../register.js';

register({
  tech: 'beehiiv',
  name: 'Beehiiv',
  type: 'notification',
  dotenv: ['BEEHIIV_'],
  dependencies: [{ type: 'npm', name: '@beehiiv/sdk' }],
});


--- src/rules/notification/brevo.ts ---

import { register } from '../../register.js';

register({
  tech: 'brevo',
  name: 'Brevo',
  type: 'notification',
  dotenv: ['BREVO_'],
  dependencies: [
    { type: 'golang', name: 'github.com/getbrevo/brevo-go' },
    { type: 'npm', name: '@getbrevo/brevo' },
    { type: 'php', name: 'getbrevo/brevo-php' },
    { type: 'php', name: 'sendinblue/api-v3-sdk' },
    { type: 'ruby', name: 'sib-api-v3-sdk' },
    { type: 'npm', name: '@sendinblue/client' },
  ],
});


--- src/rules/notification/clicksend.ts ---

import { register } from '../../register.js';

register({
  tech: 'clicksend',
  name: 'ClickSend',
  type: 'notification',
  dotenv: ['CLICKSEND_'],
  dependencies: [{ type: 'npm', name: 'clicksend' }],
});


--- src/rules/notification/ifttt.ts ---

import { register } from '../../register.js';

register({
  tech: 'ifttt',
  name: 'ifttt',
  type: 'notification',
  dotenv: ['IFTTT'],
});


--- src/rules/notification/index.ts ---

import './aws.ses.js';
import './aws.sns.js';
import './beehiiv.js';
import './brevo.js';
import './clicksend.js';
import './ifttt.js';
import './mailchimp.js';
import './mailgun.js';
import './mailjet.js';
import './novu.js';
import './resend.js';
import './sendgrid.js';
import './twilio.js';
import './zapier.js';


--- src/rules/notification/mailchimp.ts ---

import { register } from '../../register.js';

register({
  tech: 'mailchimp',
  name: 'Mailchimp',
  type: 'notification',
  dotenv: ['MAILCHIMP_'],
  dependencies: [
    { type: 'npm', name: '@mailchimp/mailchimp_marketing' },
    { type: 'npm', name: '@mailchimp/mailchimp_transactional' },
    { type: 'ruby', name: 'MailchimpMarketing' },
    { type: 'ruby', name: 'MailchimpTransactional' },
    { type: 'php', name: 'drewm/mailchimp-api' },
    { type: 'php', name: 'mailchimp/transactional' },
    { type: 'php', name: 'mailchimp/makerting' },
    { type: 'terraform.resource', name: 'airbyte_source_mailchimp' },
  ],
});


--- src/rules/notification/mailgun.ts ---

import { register } from '../../register.js';

register({
  tech: 'mailgun',
  name: 'Mailgun',
  type: 'notification',
  dependencies: [
    { type: 'npm', name: 'mailgun.js' },
    { type: 'npm', name: 'nodemailer-mailgun-transport' },
    { type: 'php', name: 'mailgun/mailgun-php' },
    { type: 'ruby', name: 'mailgun-ruby' },
    { type: 'golang', name: 'github.com/mailgun/mailgun-go/v4' },
    { type: 'terraform.resource', name: 'airbyte_source_mailgun' },
  ],
});


--- src/rules/notification/mailjet.ts ---

import { register } from '../../register.js';

register({
  tech: 'mailjet',
  name: 'Mailjet',
  type: 'notification',
  dotenv: ['MAILJET_'],
  dependencies: [
    { type: 'npm', name: 'node-mailjet' },
    { type: 'rust', name: 'mailjet-rs' },
    { type: 'ruby', name: 'mailjet' },
    { type: 'php', name: 'mailjet/mailjet-apiv3-php' },
    { type: 'php', name: 'mailjet/laravel-mailjet' },
  ],
});


--- src/rules/notification/novu.ts ---

import { register } from '../../register.js';

register({
  tech: 'novu',
  name: 'Novy',
  type: 'notification',
  dependencies: [
    { type: 'npm', name: '@novu/notification-center-vue' },
    { type: 'npm', name: '@novu/notification-center' },
    { type: 'npm', name: '@novu/notification-center-angular' },
    { type: 'npm', name: '@novu/node' },
    { type: 'php', name: 'unicodeveloper/novu' },
    { type: 'php', name: 'novu/novu-laravel' },
    { type: 'python', name: 'novu' },
    { type: 'ruby', name: 'novu' },
    { type: 'golang', name: 'github.com/novuhq/go-novu' },
    { type: 'docker', name: 'ghcr.io/novuhq/novu/api' },
    { type: 'docker', name: 'ghcr.io/novuhq/novu/ws' },
    { type: 'docker', name: 'ghcr.io/novuhq/novu/widget' },
    { type: 'docker', name: 'ghcr.io/novuhq/novu/web' },
  ],
});


--- src/rules/notification/resend.ts ---

import { register } from '../../register.js';

register({
  tech: 'resend',
  name: 'Resend',
  type: 'notification',
  dotenv: ['RESEND_'],
  dependencies: [
    { type: 'npm', name: 'resend' },
    { type: 'php', name: 'resend/resend-php' },
    { type: 'php', name: 'resend/resend-laravel' },
    { type: 'python', name: 'resend' },
    { type: 'ruby', name: 'resend' },
    { type: 'golang', name: 'github.com/resend/resend-go/v2' },
    { type: 'rust', name: 'resend-rs' },
  ],
});


--- src/rules/notification/sendgrid.ts ---

import { register } from '../../register.js';

register({
  tech: 'sendgrid',
  name: 'Sendgrid',
  type: 'notification',
  dependencies: [
    { type: 'npm', name: /^@sendgrid\//, example: '@sendgrid/mail' },
    { type: 'npm', name: 'nodemailer-sendgrid' },
    { type: 'npm', name: 'nodemailer-sendgrid-transport' },
    { type: 'php', name: 'sendgrid/sendgrid' },
    { type: 'ruby', name: 'sendgrid-ruby' },
    { type: 'ruby', name: 'sendgrid-rails' },
    { type: 'ruby', name: 'sendgrid' },
    { type: 'golang', name: 'github.com/sendgrid/sendgrid-go' },
  ],
});


--- src/rules/notification/twilio.ts ---

import { register } from '../../register.js';

register({
  tech: 'twilio',
  name: 'Twilio',
  type: 'notification',
  dotenv: ['TWILIO_'],
  dependencies: [
    { type: 'npm', name: 'twilio' },
    { type: 'npm', name: /^@twilio\//, example: '@twilio/cli-core' },
    { type: 'php', name: 'twilio/sdk' },
    { type: 'githubAction', name: 'twilio-labs/actions-sms' },
    { type: 'golang', name: 'github.com/twilio/twilio-go' },
    { type: 'ruby', name: 'twilio-ruby' },
    { type: 'terraform.resource', name: 'airbyte_source_twilio' },
  ],
});


--- src/rules/notification/zapier.ts ---

import { register } from '../../register.js';

register({
  tech: 'zapier',
  name: 'Zapier',
  type: 'notification',
  dotenv: ['ZAPIER_'],
  dependencies: [
    { type: 'npm', name: 'zapier-platform-core' },
    { type: 'npm', name: 'zapier-platform-cli' },
  ],
});


--- src/rules/orm/dieselrs.ts ---

import { register } from '../../register.js';

register({
  tech: 'dieselrs',
  name: 'Diesel',
  type: 'orm',
  dependencies: [{ type: 'rust', name: 'diesel' }],
});


--- src/rules/orm/doctrinephp.ts ---

import { register } from '../../register.js';

register({
  tech: 'doctrinephp',
  name: 'Doctrine',
  type: 'orm',
  dependencies: [{ type: 'php', name: 'doctrine/orm' }],
});


--- src/rules/orm/drizzeleorm.ts ---

import { register } from '../../register.js';

register({
  tech: 'drizzleorm',
  name: 'Drizzle ORM',
  type: 'orm',
  dependencies: [{ type: 'npm', name: 'drizzle-orm' }],
});


--- src/rules/orm/goent.ts ---

import { register } from '../../register.js';

register({
  tech: 'goent',
  name: 'ent.',
  type: 'orm',
  dependencies: [{ type: 'golang', name: 'entgo.io/ent' }],
});


--- src/rules/orm/gorm.ts ---

import { register } from '../../register.js';

register({
  tech: 'gorm',
  name: 'GORM',
  type: 'orm',
  dependencies: [{ type: 'golang', name: 'gorm.io/gorm' }],
});


--- src/rules/orm/index.ts ---

import './dieselrs.js';
import './doctrinephp.js';
import './drizzeleorm.js';
import './goent.js';
import './gorm.js';
import './knex.js';
import './kysely.js';
import './prisma.js';
import './sequelize.js';
import './sequelruby.js';
import './sqlalchemy.js';
import './typeorm.js';


--- src/rules/orm/knex.ts ---

import { register } from '../../register.js';

register({
  tech: 'knex',
  name: 'Knex',
  type: 'orm',
  dependencies: [{ type: 'npm', name: 'knex' }],
});


--- src/rules/orm/kysely.ts ---

import { register } from '../../register.js';

register({
  tech: 'kysely',
  name: 'Kysely',
  type: 'orm',
  dependencies: [{ type: 'npm', name: 'kysely' }],
});


--- src/rules/orm/prisma.ts ---

import { register } from '../../register.js';

register({
  tech: 'prisma',
  name: 'Prisma',
  type: 'orm',
  files: ['schema.prisma'],
  dependencies: [{ type: 'npm', name: 'prisma' }],
});


--- src/rules/orm/sequelize.ts ---

import { register } from '../../register.js';

register({
  tech: 'sequelize',
  name: 'Sequelize',
  type: 'orm',
  files: ['.sequelizerc'],
  dependencies: [{ type: 'npm', name: /sequelize(-cli)?/, example: 'sequelize' }],
});


--- src/rules/orm/sequelruby.ts ---

import { register } from '../../register.js';

register({
  tech: 'sequelruby',
  name: 'Sequel',
  type: 'orm',
  dependencies: [{ type: 'ruby', name: 'sequel' }],
});


--- src/rules/orm/sqlalchemy.ts ---

import { register } from '../../register.js';

register({
  tech: 'sqlalchemy',
  name: 'SQLAlchemy',
  type: 'orm',
  dependencies: [{ type: 'python', name: 'SQLAlchemy' }],
});


--- src/rules/orm/typeorm.ts ---

import { register } from '../../register.js';

register({
  tech: 'typeorm',
  name: 'TypeORM',
  type: 'orm',
  dependencies: [{ type: 'npm', name: 'typeorm' }],
});


--- src/rules/package_manager/asdf.ts ---

import { register } from '../../register.js';

register({
  tech: 'asdf',
  name: 'asdf',
  type: 'package_manager',
  files: ['.tool-versions', '.asdfrc'],
});


--- src/rules/package_manager/bundler.ts ---

import { register } from '../../register.js';

register({
  tech: 'bundler',
  name: 'Bundler',
  type: 'package_manager',
  dependencies: [{ type: 'ruby', name: 'bundler' }],
});


--- src/rules/package_manager/cargo.ts ---

import { register } from '../../register.js';

register({
  tech: 'cargo',
  name: 'Cargo',
  type: 'package_manager',
  // files: ['Cargo.toml'],
});


--- src/rules/package_manager/goenv.ts ---

import { register } from '../../register.js';

register({
  tech: 'goenv',
  name: 'goenv',
  type: 'package_manager',
  files: ['.go-version'],
});


--- src/rules/package_manager/index.ts ---

import './asdf.js';
import './bundler.js';
import './cargo.js';
import './goenv.js';
import './npm.js';
import './nuget.js';
import './nvm.js';
import './phpcomposer.js';
import './phpenv.js';
import './pipenv.js';
import './pnpm.js';
import './poetry.js';
import './rubyenv.js';
import './yarn.js';


--- src/rules/package_manager/npm.ts ---

import { register } from '../../register.js';

register({
  tech: 'npm',
  name: 'npm',
  type: 'package_manager',
  files: ['package-lock.json'],
});


--- src/rules/package_manager/nuget.ts ---

import { register } from '../../register.js';

register({
  tech: 'nuget',
  name: 'NuGet',
  type: 'package_manager',
  files: ['.csproj'],
});


--- src/rules/package_manager/nvm.ts ---

import { register } from '../../register.js';

register({
  tech: 'nvm',
  name: 'nvm',
  type: 'package_manager',
  files: ['.nvmrc'],
});


--- src/rules/package_manager/phpcomposer.ts ---

import { register } from '../../register.js';

register({
  tech: 'phpcomposer',
  name: 'Composer',
  type: 'package_manager',
  // files: ['composer.json'],
});


--- src/rules/package_manager/phpenv.ts ---

import { register } from '../../register.js';

register({
  tech: 'phpenv',
  name: 'phpenv',
  type: 'package_manager',
  files: ['.php-version'],
});


--- src/rules/package_manager/pipenv.ts ---

import { register } from '../../register.js';

register({
  tech: 'pipenv',
  name: 'pipenv',
  type: 'package_manager',
  files: ['Pipfile.lock'],
});


--- src/rules/package_manager/pnpm.ts ---

import { register } from '../../register.js';

register({
  tech: 'pnpm',
  name: 'pnpm',
  type: 'package_manager',
  files: ['pnpm-lock.yaml'],
});


--- src/rules/package_manager/poetry.ts ---

import { register } from '../../register.js';

register({
  tech: 'poetry',
  name: 'Poetry',
  type: 'package_manager',
  files: ['poetry.lock'],
});


--- src/rules/package_manager/rubyenv.ts ---

import { register } from '../../register.js';

register({
  tech: 'rubyenv',
  name: 'rubyenv',
  type: 'package_manager',
  files: ['.ruby-version'],
});


--- src/rules/package_manager/yarn.ts ---

import { register } from '../../register.js';

register({
  tech: 'yarn',
  name: 'Yarn',
  type: 'package_manager',
  files: ['yarn.lock'],
});


--- src/rules/payment/adyen.ts ---

import { register } from '../../register.js';

register({
  tech: 'adyen',
  name: 'Adyen',
  type: 'payment',
  dotenv: ['ADYEN_'],
  dependencies: [
    { type: 'npm', name: '@adyen/adyen-web' },
    { type: 'npm', name: '@adyen/api-library' },
    { type: 'npm', name: '@adyen/react-native' },
    { type: 'php', name: 'adyen/php-api-library' },
    { type: 'php', name: 'adyen/module-payment' },
    { type: 'php', name: 'adyen/php-webhook-module' },
    { type: 'ruby', name: 'adyen' },
    { type: 'ruby', name: 'adyen-ruby-api-library' },
    { type: 'ruby', name: 'adyen-cse-ruby' },
  ],
});


--- src/rules/payment/chargebee.ts ---

import { register } from '../../register.js';

register({
  tech: 'chargebee',
  name: 'Chargebee',
  type: 'payment',
  dotenv: ['CHARGEBEE_'],
  dependencies: [
    { type: 'npm', name: 'chargebee' },
    { type: 'npm', name: 'chargebee-typescript' },
    { type: 'npm', name: /^@chargebee\//, example: '@chargebee/mcp' },
    { type: 'python', name: 'chargebee' },
    { type: 'ruby', name: 'chargebee-ruby' },
    { type: 'php', name: 'chargebee/chargebee-php' },
    { type: 'golang', name: 'github.com/chargebee/chargebee-go' },
  ],
});


--- src/rules/payment/google.pay.ts ---

import { register } from '../../register.js';

register({
  tech: 'google.pay',
  name: 'Google Pay',
  type: 'payment',
  dotenv: ['GOOGLE_PAY_', 'GPAY_'],
  dependencies: [{ type: 'npm', name: '@types/googlepay' }],
});


--- src/rules/payment/index.ts ---

import './adyen.js';
import './chargebee.js';
import './google.pay.js';
import './intuit.js';
import './klarna.js';
import './lemonsqueezy.js';
import './paddle.js';
import './paypal.js';
import './paystack.js';
import './polarsh.js';
import './revenuecat.js';
import './squareup.js';
import './stripe.js';
import './useautumn.js';
import './zuora.js';


--- src/rules/payment/intuit.ts ---

import { register } from '../../register.js';

register({
  tech: 'intuit',
  name: 'Intuit',
  type: 'payment',
  dotenv: ['INTUIT_'],
});


--- src/rules/payment/klarna.ts ---

import { register } from '../../register.js';

register({
  tech: 'klarna',
  name: 'Klarna',
  type: 'payment',
  dotenv: ['KLARNA_'],
  dependencies: [
    { type: 'ruby', name: 'klarna_proxy' },
    { type: 'ruby', name: 'klarna-checkout' },
    { type: 'terraform.resource', name: 'airbyte_source_klarna' },
  ],
});


--- src/rules/payment/lemonsqueezy.ts ---

import { register } from '../../register.js';

register({
  tech: 'lemonsqueezy',
  name: 'Lemon Squeezy',
  type: 'payment',
  dotenv: ['LEMON_SQUEEZY_', 'LEMONSQUEEZY_'],
  dependencies: [
    { type: 'npm', name: 'lemonsqueezy.ts' },
    { type: 'ruby', name: 'lemonsqueezy' },
    { type: 'golang', name: 'github.com/NdoleStudio/lemonsqueezy-go' },
    { type: 'php', name: 'lemonsqueezy/laravel' },
  ],
});


--- src/rules/payment/paddle.ts ---

import { register } from '../../register.js';

register({
  tech: 'paddle',
  name: 'Paddle',
  type: 'payment',
  dotenv: ['PADDLE_'],
  dependencies: [
    { type: 'npm', name: '@paddle/paddle-js' },
    { type: 'npm', name: '@paddle/paddle-node-sdk' },
    { type: 'golang', name: 'github.com/PaddleHQ/paddle-go-sdk' },
    { type: 'python', name: 'paddle-python-sdk' },
    { type: 'php', name: 'paddlehq/paddle-php-sdk' },
  ],
});


--- src/rules/payment/paypal.ts ---

import { register } from '../../register.js';

register({
  tech: 'paypal',
  name: 'Paypal',
  type: 'payment',
  dotenv: ['PAYPAL_'],
  dependencies: [
    { type: 'npm', name: '@paypal/paypal-js' },
    { type: 'npm', name: 'paypal-rest-sdk' },
    { type: 'php', name: 'paypal/rest-api-sdk-php' },
    { type: 'php', name: 'srmklive/paypal' },
    { type: 'php', name: 'omnipay/paypal' },
    { type: 'ruby', name: 'paypal' },
    { type: 'ruby', name: 'paypal-sdk-rest' },
    { type: 'ruby', name: 'paypal-express' },
    { type: 'ruby', name: 'paypal-sdk-core' },
    { type: 'ruby', name: 'paypal-sdk-merchant' },
    { type: 'ruby', name: 'paypal-checkout-sdk' },
    { type: 'rust', name: 'paypal-rs' },
    { type: 'golang', name: 'github.com/markbates/goth/providers/paypal' },
  ],
});


--- src/rules/payment/paystack.ts ---

import { register } from '../../register.js';

register({
  tech: 'paystack',
  name: 'Paystack',
  type: 'payment',
  dotenv: ['PAYSTACK_'],
  dependencies: [{ type: 'npm', name: /^@paystack\//, example: '@paystack/inline-js' }],
});


--- src/rules/payment/polarsh.ts ---

import { register } from '../../register.js';

register({
  tech: 'polarsh',
  name: 'Polar',
  type: 'payment',
  dotenv: ['POLARSH_'],
  dependencies: [
    { type: 'npm', name: /^@polar-sh\//, example: '@polar-sh/mcp' },
    { type: 'python', name: 'polar-sdk' },
    { type: 'php', name: 'polar-sh/sdk' },
    { type: 'golang', name: 'github.com/polarsource/polar-go' },
  ],
});


--- src/rules/payment/revenuecat.ts ---

import { register } from '../../register.js';

register({
  tech: 'revenuecat',
  name: 'RevenueCat',
  type: 'payment',
  dotenv: ['REVENUECAT_'],
  dependencies: [
    { type: 'npm', name: /^@revenuecat\//, example: '@revenuecat/react-native-purchases' },
  ],
});


--- src/rules/payment/squareup.ts ---

import { register } from '../../register.js';

register({
  tech: 'squareup',
  name: 'Square',
  type: 'payment',
  dotenv: ['SQUARE_'],
  dependencies: [{ type: 'php', name: 'square/square' }],
});


--- src/rules/payment/stripe.ts ---

import { register } from '../../register.js';

register({
  tech: 'stripe',
  name: 'Stripe',
  type: 'payment',
  dotenv: ['STRIPE_'],
  dependencies: [
    { type: 'npm', name: 'stripe' },
    { type: 'php', name: 'stripe/stripe-php' },
    { type: 'php', name: 'laravel/cashier' },
    { type: 'php', name: 'omnipay/stripe' },
    { type: 'php', name: 'cartalyst/stripe' },
    { type: 'ruby', name: 'stripe' },
    { type: 'ruby', name: 'stripe-rails' },
    { type: 'ruby', name: 'stripe_event' },
    { type: 'golang', name: 'github.com/stripe/stripe-go' },
  ],
});


--- src/rules/payment/useautumn.ts ---

import { register } from '../../register.js';

register({
  tech: 'useautumn',
  name: 'Use Autumn',
  type: 'payment',
  dotenv: ['AUTUMN_'],
  dependencies: [{ type: 'npm', name: 'autumn-js' }],
});


--- src/rules/payment/zuora.ts ---

import { register } from '../../register.js';

register({
  tech: 'zuora',
  name: 'Zuora',
  type: 'payment',
  dotenv: ['ZUORA_'],
  dependencies: [
    { type: 'npm', name: 'zuora-sdk-js' },
    { type: 'python', name: 'zuora-sdk' },
  ],
});


--- src/rules/quality.test.ts ---

/* eslint-disable vitest/no-conditional-expect */
import fs from 'node:fs';
import path from 'node:path';

import { describe, expect, it } from 'vitest';

import { dependencies, rawList } from '../loader.js';
import { registeredRules } from '../register.js';
import '../autoload.js';

const RULES_DIR = import.meta.dirname;

function getTypeFromFile(filePath: string): null | string {
  const content = fs.readFileSync(filePath, 'utf8');
  // Simple regex to extract type: 'value' or type: "value"
  const match = content.match(/type:\s*['"]([a-zA-Z0-9_]+)['"]/);
  return match ? match[1] : null;
}

describe('folder matches rule type', () => {
  const entries = fs.readdirSync(RULES_DIR, { withFileTypes: true });
  for (const entry of entries) {
    if (!entry.isDirectory()) {
      continue;
    }
    if (entry.name === '__snapshots__') {
      continue;
    }

    const folder = entry.name;
    const folderPath = path.join(RULES_DIR, folder);
    const files = fs.readdirSync(folderPath);
    for (const file of files) {
      if (!file.endsWith('.ts')) {
        continue;
      }
      if (file === 'index.ts') {
        continue;
      }

      const filePath = path.join(folderPath, file);

      it(`${path.basename(filePath)} type = '${folder}'`, () => {
        const type = getTypeFromFile(filePath);

        expect(type).toBe(folder);
      });
    }
  }
});

describe('no duplicate', () => {
  it('should not list multiple times the same name', () => {
    const names = new Set<string>();
    for (const rule of registeredRules) {
      if (names.has(rule.name)) {
        expect(rule.name).toBe(false);

        continue;
      }

      names.add(rule.name);
    }
  });

  it('should not list multiple times the same dependencies', () => {
    const deps = new Set<string>();
    for (const rule of registeredRules) {
      if (!rule.dependencies) {
        continue;
      }

      for (const dep of rule.dependencies) {
        const str = `${dep.type}||${dep.name}`;
        if (deps.has(str)) {
          expect(str).toBe(false);

          continue;
        }

        deps.add(str);
      }
    }
  });

  it('should not match multiple techs', () => {
    for (const [name, matchers] of Object.entries(dependencies)) {
      const examples = new Set<string>();

      for (const item of rawList) {
        if (item.type !== 'dependency' || item.ref.type !== name) {
          continue;
        }

        const ex = 'example' in item.ref ? item.ref.example : item.ref.name;
        if (examples.has(ex)) {
          expect(ex).toBe(false);

          continue;
        }

        examples.add(ex);
      }

      for (const ex of examples) {
        let matched: null | string = null;
        for (const matcher of matchers) {
          if (!matcher.match.test(ex)) {
            continue;
          }
          if (matched) {
            if (matched.split('.')[0] === matcher.tech.split('.')[0]) {
              // Skip hosting
              continue;
            }
            throw new Error(
              `Dependency "${ex}" (${name}) was already matched by "${matched}", and again by "${matcher.tech}"`
            );
          }
          matched = matcher.tech;
        }
      }
    }
  });
});

describe('rule completeness', () => {
  for (const rule of registeredRules) {
    it(`${rule.tech} should have at least one rule`, () => {
      const hasFiles = 'files' in rule && rule.files !== undefined;
      const hasDependencies =
        'dependencies' in rule && rule.dependencies !== undefined && rule.dependencies.length > 0;
      const hasExtensions =
        'extensions' in rule && rule.extensions !== undefined && rule.extensions.length > 0;
      const hasDotEnv = 'dotenv' in rule && rule.dotenv !== undefined && rule.dotenv.length > 0;
      if (!(hasFiles || hasDependencies || hasExtensions || hasDotEnv)) {
        // eslint-disable-next-line no-console
        console.warn(`[WARNING] Rule "${rule.tech}" does not have a rule`);
      }

      expect(true).toBe(true); // Always pass
    });
  }
});


--- src/rules/queue/apacheKafka.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_kafka',
  name: 'Apache Kafka',
  type: 'queue',
  dependencies: [
    { type: 'docker', name: 'bitnami/kafka' },
    { type: 'docker', name: 'ubuntu/kafka' },
    { type: 'docker', name: 'bitnamicharts/kafka' },
    { type: 'terraform', name: 'registry.terraform.io/confluentinc/confluent' },
    { type: 'php', name: 'nmred/kafka-php' },
    { type: 'php', name: 'longlang/phpkafka' },
    { type: 'npm', name: 'kafkajs' },
    { type: 'npm', name: 'kafka-node' },
    { type: 'npm', name: 'kafkajs-snappy' },
    { type: 'npm', name: '@opentelemetry/instrumentation-kafkajs' },
    { type: 'ruby', name: 'ruby-kafka' },
    { type: 'ruby', name: 'fluent-plugin-kafka' },
    { type: 'ruby', name: 'logstash-output-kafka' },
    { type: 'ruby', name: 'logstash-input-kafka' },
  ],
});


--- src/rules/queue/aws.kafka.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.kafka',
  name: 'AWS Kafka',
  type: 'queue',
  dependencies: [
    { type: 'npm', name: '@pulumi/kafka' },
    { type: 'ruby', name: 'aws-sdk-kafka' },
    { type: 'terraform.resource', name: 'aws_msk_cluster' },
    { type: 'terraform.resource', name: 'aws_msk_configuration' },
    { type: 'terraform.resource', name: 'aws_mskconnect_connector' },
  ],
});


--- src/rules/queue/aws.kinesis.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.kinesis',
  name: 'AWS Kinesis',
  type: 'queue',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-kinesis' },
    { type: 'npm', name: '@aws-sdk/client-firehose' },
    { type: 'npm', name: '@aws-cdk/aws-kinesis' },
    { type: 'npm', name: '@aws-cdk/aws-firehose' },
    { type: 'rust', name: 'aws-sdk-kinesis' },
    { type: 'rust', name: 'aws-sdk-firehose' },
    { type: 'ruby', name: 'aws-sdk-kinesis' },
    { type: 'ruby', name: 'aws-sdk-firehose' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/kinesis' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/firehose' },
    {
      type: 'terraform.resource',
      name: /^aws_kinesis_/,
      example: 'aws_kinesis_stream',
    },
  ],
});


--- src/rules/queue/aws.mq.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.mq',
  name: 'AWS ActiveMQ',
  type: 'queue',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-mq' },
    { type: 'npm', name: '@aws-sdk/client-mq' },
    { type: 'rust', name: 'aws-sdk-mq' },
    { type: 'ruby', name: 'aws-sdk-mq' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/mq' },
    {
      type: 'terraform.resource',
      name: /^aws_mq_/,
      example: 'aws_mq_broker',
    },
  ],
});


--- src/rules/queue/aws.sqs.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.sqs',
  name: 'AWS SQS',
  type: 'queue',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-sqs' },
    { type: 'npm', name: '@aws-sdk/client-sqs' },
    { type: 'rust', name: 'aws-sdk-sqs' },
    { type: 'ruby', name: 'aws-sdk-sqs' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/sqs' },
    {
      type: 'terraform.resource',
      name: /^aws_sqs/,
      example: 'aws_sqs_queue',
    },
    { type: 'php', name: 'async-aws/sqs' },
    { type: 'terraform.resource', name: 'airbyte_source_amazon_sqs' },
  ],
});


--- src/rules/queue/celery.ts ---

import { register } from '../../register.js';

register({
  tech: 'celery',
  name: 'Celery',
  type: 'queue',
  dependencies: [{ type: 'python', name: 'celery' }],
});


--- src/rules/queue/gcp.pubsub.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.pubsub',
  name: 'PubSub',
  type: 'queue',
  dependencies: [
    { type: 'npm', name: '@google-cloud/pubsub' },
    {
      type: 'terraform.resource',
      name: /^google_pubsub_/,
      example: 'google_pubsub_topic',
    },
    { type: 'golang', name: 'cloud.google.com/go/pubsub' },
    { type: 'rust', name: 'google-cloud-pubsub' },
    { type: 'ruby', name: 'google-cloud-pubsub' },
    { type: 'php', name: 'google/cloud-pubsub' },
    { type: 'php', name: 'gos/pubsub-router-bundle' },
    { type: 'php', name: 'petitpress/gps-messenger-bundle' },
    { type: 'terraform.resource', name: 'airbyte_destination_pubsub' },
  ],
});


--- src/rules/queue/index.ts ---

import './apacheKafka.js';
import './aws.kafka.js';
import './aws.kinesis.js';
import './aws.mq.js';
import './aws.sqs.js';
import './celery.js';
import './gcp.pubsub.js';
import './nats.js';
import './rabbitmq.js';
import './scaleway.mq.js';
import './supabase.realtime.js';
import './upstash.kafka.js';
import './upstash.qstash.js';


--- src/rules/queue/nats.ts ---

import { register } from '../../register.js';

register({
  tech: 'nats',
  name: 'Nats',
  type: 'queue',
  dependencies: [
    { type: 'docker', name: 'nats' },
    { type: 'docker', name: 'nats-streaming' },
    { type: 'docker', name: 'bitnami/nats' },
    { type: 'npm', name: 'nats' },
    { type: 'php', name: 'repejota/nats' },
    { type: 'ruby', name: 'nats-pure' },
    { type: 'ruby', name: 'nats' },
    { type: 'golang', name: 'github.com/nats-io/nats.go' },
    { type: 'golang', name: 'github.com/nats-io/stan.go' },
    { type: 'rust', name: 'nats' },
  ],
});


--- src/rules/queue/rabbitmq.ts ---

import { register } from '../../register.js';

register({
  tech: 'rabbitmq',
  name: 'RabbitMQ',
  type: 'queue',
  dotenv: ['RABBITMQ_'],
  dependencies: [
    { type: 'npm', name: 'amqplib' },
    { type: 'npm', name: '@opentelemetry/instrumentation-amqplib' },
    { type: 'docker', name: /rabbitmq/, example: 'rabbitmq:0.0.0' },
    { type: 'rust', name: 'rabbitmq-stream-client' },
    { type: 'ruby', name: 'bunny' },
    { type: 'php', name: 'php-amqplib/php-amqplib' },
    { type: 'npm', name: '@pulumi/rabbitmq' },
    { type: 'python', name: 'amqp' },
  ],
});


--- src/rules/queue/scaleway.mq.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.mq',
  name: 'Scaleway M&Q',
  type: 'queue',
  dependencies: [
    { type: 'terraform.resource', name: 'scaleway_mnq_namespace' },
    { type: 'terraform.resource', name: 'scaleway_mnq_queue' },
  ],
});


--- src/rules/queue/supabase.realtime.ts ---

import { register } from '../../register.js';

register({
  tech: 'supabase.realtime',
  name: 'Supabase Realtime',
  type: 'queue',
  dependencies: [
    { type: 'npm', name: '@supabase/realtime-js' },
    { type: 'docker', name: 'bitnami/supabase-realtime' },
    { type: 'docker', name: 'supabase/realtime' },
  ],
});


--- src/rules/queue/upstash.kafka.ts ---

import { register } from '../../register.js';

register({
  tech: 'upstash.kafka',
  name: 'Upstash Kafka',
  type: 'queue',
  dotenv: ['UPSTASH_KAFKA_'],
  dependencies: [{ type: 'npm', name: '@upstash/kafka' }],
});


--- src/rules/queue/upstash.qstash.ts ---

import { register } from '../../register.js';

register({
  tech: 'upstash.qstash',
  name: 'Upstash QStash',
  type: 'queue',
  dependencies: [{ type: 'npm', name: '@upstash/qstash' }],
});


--- src/rules/runtime/apacheCordova.ts ---

import { register } from '../../register.js';

register({
  tech: 'apacheCordova',
  name: 'Cordova',
  type: 'runtime',
  dependencies: [
    { type: 'npm', name: 'cordova' },
    { type: 'npm', name: 'cordova-android' },
    { type: 'npm', name: 'cordova-ios' },
    { type: 'npm', name: 'cordova-windows' },
    { type: 'npm', name: 'cordova-browser' },
    { type: 'npm', name: 'cordova-electron' },
    { type: 'npm', name: 'cordova-plugin-camera' },
    { type: 'npm', name: 'cordova-plugin-file' },
    { type: 'npm', name: '@types/cordova' },
  ],
});


--- src/rules/runtime/bunsh.ts ---

import { register } from '../../register.js';

register({
  tech: 'bunsh',
  name: 'Bun',
  type: 'runtime',
  files: ['bun.lock'],
});


--- src/rules/runtime/capacitorjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'capacitorjs',
  name: 'Capacitor',
  type: 'runtime',
  files: ['capacitor.config.ts'],
  dependencies: [{ type: 'npm', name: '@capacitor/app' }],
});


--- src/rules/runtime/electron.ts ---

import { register } from '../../register.js';

register({
  tech: 'electron',
  name: 'Electron',
  type: 'runtime',
  dependencies: [
    { type: 'npm', name: 'electron' },
    { type: 'githubAction', name: 'samuelmeuli/action-electron-builder' },
  ],
});


--- src/rules/runtime/index.ts ---

import './apacheCordova.js';
import './bunsh.js';
import './capacitorjs.js';
import './electron.js';


--- src/rules/saas/atlassian.bitbucket.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlassian.bitbucket',
  name: 'Atlassian Bitbucket',
  type: 'saas',
  dependencies: [{ type: 'php', name: 'bitbucket/client' }],
});


--- src/rules/saas/base44.ts ---

import { register } from '../../register.js';

register({
  tech: 'base44',
  name: 'Base44',
  type: 'saas',
  dependencies: [{ type: 'npm', name: '@base44/sdk' }],
});


--- src/rules/saas/box.ts ---

import { register } from '../../register.js';

register({
  tech: 'box',
  name: 'Box',
  type: 'saas',
  dependencies: [
    { type: 'npm', name: 'box-node-sdk' },
    { type: 'python', name: 'boxsdk' },
    { type: 'php', name: 'box/box-php-sdk' },
  ],
});


--- src/rules/saas/cloudinary.ts ---

import { register } from '../../register.js';

register({
  tech: 'cloudinary',
  name: 'Cloudinary',
  type: 'saas',
  dotenv: ['CLOUDINARY_'],
  dependencies: [
    { type: 'npm', name: 'cloudinary' },
    { type: 'python', name: 'cloudinary' },
    { type: 'php', name: 'cloudinary/cloudinary_php' },
    { type: 'ruby', name: 'cloudinary' },
    { type: 'golang', name: 'github.com/cloudinary/cloudinary-go/v2' },
  ],
});


--- src/rules/saas/docusign.ts ---

import { register } from '../../register.js';

register({
  tech: 'docusign',
  name: 'Docusign',
  type: 'saas',
  dotenv: ['DOCUSIGN_'],
  dependencies: [
    { type: 'npm', name: 'docusign-esign' },
    { type: 'ruby', name: 'docusign_esign' },
    { type: 'php', name: 'docusign/esign-client' },
  ],
});


--- src/rules/saas/dropbox.ts ---

import { register } from '../../register.js';

register({
  tech: 'dropbox',
  name: 'Dropbox',
  type: 'saas',
  dotenv: ['DROPBOX_'],
  dependencies: [{ type: 'php', name: 'spatie/dropbox-api' }],
});


--- src/rules/saas/figma.ts ---

import { register } from '../../register.js';

register({
  tech: 'figma',
  name: 'Figma',
  type: 'saas',
  dotenv: ['FIGMA_'],
  dependencies: [{ type: 'npm', name: /^@figma\//, example: '@figma/plugin-typings' }],
});


--- src/rules/saas/github.ts ---

import { register } from '../../register.js';

register({
  tech: 'github',
  name: 'GitHub',
  type: 'saas',
  files: ['.github'],
  dependencies: [
    { type: 'npm', name: 'octokit' },
    { type: 'npm', name: /^@octokit\//, example: '@octokit/types' },
    { type: 'terraform', name: 'registry.terraform.io/integrations/github' },
    { type: 'ruby', name: 'octokit' },
    { type: 'php', name: 'knplabs/github-api' },
    { type: 'npm', name: '@pulumi/github' },
    { type: 'python', name: 'PyGithub' },
    { type: 'terraform.resource', name: 'airbyte_source_github' },
  ],
});


--- src/rules/saas/hypertune.ts ---

import { register } from '../../register.js';

register({
  tech: 'hypertune',
  name: 'Hypertune',
  type: 'saas',
  dependencies: [{ type: 'npm', name: 'hypertune' }],
});


--- src/rules/saas/index.ts ---

import './atlassian.bitbucket.js';
import './base44.js';
import './box.js';
import './cloudinary.js';
import './docusign.js';
import './dropbox.js';
import './figma.js';
import './github.js';
import './hypertune.js';
import './lago.js';
import './launchdarkly.js';
import './logrocket.js';
import './lovable.js';
import './metabase.js';
import './optimizely.js';
import './pagerduty.js';
import './placekit.js';
import './postman.js';
import './postmark.js';
import './prismacloud.js';
import './sap.js';
import './sas.js';
import './servicenow.js';
import './splitio.js';
import './splunk.js';
import './spotify.js';
import './tailscale.js';
import './veriff.js';
import './vialink.js';
import './withorb.js';
import './wolframalpha.js';
import './yousign.js';


--- src/rules/saas/lago.ts ---

import { register } from '../../register.js';

register({
  tech: 'lago',
  name: 'Lago',
  type: 'saas',
  dotenv: ['LAGO_'],
  dependencies: [
    { type: 'npm', name: 'lago-javascript-client' },
    { type: 'golang', name: 'github.com/getlago/lago-go-client' },
    { type: 'ruby', name: 'lago-ruby-client' },
    { type: 'python', name: 'lago-python-client' },
    { type: 'docker', name: 'getlago/front' },
    { type: 'docker', name: 'getlago/api' },
    { type: 'docker', name: 'getlago/lago-gotenberg' },
  ],
});


--- src/rules/saas/launchdarkly.ts ---

import { register } from '../../register.js';

register({
  tech: 'launchdarkly',
  name: 'LaunchDarkly',
  type: 'saas',
  dotenv: ['LAUNCHDARKLY_', 'LAUNCH_DARKLY_'],
  dependencies: [
    {
      type: 'npm',
      name: /launchdarkly-.+-client-sdk/,
      example: 'launchdarkly-react-client-sdk',
    },
    {
      type: 'npm',
      name: /^@launchdarkly\//,
      example: '@launchdarkly/cloudflare-server-sdk',
    },
    {
      type: 'golang',
      name: /github.com\/launchdarkly\//,
      example: 'github.com/launchdarkly/go-sdk-common/v3',
    },
    { type: 'ruby', name: 'launchdarkly-server-sdk' },
    { type: 'ruby', name: 'ldclient-rb' },
    { type: 'rust', name: 'launchdarkly-server-sdk' },
    {
      type: 'terraform',
      name: 'registry.terraform.io/launchdarkly/launchdarkly',
    },
    { type: 'php', name: 'launchdarkly/server-sdk' },
    { type: 'php', name: 'launchdarkly/launchdarkly-php' },
    { type: 'githubAction', name: 'launchdarkly/find-code-references' },
  ],
});


--- src/rules/saas/logrocket.ts ---

import { register } from '../../register.js';

register({
  tech: 'logrocket',
  name: 'LogRocket',
  type: 'saas',
  dependencies: [{ type: 'npm', name: 'logrocket' }],
});


--- src/rules/saas/lovable.ts ---

import { register } from '../../register.js';

register({
  tech: 'lovable',
  name: 'Lovable',
  type: 'saas',
  dependencies: [{ type: 'npm', name: 'lovable-tagger' }],
});


--- src/rules/saas/metabase.ts ---

import { register } from '../../register.js';

register({
  tech: 'metabase',
  name: 'Metabase',
  type: 'saas',
  dependencies: [
    { type: 'npm', name: '@metabase/embedding-sdk-react' },
    { type: 'docker', name: 'metabase/metabase' },
  ],
});


--- src/rules/saas/optimizely.ts ---

import { register } from '../../register.js';

register({
  tech: 'optimizely',
  name: 'Optimizely',
  type: 'saas',
  dotenv: ['OPTIMIZELY_'],
  dependencies: [
    { type: 'npm', name: '@optimizely/optimizely-sdk' },
    { type: 'npm', name: '@optimizely/react-sdk' },
    { type: 'npm', name: '@optimizely/js-sdk-utils' },
    { type: 'npm', name: '@optimizely/js-sdk-logging' },
    { type: 'npm', name: '@optimizely/js-sdk-event-processor' },
    { type: 'ruby', name: 'optimizely-sdk' },
    { type: 'ruby', name: 'optimizely' },
    { type: 'ruby', name: 'optimizely_server_side' },
    { type: 'php', name: 'optimizely/optimizely-sdk' },
    { type: 'githubAction', name: 'optimizely/upload-custom-code-action' },
    { type: 'golang', name: 'github.com/optimizely/go-sdk' },
  ],
});


--- src/rules/saas/pagerduty.ts ---

import { register } from '../../register.js';

register({
  tech: 'pagerduty',
  name: 'Pagerduty',
  type: 'saas',
  dotenv: ['PAGERDUTY_'],
  dependencies: [
    { type: 'npm', name: '@pagerduty/pdjs' },
    { type: 'terraform', name: 'registry.terraform.io/PagerDuty/pagerduty' },
    { type: 'rust', name: 'pagerduty-rs' },
    { type: 'ruby', name: 'pagerduty' },
    { type: 'php', name: 'adilbaig/pagerduty' },
    { type: 'npm', name: '@pulumi/pagerduty' },
  ],
});


--- src/rules/saas/placekit.ts ---

import { register } from '../../register.js';

register({
  tech: 'placekit',
  name: 'PlaceKit',
  type: 'saas',
  dependencies: [{ type: 'npm', name: /^@placekit\//, example: '@placekit/client-js' }],
});


--- src/rules/saas/postman.ts ---

import { register } from '../../register.js';

register({
  tech: 'postman',
  name: 'Postman',
  type: 'saas',
  dependencies: [
    { type: 'npm', name: 'postman-collection' },
    { type: 'npm', name: 'postman-request' },
    { type: 'npm', name: 'newman' },
  ],
});


--- src/rules/saas/postmark.ts ---

import { register } from '../../register.js';

register({
  tech: 'postmark',
  name: 'Postmark',
  type: 'saas',
  dependencies: [
    { type: 'npm', name: 'postmark' },
    { type: 'npm', name: 'postman-cli' },
    { type: 'ruby', name: 'postmark-rails' },
    { type: 'ruby', name: 'postmark' },
    { type: 'php', name: 'wildbit/postmark-php' },
  ],
});


--- src/rules/saas/prismacloud.ts ---

import { register } from '../../register.js';

register({
  tech: 'prismacloud',
  name: 'Prisma Cloud',
  type: 'saas',
  dependencies: [
    {
      type: 'terraform',
      name: 'registry.terraform.io/PaloAltoNetworks/prismacloud',
    },
  ],
});


--- src/rules/saas/sap.ts ---

import { register } from '../../register.js';

register({
  tech: 'sap',
  name: 'SAP',
  type: 'saas',
  dependencies: [{ type: 'npm', name: '@sap/hana-client' }],
});


--- src/rules/saas/sas.ts ---

import { register } from '../../register.js';

register({
  tech: 'sas',
  name: 'SAS',
  type: 'saas',
  dependencies: [{ type: 'python', name: 'sasviya' }],
});


--- src/rules/saas/servicenow.ts ---

import { register } from '../../register.js';

register({
  tech: 'servicenow',
  name: 'ServiceNow',
  type: 'saas',
  dependencies: [{ type: 'ruby', name: 'servicenow-api' }],
});


--- src/rules/saas/splitio.ts ---

import { register } from '../../register.js';

register({
  tech: 'splitio',
  name: 'Split',
  type: 'saas',
  dependencies: [
    {
      type: 'npm',
      name: /^@splitsoftware\//,
      example: '@splitsoftware/splitio',
    },
    { type: 'golang', name: 'github.com/splitio/go-client/v6' },
    { type: 'ruby', name: 'splitclient-rb' },
  ],
});


--- src/rules/saas/splunk.ts ---

import { register } from '../../register.js';

register({
  tech: 'splunk',
  name: 'Splunk',
  type: 'saas',
  dotenv: ['SPLUNK_'],
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/splunk/splunk' },
    { type: 'terraform', name: 'registry.terraform.io/splunk/splunkconfig' },
  ],
});


--- src/rules/saas/spotify.ts ---

import { register } from '../../register.js';

register({
  tech: 'spotify',
  name: 'Spotify',
  type: 'saas',
  dotenv: ['SPOTIFY_'],
  dependencies: [{ type: 'npm', name: 'spotify-web-api-node' }],
});


--- src/rules/saas/tailscale.ts ---

import { register } from '../../register.js';

register({
  tech: 'tailscale',
  name: 'Tailscale',
  type: 'saas',
  dependencies: [
    { type: 'githubAction', name: 'tailscale/github-action' },
    { type: 'githubAction', name: 'tailscale/gitops-acl-action' },
    { type: 'npm', name: '@pulumi/tailscale' },
  ],
});


--- src/rules/saas/veriff.ts ---

import { register } from '../../register.js';

register({
  tech: 'veriff',
  name: 'Veriff',
  type: 'saas',
  dependencies: [
    { type: 'npm', name: '@veriff/js-sdk' },
    { type: 'npm', name: '@veriff/incontext-sdk' },
    { type: 'ruby', name: 'veriff' },
  ],
});


--- src/rules/saas/vialink.ts ---

import { register } from '../../register.js';

register({
  tech: 'vialink',
  name: 'Vialink',
  type: 'saas',
});


--- src/rules/saas/withorb.ts ---

import { register } from '../../register.js';

register({
  tech: 'withorb',
  name: 'Orb',
  type: 'saas',
  dependencies: [
    { type: 'python', name: 'orb-billing' },
    { type: 'npm', name: 'orb-billing' },
    { type: 'golang', name: 'github.com/orbcorp/orb-go' },
  ],
});


--- src/rules/saas/wolframalpha.ts ---

import { register } from '../../register.js';

register({
  tech: 'wolframalpha',
  name: 'Wolfram Alpha',
  type: 'saas',
  dotenv: ['WOLFRAM_'],
  dependencies: [{ type: 'python', name: 'wolframalpha' }],
});


--- src/rules/saas/yousign.ts ---

import { register } from '../../register.js';

register({
  tech: 'yousign',
  name: 'Yousign',
  type: 'saas',
  dependencies: [{ type: 'php', name: 'androk/yousign-api' }],
});


--- src/rules/security/aws.kms.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.kms',
  name: 'AWS Kms',
  type: 'security',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-kms' },
    { type: 'npm', name: '@aws-cdk/aws-kms' },
    { type: 'rust', name: 'aws-sdk-kms' },
    { type: 'ruby', name: 'aws-sdk-kms' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/kms' },
    {
      type: 'terraform.resource',
      name: /^aws_kms_/,
      example: 'aws_kms_alias',
    },
  ],
});


--- src/rules/security/checkov.ts ---

import { register } from '../../register.js';

register({
  tech: 'checkov',
  name: 'Checkov',
  type: 'security',
  dependencies: [
    { type: 'githubAction', name: 'bridgecrewio/checkov-action' },
    { type: 'docker', name: 'bridgecrew/checkov' },
  ],
});


--- src/rules/security/datadome.ts ---

import { register } from '../../register.js';

register({
  tech: 'datadome',
  name: 'DataDome',
  type: 'security',
  dependencies: [
    { type: 'npm', name: '@datadome/fraud-sdk-node' },
    { type: 'npm', name: '@datadome/node-module' },
    { type: 'npm', name: '@datadome/react-native-datadome' },
    { type: 'npm', name: '@datadome/datadome-react-native-navigation' },
    { type: 'python', name: 'datadome-fraud-sdk-python' },
    { type: 'php', name: 'datadome/fraud-sdk-symfony' },
    { type: 'php', name: 'datadome/fraud-sdk-laravel' },
    { type: 'ruby', name: 'datadome_fraud_sdk_ruby' },
    { type: 'golang', name: 'github.com/datadome/fraud-sdk-go-package' },
    { type: 'php', name: 'DataDomeServiceProvider' },
  ],
});


--- src/rules/security/gcp.kms.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.kms',
  name: 'Cloud KMS',
  type: 'security',
  dependencies: [
    { type: 'npm', name: '@google-cloud/kms' },
    {
      type: 'terraform.resource',
      name: /^google_kms_/,
      example: 'google_kms_crypto_key',
    },
    {
      type: 'ruby',
      name: /^google-cloud-kms/,
      example: 'google-cloud-kms-v1',
    },
    { type: 'golang', name: 'cloud.google.com/go/kms' },
    { type: 'php', name: 'google/cloud-kms' },
  ],
});


--- src/rules/security/gitguardian.ts ---

import { register } from '../../register.js';

register({
  tech: 'gitguardian',
  name: 'GitGuardian',
  type: 'security',
  dependencies: [
    { type: 'githubAction', name: 'GitGuardian/ggshield-action' },
    { type: 'golang', name: 'github.com/Gaardsholt/go-gitguardian' },
    { type: 'docker', name: 'gitguardian/ggshield' },
  ],
});


--- src/rules/security/index.ts ---

import './aws.kms.js';
import './checkov.js';
import './datadome.js';
import './gcp.kms.js';
import './gitguardian.js';
import './infisical.js';
import './snyk.js';
import './sqreen.js';
import './wiz.js';


--- src/rules/security/infisical.ts ---

import { register } from '../../register.js';

register({
  tech: 'infisical',
  name: 'Infisical',
  type: 'security',
  files: ['.infisical.json'],
  dotenv: ['INFISICAL_'],
  dependencies: [
    { type: 'npm', name: 'infisical' },
    { type: 'docker', name: 'infisical/infisical' },
  ],
});


--- src/rules/security/snyk.ts ---

import { register } from '../../register.js';

register({
  tech: 'snyk',
  name: 'Snyk',
  type: 'security',
  files: ['.snyk'],
  dotenv: ['SNYK_'],
  dependencies: [
    { type: 'npm', name: 'snyk' },
    {
      type: 'terraform',
      name: 'registry.terraform.io/snyk-terraform-assets/snyk',
    },
    {
      type: 'githubAction',
      name: /^snyk\/actions\//,
      example: 'snyk/actions/php',
    },
    { type: 'docker', name: 'snyk/snyk-cli' },
    { type: 'docker', name: 'snyk/broker' },
    { type: 'docker', name: 'snyk/kubernetes-monitor' },
    { type: 'docker', name: 'snyk/kubernetes-operator' },
    { type: 'docker', name: 'snyk/code-agent' },
    { type: 'docker', name: 'snyk/driftctl' },
  ],
});


--- src/rules/security/sqreen.ts ---

import { register } from '../../register.js';

register({
  tech: 'sqreen',
  name: 'Sqreen',
  type: 'security',
  dotenv: ['SQREEN_'],
  dependencies: [
    { type: 'npm', name: 'sqreen' },
    { type: 'ruby', name: 'sqreen' },
  ],
});


--- src/rules/security/wiz.ts ---

import { register } from '../../register.js';

register({
  tech: 'wiz',
  name: 'Wiz',
  type: 'security',
  dotenv: ['WIZ_'],
  dependencies: [{ type: 'terraform', name: 'registry.terraform.io/AxtonGrams/wiz' }],
});


--- src/rules/spec/deno/index.ts ---

import { detectDenoLockfile } from './lockfile.js';
import { register } from '../../../register.js';

register({
  tech: 'deno',
  name: 'Deno',
  type: 'runtime',
  files: ['deno.jsonc', 'deno.json', 'deno.lock'],
  dependencies: [
    { type: 'docker', name: /denoland\/deno/, example: 'denoland/deno:0.0.0' },
    { type: 'githubAction', name: 'denoland/setup-deno' },
  ],
  detect: detectDenoLockfile,
});


--- src/rules/spec/deno/lockfile.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';
import '../../../autoload.js';

describe('deno', () => {
  it('should match everything', async () => {
    const dependencies: Record<string, string> = {};
    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'deno') {
        continue;
      }
      dependencies['example' in item.ref ? item.ref.example : item.ref.name] =
        '60cb4ec8bd335bf241ef785ccec51e809d576ff8e8d29da43d2273b69ce2a6ff';
    }
    const lockfile = {
      version: '2',
      remote: dependencies,
    };

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['deno.lock'],
        },
        files: {
          '/deno.lock': JSON.stringify(lockfile),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });
});


--- src/rules/spec/deno/lockfile.ts ---

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';

import type { Analyser } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

const FILES = new Set(['deno.lock']);

interface Lockfile {
  version: string;
  remote?: Record<string, string>;
}

export const detectDenoLockfile: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (!FILES.has(file.name)) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let json: Lockfile;
    try {
      json = JSON.parse(content) as Lockfile;
    } catch (err) {
      l.warn('Failed to parse deno.lock', file.fp, err);
      continue;
    }

    if (!json.version) {
      continue;
    }

    const deps = {
      ...json.remote,
    };

    const techs = matchDependencies(Object.keys(deps), 'deno');
    const depsFlatten: Analyser['dependencies'] = Object.entries(deps).map((dep) => {
      return ['deno', dep[0], dep[1]];
    });

    const pl = new Payload({
      name: 'virtual',
      folderPath: file.fp,
      dependencies: depsFlatten,
    });
    pl.addTechs(techs);

    return pl;
  }

  return false;
};


--- src/rules/spec/docker/component.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';
import '../../../autoload.js';

const dockerCompose: string[] = [
  `version: '3'
services:`,
];
for (const item of rawList) {
  if (item.type !== 'dependency' || item.ref.type !== 'docker') {
    continue;
  }

  const example = 'example' in item.ref ? item.ref.example : `${item.ref.name}:0.0.0`;
  const [name] = example.split(':');
  dockerCompose.push(`
  ${name}:
    image: ${example}
`);
}

describe('docker', () => {
  it('should match everything', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['docker-compose.yml'],
        },
        files: {
          '/docker-compose.yml': dockerCompose.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it.each(['docker-compose.dev.yml', 'docker-compose-prod.yml', 'docker-compose.yaml'])(
    'should match: %s',
    async (filename) => {
      const res = await analyser({
        provider: new FakeProvider({
          paths: {
            '/': [filename],
          },
          files: {
            [`/${filename}`]: dockerCompose.join(''),
          },
        }),
      });

      expect([...flatten(res, { merge: true }).techs].length).toBeGreaterThan(0);
    }
  );

  it('should ignore file', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['docker-compose.yml.example'],
        },
        files: {
          '/docker-compose.yml.example': dockerCompose.join(''),
        },
      }),
    });

    expect([...flatten(res, { merge: true }).techs].sort()).toStrictEqual([]);
  });

  it('should not extract variables', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['docker-compose.yml'],
        },
        files: {
          '/docker-compose.yml': `version: '3'
services:
  boots:
    image: $BOOTS_IMAGE`,
        },
      }),
    });

    expect([...flatten(res, { merge: true }).dependencies].sort()).toStrictEqual([]);
  });

  it('should not match component without image', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['docker-compose.yml'],
        },
        files: {
          '/docker-compose.yml': `version: '3'
services:
  boots:
    build: .`,
        },
      }),
    });

    expect([...flatten(res, { merge: true }).dependencies].sort()).toStrictEqual([]);
  });
});


--- src/rules/spec/docker/component.ts ---

import { parse } from 'yaml';

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';

import type { ComponentMatcher } from '../../../types/rule.js';
import type { AllowedKeys } from '../../../types/techs.js';

const FILES_REG = /^docker-compose(.*)?\.y(a)?ml$/;

interface DockerCompose {
  services: Record<string, DockerComposeService>;
}
interface DockerComposeService {
  image?: string;
  container_name?: string;
}

export const detectDockerComponent: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (!FILES_REG.test(file.name)) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let parsed: DockerCompose;
    try {
      parsed = parse(content, {}) as DockerCompose;
      if (!('services' in parsed)) {
        l.warn('Failed to parse Docker file', file.fp);
        continue;
      }
    } catch (err) {
      l.warn('Failed to parse', file.fp, err);
      continue;
    }

    const pl = new Payload({ name: 'virtual', folderPath: file.fp });

    for (const [name, service] of Object.entries<DockerComposeService>(parsed.services)) {
      if (!service.image) {
        continue;
      }

      // If we don't match, it's fine because docker is mostly made for services
      // It's better to have few false positive, than a lot of missing components
      const [imageName, imageVersion] = service.image.split(':');
      const matched = [...matchDependencies([imageName], 'docker').entries()];
      if (imageName.startsWith('$')) {
        continue;
      }

      const tech = matched[0] as unknown as [AllowedKeys, string[]] | undefined;
      pl.addChild(
        new Payload({
          name: service.container_name || name,
          folderPath: file.fp,
          tech: tech ? tech[0] : null,
          parent: pl,
          dependencies: [['docker', imageName, imageVersion || 'latest']],
          reason: tech ? tech[1] : `matched: ${imageName}`,
        })
      );
    }

    return pl;
  }

  return false;
};


--- src/rules/spec/docker/index.ts ---

import { detectDockerComponent } from './component.js';
import { register } from '../../../register.js';

register({
  tech: 'docker',
  name: 'Docker',
  type: 'tool',
  files: ['.dockerignore', 'Dockerfile', 'docker-compose.yml', 'docker-compose.yaml'],
  detect: detectDockerComponent,
  dependencies: [
    { type: 'githubAction', name: 'docker/login-action' },
    { type: 'npm', name: '@pulumi/docker' },
  ],
});


--- src/rules/spec/dotenv/index.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';

import '../../../autoload.js';

describe('dotenv', () => {
  it('should match all dependencies', async () => {
    const env: string[] = [];
    for (const item of rawList) {
      if (item.type !== 'dotenv' || !('dotenv' in item.ref)) {
        continue;
      }

      env.push(`${item.ref.dotenv.map((v) => `${v}KEY=example`).join('\r\n')}`);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['.env.example'],
        },
        files: {
          '/.env.example': env.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });
});


--- src/rules/spec/dotenv/index.ts ---

import { rulesDotEnv } from '../../../loader.js';
import { Payload } from '../../../payload/index.js';

import type { BaseProvider, ProviderFile } from '../../../provider/base.js';

const DOTENV = '.env.example';

export const detectInDotEnv = async (
  files: ProviderFile[],
  provider: BaseProvider
): Promise<false | Payload> => {
  for (const file of files) {
    if (file.name !== DOTENV) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    const pl = new Payload({ name: 'virtual', folderPath: file.fp });

    for (const rule of rulesDotEnv) {
      const matched = rule(content);
      if (matched !== false) {
        pl.addTech(matched[0].tech, [`${matched[0].tech} matched env: ${matched[1]}`]);
      }
    }

    return pl;
  }

  return false;
};


--- src/rules/spec/dotenv/matcher.ts ---

import { listIndexed } from '../../../register.js';

import type { Rule } from '../../../types/rule';
import type { AllowedKeys } from '../../../types/techs';

export function matchDotEnv({
  key,
  list,
  content,
}: {
  key: AllowedKeys;
  list: string[];
  content: string;
}): [Rule, string] | false {
  for (const pattern of list) {
    if (content.includes(pattern)) {
      return [listIndexed[key], pattern];
    }
  }

  return false;
}


--- src/rules/spec/githubActions/component.test.ts ---

import { describe, expect, it } from 'vitest';

import { detectGithubActionsComponent } from './component.js';
import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';

import '../../../autoload.js';

describe('githubActions', () => {
  it('should match all dependencies', async () => {
    const yml: string[] = [
      `name: Main
on:
  push:
    branches: [ main ]

jobs:
  ci:
    container: node:18.17.1
    runs-on: ubuntu-latest
    timeout-minutes: 15
    services:
      postgres:
        env:
          POSTGRES_PASSWORD: postgres
        image: postgres
        options: >-
          --health-cmd pg_isready
          --health-interval 10s

    env:
      OPENAI_KEY: ""

    steps:
      - name: Check out repository code
        run: npm test`,
    ];
    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'githubAction') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : `${item.ref.name}@1`;
      const [name] = example.split('@');
      yml.push(`
      - name: ${name}
        uses: ${example}
    `);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['.github/'],
          '/.github': ['workflows/'],
          '/.github/workflows': ['main.yml'],
        },
        files: {
          '/.github/workflows/main.yml': yml.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it('should gracefully fail to parse', async () => {
    const res = await detectGithubActionsComponent(
      [{ fp: '/.github/workflows/main.yml', name: 'main.yml', type: 'file' }],
      new FakeProvider({
        paths: {
          '/': ['.github/'],
          '/.github': ['workflows/'],
          '/.github/workflows': ['main.yml'],
        },
        files: {
          '/.github/workflows/main.yml': '',
        },
      })
    );

    expect(res).toBe(false);
  });
});


--- src/rules/spec/githubActions/component.ts ---

import { parse } from 'yaml';

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';

import type { Dependency } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

export const FILE_REG = /.github\/workflows\/.+\.y(a)?ml/;

interface Step {
  name?: string;
  uses?: string; // Interesting
  run?: string;
  with?: Record<string, string>;
}

interface GitHubActionsFile {
  name?: string;
  on?: Record<string, unknown>;
  jobs?: Record<
    string,
    {
      container?: { image: string; options?: string } | string; // interesting
      'runs-on': string;
      'timeout-minutes': number;
      env?: Record<string, string>;
      services?: Record<
        string,
        {
          image?: string; // interesting
        }
      >;
      steps?: Step[];
    }
  >;
}

export const detectGithubActionsComponent: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (!FILE_REG.test(file.fp)) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let parsed: GitHubActionsFile;
    try {
      parsed = parse(content, {}) as GitHubActionsFile;
      if (!parsed.jobs) {
        l.warn('No jobs in GitHub Actions', file.fp);
        continue;
      }
    } catch (err) {
      l.warn('Failed to parse', file.fp, err);
      continue;
    }

    const pl = new Payload({ name: 'virtual', folderPath: file.fp });

    const dependencies: Dependency[] = [];
    for (const [, config] of Object.entries(parsed.jobs)) {
      if (config.steps) {
        for (const step of config.steps) {
          if (!step.uses) {
            continue;
          }

          const [name, version] = step.uses.split('@');
          dependencies.push(['githubAction', name, version || 'latest']);
          const matched = matchDependencies([name], 'githubAction');
          if (matched.size > 0) {
            pl.addTechs(matched);
          }
        }
      }

      if (config.container !== undefined) {
        const [imageName, imageVersion] =
          typeof config.container === 'string'
            ? config.container.split(':')
            : config.container.image;
        dependencies.push(['docker', imageName, imageVersion || 'latest']);
        const matched = matchDependencies([imageName], 'docker');
        if (matched.size > 0) {
          pl.addTechs(matched);
        }
      }

      if (config.services) {
        for (const [, service] of Object.entries(config.services)) {
          if (!service.image) {
            continue;
          }

          const [imageName, imageVersion] = service.image.split(':');
          dependencies.push(['docker', imageName, imageVersion || 'latest']);
          const matched = matchDependencies([imageName], 'docker');
          if (matched.size > 0) {
            pl.addTechs(matched);
          }
        }
      }
    }

    pl.dependencies = [...dependencies];
    return pl;
  }

  return false;
};


--- src/rules/spec/githubActions/index.ts ---

import { FILE_REG, detectGithubActionsComponent } from './component.js';
import { register } from '../../../register.js';

register({
  tech: 'github.actions',
  name: 'Github Actions',
  type: 'ci',
  matchFullPath: true,
  files: FILE_REG,
  example: '.github/workflows/ci.yml',
  detect: detectGithubActionsComponent,
});


--- src/rules/spec/golang/component.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';
import { cleanNestedSnapshot } from '../../../tests/helpers.js';
import '../../../autoload.js';

describe('golang', () => {
  it('should match a service', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['cmd/', 'go.mod'],
          '/cmd': ['server/'],
          '/cmd/server': ['main.go'],
        },
        files: {
          '/go.mod': `module github.com/specfy/specfy`,
          '/cmd/main.go': `hello world`,
        },
      }),
    });

    expect(cleanNestedSnapshot(flatten(res).toJson())).toMatchSnapshot();
  });
});


--- src/rules/spec/golang/component.ts ---

import path from 'node:path';

import { Payload } from '../../../payload/index.js';

import type { ComponentMatcher } from '../../../types/rule.js';

const FILES_REG = /^main.go$/;

export const detectGolangComponent: ComponentMatcher = (files) => {
  for (const file of files) {
    if (!FILES_REG.test(file.name)) {
      continue;
    }

    const folderName = path.basename(path.dirname(file.fp));
    const pl = new Payload({
      name: folderName,
      folderPath: file.fp,
      tech: 'golang',
    });

    return pl;
  }

  return false;
};


--- src/rules/spec/golang/index.ts ---

import { detectGolangComponent } from './component.js';
import { detectGolangLockfile } from './lockfile.js';
import { register } from '../../../register.js';

register({
  tech: 'golang',
  name: 'Golang',
  type: 'language',
  files: ['go.mod', 'main.go'],
  extensions: ['.go'],
  detect: [detectGolangLockfile, detectGolangComponent],
  dependencies: [
    { type: 'docker', name: 'golang' },
    { type: 'docker', name: 'circleci/golang' },
    { type: 'docker', name: 'bitnami/golang' },
  ],
});


--- src/rules/spec/golang/lockfile.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';
import '../../../autoload.js';

describe('golang (lockfile)', () => {
  it('should match everything', async () => {
    const deps = [];
    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'golang') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : item.ref.name;
      deps.push(`	${example} v1.0.0`);
    }
    const lockfile: string[] = [
      `module github.com/specfy/specfy

go 1.19
require (
${deps.join('\n')}
)`,
    ];

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['go.mod'],
        },
        files: {
          '/go.mod': lockfile.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });
});


--- src/rules/spec/golang/lockfile.ts ---

import path from 'node:path';

import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';

import type { Dependency } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

const LOCKFILE = 'go.mod';
const lineReg = /[\t](.+)\sv(.+)/;

export const detectGolangLockfile: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (file.name !== LOCKFILE) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    const pl = new Payload({
      name: 'virtual',
      folderPath: path.dirname(file.fp),
    });

    const dependencies: Dependency[] = [];
    // We only register docker service with image and that we know
    for (const line of content.split(/\r?\n/)) {
      if (!lineReg.test(line)) {
        continue;
      }

      const [url, version, comment, ...rest] = line.slice(1).split(' ');
      if (rest.length > 0 || comment) {
        // Skip false positive and '// indirect'
        continue;
      }

      dependencies.push(['golang', url, version || 'latest']);
      const matched = matchDependencies([url], 'golang');
      if (matched.size <= 0) {
        continue;
      }

      pl.addTechs(matched);
    }

    pl.dependencies = [...dependencies];

    return pl;
  }

  return false;
};


--- src/rules/spec/index.ts ---

import './deno/index.js';
import './docker/index.js';
import './githubActions/index.js';
import './golang/index.js';
import './nodejs/index.js';
import './php/index.js';
import './python/index.js';
import './ruby/index.js';
import './rust/index.js';
import './terraform/index.js';
import './zig/index.js';


--- src/rules/spec/licenses/index.test.ts ---

import { describe, expect, it } from 'vitest';

import { detectLicense } from '.';

describe('detectLicense', () => {
  it('should detect a single license', () => {
    const license = detectLicense('MIT');

    expect(license).toStrictEqual(new Set(['MIT']));
  });

  it('should detect handle spdx', () => {
    const license = detectLicense('(LGPL-2.1 OR BSD-3-Clause AND MIT)');

    expect(license).toStrictEqual(new Set(['LGPL-2.1', 'BSD-3-Clause', 'MIT']));
  });

  it('should not match exotic', () => {
    const license = detectLicense('MYLICENSE');

    expect(license).toStrictEqual(false);
  });

  it('should not match exotic and correct', () => {
    const license = detectLicense('MIT OR LICENSE');

    expect(license).toStrictEqual(false);
  });
});


--- src/rules/spec/licenses/index.ts ---

import parse from 'spdx-expression-parse';

import type { AllowedLicenses } from '../../../types/licenses';

export function detectLicense(name: string): false | Set<AllowedLicenses> {
  try {
    const set = new Set<AllowedLicenses>();
    const parsed = parse(name);
    licenseOrConjunction(parsed, set);
    return set;
  } catch {
    return false;
  }
}

function licenseOrConjunction(info: parse.Info, set: Set<AllowedLicenses>): void {
  if ('license' in info) {
    set.add(info.license as AllowedLicenses);
    return;
  }

  licenseOrConjunction(info.left, set);
  licenseOrConjunction(info.right, set);
}


--- src/rules/spec/nodejs/component.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';

import type { AllowedKeys } from '../../../index.js';
import '../../../autoload.js';

describe('npm', () => {
  it('should match everything', async () => {
    const dependencies: Record<string, string> = {};
    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'npm') {
        continue;
      }
      dependencies['example' in item.ref ? item.ref.example : item.ref.name] = '0.0.0';
    }
    const packageJson = {
      name: 'test',
      dependencies,
    };

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['package.json'],
        },
        files: {
          '/package.json': JSON.stringify(packageJson),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it('should match nothing', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['package.json'],
        },
        files: {
          '/package.json': JSON.stringify({ foo: 'bar' }),
        },
      }),
    });
    const match: AllowedKeys[] = ['nodejs'];

    expect([...flatten(res, { merge: true }).techs].sort()).toStrictEqual(match);
  });

  it('should match license', async () => {
    const packageJson = {
      name: 'test',
      license: 'MIT',
    };

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['package.json'],
        },
        files: {
          '/package.json': JSON.stringify(packageJson),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.licenses.values()]).toStrictEqual(['MIT']);
  });
});


--- src/rules/spec/nodejs/component.ts ---

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';
import { detectLicense } from '../licenses/index.js';

import type { Analyser } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';
import type { FullVersion } from 'package-json';

const FILES = new Set(['package.json']);

export const detectNodeComponent: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (!FILES.has(file.name)) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let json: FullVersion;
    try {
      json = JSON.parse(content) as FullVersion;
    } catch (err) {
      l.warn('Failed to parse package.json', file.fp, err);
      continue;
    }

    if (!json.name) {
      continue;
    }

    const deps = {
      ...json.dependencies,
      ...json.devDependencies,
    };
    const techs = matchDependencies(Object.keys(deps), 'npm');
    const depsFlatten: Analyser['dependencies'] = Object.entries(deps).map(
      (dep: [string, string | undefined]) => {
        return ['npm', dep[0], dep[1] ?? ''];
      }
    );

    const pl = new Payload({
      name: json.name,
      folderPath: file.fp,
      dependencies: depsFlatten,
    });
    pl.addTechs(techs);

    if (json.license && typeof json.license === 'string') {
      const lic = detectLicense(json.license);
      if (lic !== false) {
        pl.addLicenses(lic);
      }
    }

    return pl;
  }

  return false;
};


--- src/rules/spec/nodejs/index.ts ---

import { detectNodeComponent } from './component.js';
import { register } from '../../../register.js';

register({
  tech: 'nodejs',
  name: 'NodeJS',
  type: 'runtime',
  files: ['package.json'],
  dependencies: [
    { type: 'docker', name: /nodejs/, example: 'nodejs:0.0.0' },
    { type: 'docker', name: 'node' },
    { type: 'docker', name: 'circleci/node' },
    { type: 'docker', name: 'cimg/node' },
    { type: 'docker', name: 'bitnami/node' },
    { type: 'docker', name: 'okteto/node' },
  ],
  detect: detectNodeComponent,
});


--- src/rules/spec/php/component.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';

import '../../../autoload.js';

import type { ComposerJson } from './component.js';
import type { AllowedKeys } from '../../../index.js';

describe('php', () => {
  it('should match everything', async () => {
    const dependencies: Record<string, string> = {};
    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'php') {
        continue;
      }
      dependencies['example' in item.ref ? item.ref.example : item.ref.name] = '0.0.0';
    }
    const composerJson: ComposerJson = {
      name: 'test',
      'require-dev': dependencies,
    };

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['composer.json'],
        },
        files: {
          '/composer.json': JSON.stringify(composerJson),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it('should match nothing', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['composer.json'],
        },
        files: {
          '/composer.json': JSON.stringify({ foo: 'bar' }),
        },
      }),
    });
    const match: AllowedKeys[] = ['php'];

    expect([...flatten(res, { merge: true }).techs].sort()).toStrictEqual(match);
  });

  it('should match license', async () => {
    const composerJson: ComposerJson = {
      name: 'test',
      license: 'MIT',
    };

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['composer.json'],
        },
        files: {
          '/composer.json': JSON.stringify(composerJson),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.licenses.values()]).toStrictEqual(['MIT']);
  });
});


--- src/rules/spec/php/component.ts ---

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';
import { detectLicense } from '../licenses/index.js';

import type { Analyser } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

const FILES = new Set(['composer.json']);

export interface ComposerJson {
  name: string;
  license?: string;
  require?: Record<string, string>;
  'require-dev'?: Record<string, string>;
}

export const detectPhpComponent: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (!FILES.has(file.name)) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let json: ComposerJson;
    try {
      json = JSON.parse(content) as ComposerJson;
    } catch (err) {
      l.warn('Failed to parse composer.json', file.fp, err);
      continue;
    }

    if (!json.name) {
      continue;
    }

    const deps = {
      ...json.require,
      ...json['require-dev'],
    };
    const techs = matchDependencies(Object.keys(deps), 'php');
    const depsFlatten: Analyser['dependencies'] = Object.entries(deps).map(
      (dep: [string, string]) => {
        return ['php', dep[0], dep[1]];
      }
    );

    const pl = new Payload({
      name: json.name,
      folderPath: file.fp,
      dependencies: depsFlatten,
    });
    pl.addTech('phpcomposer', ['matched file: composer.json']);
    pl.addTechs(techs);

    if (json.license) {
      const lic = detectLicense(json.license);
      if (lic !== false) {
        pl.addLicenses(lic);
      }
    }

    return pl;
  }

  return false;
};


--- src/rules/spec/php/index.ts ---

import { detectPhpComponent } from './component.js';
import { register } from '../../../register.js';

register({
  tech: 'php',
  name: 'PHP',
  type: 'language',
  files: ['composer.json', 'composer.lock'],
  extensions: ['.php', '.php3', '.php4', '.php5'],
  detect: detectPhpComponent,
  dependencies: [
    { type: 'docker', name: 'php' },
    { type: 'docker', name: 'circleci/php' },
    { type: 'docker', name: 'cimg/php' },
    { type: 'docker', name: 'bitnami/php' },
    { type: 'docker', name: 'bitnami/php-fpm' },
    { type: 'docker', name: 'okteto/php' },
    { type: 'docker', name: 'composer' },
    { type: 'docker', name: 'php-zendserver' },
    { type: 'docker', name: 'webdevops/php-apache' },
    { type: 'docker', name: 'webdevops/php-nginx' },
    { type: 'githubAction', name: 'shivammathur/setup-php' },
    { type: 'githubAction', name: 'ramsey/composer-install' },
  ],
});


--- src/rules/spec/python/index.ts ---

import { detectPythonLockfile } from './lockfile.js';
import { register } from '../../../register.js';

register({
  tech: 'python',
  name: 'Python',
  type: 'language',
  files: ['requirements.txt'],
  extensions: ['.py', '.gyp', '.py3', '.pyde', '.pyi', '.pyp', '.pyt', '.pyw', '.rpy'],
  dependencies: [
    { type: 'githubAction', name: 'actions/setup-python' },
    { type: 'docker', name: 'python' },
    { type: 'docker', name: 'circleci/python' },
    { type: 'docker', name: 'cimg/python' },
    { type: 'docker', name: 'bitnami/python' },
  ],
  detect: [detectPythonLockfile],
});


--- src/rules/spec/python/lockfile.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';

import '../../../autoload.js';

describe('python lockfile: requirements.txt', () => {
  it('should match everything', async () => {
    const deps = [];
    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'python') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : item.ref.name;
      deps.push(`${example}==1.0.0`);
    }

    const lockfile: string = deps.join('\n');

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['requirements.txt'],
        },
        files: {
          '/requirements.txt': lockfile,
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it('should match weird syntax', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['requirements.txt'],
        },
        files: {
          '/requirements.txt': [
            // No version
            'tensorflow',
            // gte
            'algoliasearch>=1.9.1',
            // gte-lt
            'datadog>=1.4.3,<7.0.0',
          ].join('\n'),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });
});

describe('python lockfile: pyproject.toml', () => {
  it('should match everything', async () => {
    const deps = [];
    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'python') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : item.ref.name;
      deps.push(`"${example}==1.0.0"`);
    }

    const lockfile = `[project]
name = "test"
description = "This is a test"

dependencies = [
${deps.join(',\r\n')}
]

[project.optional-dependencies]
memory = [
    "sentence-transformers>=4.0.2",
]

[tool.ruff]
line-length = 130
`;

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['pyproject.toml'],
        },
        files: {
          '/pyproject.toml': lockfile,
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it('should match license', async () => {
    const lockfile = `[project]
name = "test"
license = "ISC"
`;

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['pyproject.toml'],
        },
        files: {
          '/pyproject.toml': lockfile,
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.licenses.values()]).toStrictEqual(['ISC']);
  });
});


--- src/rules/spec/python/lockfile.ts ---

import path from 'node:path';

import toml from '@iarna/toml';

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';
import { detectLicense } from '../licenses/index.js';

import type { ProviderFile } from '../../../provider/base.js';
import type { Dependency } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

const LOCKFILE = 'requirements.txt';
const PROJECT = 'pyproject.toml';
const lineReg = /(^([a-zA-Z0-9._-]+)$|^([a-zA-Z0-9._-]+)(([>=]+)([0-9.]+)))/;

interface Pyproject {
  project?: {
    license?: { file?: string; text?: string } | string;
    dependencies?: string[];
  };
}

export const detectPythonLockfile: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (file.name === PROJECT) {
      const content = await provider.open(file.fp);
      if (!content) {
        continue;
      }

      const pl = new Payload({
        name: 'virtual',
        folderPath: path.dirname(file.fp),
      });
      const res = parsePyproject({ content, pl, file });
      if (!res) {
        continue;
      }

      return pl;
    } else if (file.name === LOCKFILE) {
      const content = await provider.open(file.fp);
      if (!content) {
        continue;
      }

      const pl = new Payload({
        name: 'virtual',
        folderPath: path.dirname(file.fp),
      });
      parseRequirementsTxt(content, pl);

      return pl;
    } else {
      continue;
    }
  }

  return false;
};

export function parseRequirementsTxt(content: string, pl: Payload): void {
  const dependencies: Dependency[] = [];

  for (const line of content.split(/\r?\n/)) {
    if (line.startsWith('#')) {
      continue;
    }

    const match = line.match(lineReg);
    if (!match) {
      continue;
    }

    const name = match[2] || match[3];
    const version = match[6] || 'latest';

    if (!name) {
      continue;
    }

    dependencies.push(['python', name, version || 'latest']);
    const matched = matchDependencies([name], 'python');
    if (matched.size <= 0) {
      continue;
    }

    pl.addTechs(matched);
  }

  pl.dependencies = [...dependencies];
}

export function parsePyproject({
  content,
  pl,
  file,
}: {
  content: string;
  pl: Payload;
  file: ProviderFile;
}): boolean {
  let json: Pyproject;
  try {
    json = toml.parse(content) as unknown as Pyproject;
  } catch (err) {
    l.warn('Failed to parse pyproject.toml', file.fp, err);
    return false;
  }

  if (!('project' in json) || !json.project) {
    return false;
  }

  const prj = json.project;
  if ('license' in prj) {
    const tmp = typeof prj.license === 'string' ? prj.license : prj.license?.text;
    if (tmp) {
      const lic = detectLicense(tmp);
      if (lic !== false) {
        pl.addLicenses(lic);
      }
    }
  }

  if (prj.dependencies) {
    const dependencies: Dependency[] = [];
    for (const dep of prj.dependencies) {
      const match = dep.match(lineReg);
      if (!match) {
        continue;
      }

      const name = match[2] || match[3];
      const version = match[6] || 'latest';
      if (!name) {
        continue;
      }

      dependencies.push(['python', name, version || 'latest']);
      const matched = matchDependencies([name], 'python');
      if (matched.size <= 0) {
        continue;
      }

      pl.addTechs(matched);
    }

    pl.dependencies = [...dependencies];
  }
  return true;
}


--- src/rules/spec/ruby/index.ts ---

import { detectRubyLockfile } from './lockfile.js';
import { register } from '../../../register.js';

register({
  tech: 'ruby',
  name: 'Ruby',
  type: 'language',
  files: ['Gemfile', 'Rakefile'],
  extensions: ['.rb', '.rbx', '.ru', '.ruby'],
  dependencies: [
    { type: 'docker', name: /ruby/, example: 'ruby:0.0.0' },
    { type: 'githubAction', name: 'ruby/setup-ruby' },
  ],
  detect: detectRubyLockfile,
});


--- src/rules/spec/ruby/lockfile.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';
import '../../../autoload.js';

describe('ruby (component)', () => {
  it('should match everything', async () => {
    const lockfile: string[] = [
      `# frozen_string_literal: true

source "https://rubygems.org"
`,
    ];

    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'ruby') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : item.ref.name;
      lockfile.push(`gem "${example}", "1.0.0"\n`);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['Gemfile'],
        },
        files: {
          '/Gemfile': lockfile.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });
});


--- src/rules/spec/ruby/lockfile.ts ---

import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';

import type { Analyser } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

const FILES = new Set(['Gemfile']);

const NEW_LINE_REG = /\r?\n/;
const DEP_REG = /gem "(.+)",\s+("(.+)")?/;

export const detectRubyLockfile: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (!FILES.has(file.name)) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    const lines = content.split(NEW_LINE_REG);

    const pl = new Payload({ name: 'virtual', folderPath: file.fp });

    const deps: Record<string, string> = {};
    for (const line of lines) {
      const match = line.match(DEP_REG);
      if (!match) {
        continue;
      }

      deps[match[1]] = match[3] || 'latest';
    }

    const techs = matchDependencies(Object.keys(deps), 'ruby');
    const depsFlatten: Analyser['dependencies'] = Object.entries(deps).map(([name, value]) => {
      return ['ruby', name, value || 'latest'];
    });

    pl.addTechs(techs);
    pl.addTech('bundler', ['matched file: Gemfile']);
    pl.dependencies = depsFlatten;

    return pl;
  }

  return false;
};


--- src/rules/spec/rust/component.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';
import '../../../autoload.js';

describe('rust (component)', () => {
  it('should match everything', async () => {
    const lockfile: string[] = [
      `[package]
name = "svix-server"
version = "1.8.0"

[dependencies]
`,
    ];

    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'rust') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : item.ref.name;
      lockfile.push(`${example} = "1.0.0"\n`);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['Cargo.toml'],
        },
        files: {
          '/Cargo.toml': lockfile.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toMatchSnapshot();
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it('should match foreign dependencies', async () => {
    const lockfile: string[] = [
      `[package]
name = "svix-server"
version = "1.8.0"

[dependencies]
test = { path = "../test" }
hello = { path = "../world", version = "1.0.0" }
axum = { version = "0.6.1", features = ["headers"] }

[dev-dependencies]
anyhow = "1.0.56"
redis_cluster_async = { git = "https://github.com/redis-rs/redis-cluster-async.git", rev = "e6fe168" }

[build-dependencies]
foobar = "^1.0.0"
`,
    ];

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['Cargo.toml'],
        },
        files: {
          '/Cargo.toml': lockfile.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });

  it('should match license', async () => {
    const lockfile: string[] = [
      `[package]
name = "svix-server"
version = "1.8.0"
license = "Apache-2.0"
`,
    ];

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['Cargo.toml'],
        },
        files: {
          '/Cargo.toml': lockfile.join(''),
        },
      }),
    });

    const merged = flatten(res, { merge: true });

    expect([...merged.licenses.values()]).toStrictEqual(['Apache-2.0']);
  });
});


--- src/rules/spec/rust/component.ts ---

import toml from '@iarna/toml';

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';
import { detectLicense } from '../licenses/index.js';

import type { Analyser } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

const FILES = new Set(['Cargo.toml']);

type Dependency =
  | {
      git: string;
      rev?: string;
      branch?: string;
    }
  | {
      path: string;
      version?: string;
    }
  | {
      version?: string;
    }
  | string;
interface RustCargo {
  package?: {
    name: string;
    license?: string;
  };
  dependencies: Record<string, Dependency>;
  'dev-dependencies'?: Record<string, Dependency>;
  'build-dependencies'?: Record<string, Dependency>;
  'workspace.dependencies': Record<string, Dependency>;
}

export const detectRustComponent: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (!FILES.has(file.name)) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let json: RustCargo;
    try {
      json = toml.parse(content) as unknown as RustCargo;
    } catch (err) {
      l.warn('Failed to parse Cargo.toml', file.fp, err);
      continue;
    }

    let pl: Payload;

    if (json.package) {
      pl = new Payload({
        name: json.package.name,
        folderPath: file.fp,
      });
    } else {
      pl = new Payload({ name: 'virtual', folderPath: file.fp });
    }

    const deps: Record<string, Dependency> = {
      ...json.dependencies,
      ...json['dev-dependencies'],
      ...json['build-dependencies'],
      ...json['workspace.dependencies'],
    };
    const techs = matchDependencies(Object.keys(deps), 'rust');
    const depsFlatten: Analyser['dependencies'] = Object.entries(deps).map(([name, value]) => {
      if (typeof value === 'string') {
        return ['rust', name, value];
      }
      if ('path' in value) {
        return ['rust', name, `path:${value.path}${value.version ? `:${value.version}` : ''}`];
      }
      if ('git' in value) {
        return ['rust', name, `git:${value.git}#${value.branch || value.rev || 'latest'}`];
      }
      return ['rust', name, value.version || 'latest'];
    });

    pl.addTechs(techs);
    pl.addTech('cargo', ['matched file: Cargo.toml']);
    pl.dependencies = depsFlatten;

    if (json.package?.license) {
      const lic = detectLicense(json.package.license);
      if (lic !== false) {
        pl.addLicenses(lic);
      }
    }

    return pl;
  }

  return false;
};


--- src/rules/spec/rust/index.ts ---

import { detectRustComponent } from './component.js';
import { register } from '../../../register.js';

register({
  tech: 'rust',
  name: 'Rust',
  type: 'language',
  files: ['Cargo.toml'],
  extensions: ['.rs', '.rs.in'],
  dependencies: [
    { type: 'docker', name: 'rust' },
    { type: 'docker', name: 'cimg/rust' },
    { type: 'docker', name: 'circleci/rust' },
    { type: 'docker', name: 'rustlang/rust' },
  ],
  detect: [detectRustComponent],
});


--- src/rules/spec/terraform/index.ts ---

import { detectTerraformLockfile } from './lockfile.js';
import { detectTerraformResource } from './resource.js';
import { register } from '../../../register.js';

register({
  tech: 'terraform',
  name: 'Terraform',
  type: 'iac',
  files: ['.terraform', '.terraform.lock.hcl', 'main.tf', 'variables.tf'],
  extensions: ['.tf'],
  dependencies: [
    { type: 'githubAction', name: 'hashicorp/setup-terraform' },
    { type: 'githubAction', name: 'hashicorp/terraform-cdk-action' },
    { type: 'npm', name: 'cdktf' },
    { type: 'golang', name: 'github.com/hashicorp/terraform-plugin-sdk/v2' },
    // {type: 'python', name: 'cdktf'}
  ],
  detect: [detectTerraformLockfile, detectTerraformResource],
});


--- src/rules/spec/terraform/lockfile.test.ts ---

import '../../../autoload.js';
import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';

import type { AllowedKeys } from '../../../index.js';

describe('terraform (lockfile)', () => {
  it('should match everything', async () => {
    const lockfile: string[] = [``];

    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'terraform') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : item.ref.name;
      lockfile.push(`
      provider "${example}" {
        version = "0.0.0"
      }
    `);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['.terraform.lock.hcl'],
        },
        files: {
          '/.terraform.lock.hcl': lockfile.join(''),
        },
      }),
    });

    expect([...flatten(res, { merge: true }).techs].sort()).toMatchSnapshot();
  });

  it('should match nothing', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['.terraform.lock.hcl'],
        },
        files: {
          '/.terraform.lock.hcl': '',
        },
      }),
    });

    const match: AllowedKeys[] = ['terraform'];

    expect([...flatten(res, { merge: true }).techs].sort()).toStrictEqual(match);
  });
});


--- src/rules/spec/terraform/lockfile.ts ---

import path from 'node:path';

import { parse } from '@cdktf/hcl2json';

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';
import { listIndexed } from '../../../register.js';

import type { Dependency } from '../../../types/index.js';
import type { ComponentMatcher } from '../../../types/rule.js';

const LOCKFILE = '.terraform.lock.hcl';
interface TerraformLockfile {
  provider: Record<string, { version?: string }[]>;
}

export const detectTerraformLockfile: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (file.name !== LOCKFILE) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let json: TerraformLockfile;
    try {
      json = (await parse(file.fp, content)) as TerraformLockfile;
    } catch (err) {
      l.warn('Failed to parse HCL', file.fp, err);
      continue;
    }

    if (!('provider' in json)) {
      continue;
    }

    const pl = new Payload({
      name: 'virtual',
      folderPath: path.dirname(file.fp),
    });
    const dependencies: Dependency[] = [];

    // We only register docker service with image and that we know
    for (const name of Object.keys(json.provider)) {
      const matched = [...matchDependencies([name], 'terraform')];
      dependencies.push(['terraform', name, json.provider[name][0].version || 'latest']);

      if (matched.length === 0) {
        continue;
      }

      const tech = matched[0];

      pl.addChild(
        new Payload({
          name: listIndexed[tech[0]].name,
          folderPath: file.fp,
          tech: tech[0],
          parent: pl,
          dependencies: [['terraform', name, json.provider[name][0].version || 'latest']],
          reason: tech[1][0],
        })
      );
    }
    pl.dependencies = dependencies;

    return pl;
  }

  return false;
};


--- src/rules/spec/terraform/resource.test.ts ---

import { describe, expect, it } from 'vitest';

import { analyser } from '../../../analyser/index.js';
import { rawList } from '../../../loader.js';
import { flatten } from '../../../payload/helpers.js';
import { FakeProvider } from '../../../provider/fake.js';

import type { AllowedKeys } from '../../../index.js';
import '../../../autoload.js';

describe('terraform (resource)', () => {
  it('should match everything', async () => {
    const resource: string[] = [``];

    for (const item of rawList) {
      if (item.type !== 'dependency' || item.ref.type !== 'terraform.resource') {
        continue;
      }

      const example = 'example' in item.ref ? item.ref.example : item.ref.name;
      resource.push(`
      resource "${example}" "foobar" {
        name     = "hello"
      }
    `);
    }

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['main.tf'],
        },
        files: {
          '/main.tf': resource.join(''),
        },
      }),
    });

    expect([...flatten(res, { merge: true }).techs].sort()).toMatchSnapshot();
  });

  it('should match in tf file', async () => {
    const resource: string[] = [
      `
    resource "unknown" "foobar" {
      name     = "hello"
    }`,
    ];

    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['main.tf'],
        },
        files: {
          '/main.tf': resource.join(''),
        },
      }),
    });

    const match: AllowedKeys[] = ['terraform'];
    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toStrictEqual(match);
  });

  it('should match nothing but register dependencies', async () => {
    const res = await analyser({
      provider: new FakeProvider({
        paths: {
          '/': ['.terraform.lock.hcl'],
        },
        files: {
          '/.terraform.lock.hcl': `
          provider "helloworld" {
            version = "0.0.0"
          }
          `,
        },
      }),
    });

    const match: AllowedKeys[] = ['terraform'];
    const merged = flatten(res, { merge: true });

    expect([...merged.techs].sort()).toStrictEqual(match);
    expect([...merged.dependencies].sort()).toMatchSnapshot();
  });
});


--- src/rules/spec/terraform/resource.ts ---

import path from 'node:path';

import { parse } from '@cdktf/hcl2json';

import { l } from '../../../common/log.js';
import { matchDependencies } from '../../../matchDependencies.js';
import { Payload } from '../../../payload/index.js';
import { listIndexed } from '../../../register.js';

import type { ComponentMatcher } from '../../../types/rule.js';

const FILE = /\.tf$/;
interface TerraformResource {
  resource: { name: string };
}

export const detectTerraformResource: ComponentMatcher = async (files, provider) => {
  const pls: Payload[] = [];
  for (const file of files) {
    if (!FILE.test(file.name)) {
      continue;
    }

    const stat = await provider.stat(file.fp);
    if (!stat || stat.size > 500_000) {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let json: TerraformResource;
    try {
      json = (await parse(file.fp, content)) as TerraformResource;
    } catch (err) {
      l.warn('Failed to parse HCL', file.fp, err);
      continue;
    }

    if (!('resource' in json)) {
      continue;
    }

    const pl = new Payload({
      name: 'virtual',
      folderPath: path.dirname(file.fp),
    });

    // We only register docker service with image and that we know
    for (const name of Object.keys(json.resource)) {
      const matched = [...matchDependencies([name], 'terraform.resource')];
      if (matched.length === 0) {
        continue;
      }

      const tech = matched[0];

      pl.addChild(
        new Payload({
          name: listIndexed[tech[0]].name,
          folderPath: file.fp,
          tech: tech[0],
          parent: pl,
          dependencies: [['terraform.resource', name, 'unknown']],
          reason: tech[1][0],
        })
      );
    }

    pls.push(pl);
  }

  return pls.length > 0 ? pls : false;
};


--- src/rules/spec/zig/index.ts ---

import { register } from '../../../register.js';

register({
  tech: 'zig',
  name: 'Zig',
  type: 'language',
  extensions: ['.zig'],
  dependencies: [{ type: 'githubAction', name: 'goto-bus-stop/setup-zig' }],
});


--- src/rules/ssg/assemble.ts ---

import { register } from '../../register.js';

register({
  tech: 'assemble',
  name: 'Assemble',
  type: 'ssg',
  dependencies: [{ type: 'npm', name: 'assemble' }],
});


--- src/rules/ssg/astro.ts ---

import { register } from '../../register.js';

register({
  tech: 'astro',
  name: 'Astro',
  type: 'ssg',
  files: ['astro.config.mjs'],
  dependencies: [{ type: 'npm', name: 'astro' }],
});


--- src/rules/ssg/docsify.ts ---

import { register } from '../../register.js';

register({
  tech: 'docsify',
  name: 'Docsify',
  type: 'ssg',
  dependencies: [{ type: 'npm', name: 'docsify-cli' }],
});


--- src/rules/ssg/docusaurus.ts ---

import { register } from '../../register.js';

register({
  tech: 'docusaurus',
  name: 'Docusaurus',
  type: 'ssg',
  files: ['docusaurus.config.js'],
  dependencies: [
    { type: 'npm', name: '@docusaurus/core' },
    { type: 'npm', name: 'docusaurus' },
  ],
});


--- src/rules/ssg/eleventy.ts ---

import { register } from '../../register.js';

register({
  tech: 'eleventy',
  name: 'Eleventy',
  type: 'ssg',
  files: ['.eleventy.js', 'eleventy.config.js', 'eleventy.config.cjs'],
  dependencies: [
    { type: 'npm', name: '@11ty/eleventy' },
    { type: 'githubAction', name: 'TartanLlama/actions-eleventy' },
  ],
});


--- src/rules/ssg/fern.ts ---

import { register } from '../../register.js';

register({
  tech: 'builtwithfern',
  name: 'Fern',
  type: 'ssg',
  files: ['fern.config.json'],
});


--- src/rules/ssg/fumadocs.ts ---

import { register } from '../../register.js';

register({
  tech: 'fumadocs',
  name: 'FumaDocs',
  type: 'ssg',
  dependencies: [
    { type: 'npm', name: 'fumadocs-ui' },
    { type: 'npm', name: 'fumadocs-code' },
    { type: 'npm', name: 'fumadocs-mdx' },
  ],
});


--- src/rules/ssg/gatsby.ts ---

import { register } from '../../register.js';

register({
  tech: 'gatsby',
  name: 'Gatsby',
  type: 'ssg',
  files: ['gatsby-config.js', 'gatsby-config.ts'],
  dependencies: [
    { type: 'npm', name: 'gatsby' },
    { type: 'npm', name: 'gatsby-cli' },
    { type: 'npm', name: 'gatsby-core-utils' },
    { type: 'npm', name: '@gatsbyjs/reach-router' },
    { type: 'npm', name: '@netlify/plugin-gatsby' },
    { type: 'npm', name: '@vercel/gatsby-plugin-vercel-builder' },
    { type: 'npm', name: '@vercel/gatsby-plugin-vercel-analytics' },
    { type: 'githubAction', name: 'enriikke/gatsby-gh-pages-action' },
    { type: 'githubAction', name: 'jzweifel/gatsby-cli-github-action' },
    { type: 'githubAction', name: 'jonelantha/gatsby-s3-action' },
  ],
});


--- src/rules/ssg/gridsome.ts ---

import { register } from '../../register.js';

register({
  tech: 'gridsome',
  name: 'Gridsome',
  type: 'ssg',
  files: ['gridsome.config.js'],
  dependencies: [{ type: 'npm', name: 'gridsome' }],
});


--- src/rules/ssg/hexojs.ts ---

import { register } from '../../register.js';

register({
  tech: 'hexojs',
  name: 'HexoJS',
  type: 'ssg',
  dependencies: [{ type: 'npm', name: 'hexo' }],
});


--- src/rules/ssg/hugo.ts ---

import { register } from '../../register.js';

register({
  tech: 'hugo',
  name: 'Hugo',
  type: 'ssg',
  files: ['hugo.toml'],
  dependencies: [
    { type: 'docker', name: 'betterweb/hugo' },
    { type: 'docker', name: 'hugomods/hugo' },
    { type: 'docker', name: 'klakegg/hugo' },
    { type: 'githubAction', name: 'peaceiris/actions-hugo' },
    { type: 'npm', name: 'hugo-lunr-indexer' },
    { type: 'npm', name: 'hugo-extended' },
  ],
});


--- src/rules/ssg/index.ts ---

import './assemble.js';
import './astro.js';
import './docsify.js';
import './docusaurus.js';
import './eleventy.js';
import './fern.js';
import './fumadocs.js';
import './gatsby.js';
import './gridsome.js';
import './hexojs.js';
import './hugo.js';
import './jekyll.js';
import './mintlify.js';
import './mkdocs.js';
import './readthedocs.js';
import './slatedocs.js';
import './vitepress.js';
import './vuepress.js';


--- src/rules/ssg/jekyll.ts ---

import { register } from '../../register.js';

register({
  tech: 'jekyll',
  name: 'Jekyll',
  type: 'ssg',
  files: ['.jekyll-cache'],
  dependencies: [
    { type: 'githubAction', name: 'jeffreytse/jekyll-deploy-action' },
    { type: 'ruby', name: 'jekyll' },
  ],
});


--- src/rules/ssg/mintlify.ts ---

import { register } from '../../register.js';

register({
  tech: 'mintlify',
  name: 'Mintlify',
  type: 'ssg',
  files: ['mint.json'],
  dependencies: [{ type: 'npm', name: 'mintlify' }],
});


--- src/rules/ssg/mkdocs.ts ---

import { register } from '../../register.js';

register({
  tech: 'mkdocs',
  name: 'MkDocs',
  type: 'ssg',
  files: ['mkdocs.yml'],
  dependencies: [
    { type: 'python', name: 'mkdocs' },
    { type: 'docker', name: 'squidfunk/mkdocs-material' },
  ],
});


--- src/rules/ssg/readthedocs.ts ---

import { register } from '../../register.js';

register({
  tech: 'readthedocs',
  name: 'Read The Docs',
  type: 'ssg',
  files: ['.readthedocs.yml'],
  dependencies: [{ type: 'docker', name: 'readthedocs/build' }],
});


--- src/rules/ssg/slatedocs.ts ---

import { register } from '../../register.js';

register({
  tech: 'slatedocs',
  name: 'Slate',
  type: 'ssg',
  dependencies: [{ type: 'docker', name: 'slatedocs/slate' }],
});


--- src/rules/ssg/vitepress.ts ---

import { register } from '../../register.js';

register({
  tech: 'vitepress',
  name: 'VitePress',
  type: 'ssg',
  files: ['.vitepress'],
  dependencies: [{ type: 'npm', name: 'vitepress' }],
});


--- src/rules/ssg/vuepress.ts ---

import { register } from '../../register.js';

register({
  tech: 'vuepress',
  name: 'VuePress',
  type: 'ssg',
  files: ['.vuepress'],
  dependencies: [
    { type: 'npm', name: 'vuepress' },
    { type: 'npm', name: '@vuepress/core' },
  ],
});


--- src/rules/storage/aws.cloudfront.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.cloudfront',
  name: 'AWS CloudFront',
  type: 'storage',
  dotenv: ['CLOUDFRONT_'],
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-cloudfront' },
    { type: 'npm', name: '@aws-sdk/client-cloudfront' },
    { type: 'rust', name: 'aws-sdk-cloudfront' },
    { type: 'ruby', name: 'aws-sdk-cloudfront' },
    { type: 'ruby', name: 'cloudfront-signer' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/cloudfront' },
    {
      type: 'terraform.resource',
      name: /^aws_cloudfront_/,
      example: 'aws_cloudfront_function',
    },
    { type: 'php', name: 'dreamonkey/laravel-cloudfront-url-signer' },
    { type: 'githubAction', name: 'chetan/invalidate-cloudfront-action' },
  ],
});


--- src/rules/storage/aws.ebs.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.ebs',
  name: 'AWS Block Storage',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-ebs' },
    { type: 'npm', name: '@aws-sdk/client-ebs' },
    { type: 'rust', name: 'aws-sdk-ebs' },
    { type: 'ruby', name: 'aws-sdk-ebs' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/ebs' },
    {
      type: 'terraform.resource',
      name: /^aws_ebs_/,
      example: 'aws_ebs_volume',
    },
  ],
});


--- src/rules/storage/aws.ecr.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.ecr',
  name: 'AWS Container Registry',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-ecr' },
    { type: 'npm', name: '@aws-sdk/client-ecr' },
    { type: 'rust', name: 'aws-sdk-ecr' },
    { type: 'ruby', name: 'aws-sdk-ecr' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/ecr' },
    {
      type: 'terraform.resource',
      name: /^aws_ecr_/,
      example: 'aws_ecr_repository',
    },
    { type: 'githubAction', name: 'aws-actions/amazon-ecr-login' },
  ],
});


--- src/rules/storage/aws.efs.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.efs',
  name: 'AWS File System',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@aws-cdk/aws-efs' },
    { type: 'npm', name: '@aws-sdk/client-efs' },
    { type: 'rust', name: 'aws-sdk-efs' },
    { type: 'ruby', name: 'aws-sdk-efs' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/efs' },
    {
      type: 'terraform.resource',
      name: /^aws_efs_/,
      example: 'aws_efs_file_system',
    },
  ],
});


--- src/rules/storage/aws.glacier.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.glacier',
  name: 'AWS Glacier',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-glacier' },
    { type: 'rust', name: 'aws-sdk-glacier' },
    { type: 'ruby', name: 'aws-sdk-glacier' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/glacier' },
    {
      type: 'terraform.resource',
      name: /^aws_glacier/,
      example: 'aws_glacier_vault',
    },
  ],
});


--- src/rules/storage/aws.s3.ts ---

import { register } from '../../register.js';

register({
  tech: 'aws.s3',
  name: 'AWS S3',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@aws-sdk/client-s3' },
    { type: 'docker', name: 'adobe/s3mock' },
    { type: 'rust', name: 'aws-sdk-s3' },
    { type: 'ruby', name: 'aws-sdk-s3' },
    { type: 'golang', name: 'github.com/aws/aws-sdk-go-v2/service/s3' },
    {
      type: 'terraform.resource',
      name: /^aws_s3/,
      example: 'aws_s3_bucket',
    },
    { type: 'php', name: 'async-aws/s3' },
    { type: 'php', name: 'async-aws/simple-s3' },
    { type: 'githubAction', name: 'jakejarvis/s3-sync-action' },
    { type: 'php', name: 'league/flysystem-aws-s3-v3' },
    { type: 'php', name: 'league/flysystem-async-aws-s3' },
    { type: 'terraform.resource', name: 'airbyte_destination_s3' },
  ],
});


--- src/rules/storage/azure.storage.ts ---

import { register } from '../../register.js';

register({
  tech: 'azure.storage',
  name: 'Azure Storage',
  type: 'storage',
  dependencies: [
    {
      type: 'terraform.resource',
      name: /^azurerm_hpc_/,
      example: 'azurerm_hpc_cache',
    },
    {
      type: 'terraform.resource',
      name: /^azurerm_storage_/,
      example: 'azurerm_storage_account',
    },
    { type: 'npm', name: '@azure/storage-blob' },
    { type: 'npm', name: '@azure/storage-queue' },
    { type: 'npm', name: '@azure/storage-file-share' },
    { type: 'npm', name: '@azure/storage-file-datalake' },
    { type: 'ruby', name: 'azure-storage' },
    { type: 'ruby', name: 'azure-storage-common' },
    { type: 'ruby', name: 'azure-storage-blob' },
    { type: 'ruby', name: 'azure-storage-table' },
    { type: 'ruby', name: 'azure-storage-file' },
    { type: 'ruby', name: 'azure-storage-queue' },
    { type: 'ruby', name: 'azure_mgmt_storage' },
    { type: 'ruby', name: 'fluent-plugin-azurestorage' },
    { type: 'ruby', name: 'fluent-plugin-azurestorage-gen2' },
    { type: 'ruby', name: 'logstash-input-azureblob' },
    { type: 'php', name: 'microsoft/azure-storage-common' },
    { type: 'php', name: 'microsoft/azure-storage-blob' },
    { type: 'php', name: 'microsoft/azure-storage-table' },
    { type: 'php', name: 'microsoft/azure-storage-file' },
    { type: 'php', name: 'microsoft/azure-storage-queue' },
    { type: 'php', name: 'matthewbdaly/laravel-azure-storage' },
    { type: 'php', name: 'league/flysystem-azure-blob-storage' },
    { type: 'rust', name: 'azure_storage' },
    { type: 'rust', name: 'azure_storage_queues' },
    { type: 'rust', name: 'azure_storage_blobs' },
    { type: 'rust', name: 'azure_storage_datalake' },
    { type: 'terraform.resource', name: 'airbyte_destination_azure_blob_storage' },
  ],
});


--- src/rules/storage/cloudflare.r2.ts ---

import { register } from '../../register.js';

register({
  tech: 'cloudflare.r2',
  name: 'Cloudflare R2',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: 'node-cloudflare-r2' },
    {
      type: 'terraform.resource',
      name: /^cloudflare_r2/,
      example: 'cloudflare_r2_bucket',
    },
  ],
});


--- src/rules/storage/gcp.artifactregistry.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.artifactregistry',
  name: 'Cloud Artifact Registry',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@google-cloud/artifact-registry' },
    { type: 'npm', name: 'google-artifactregistry-auth' },
    { type: 'golang', name: 'cloud.google.com/go/artifactregistry' },
    { type: 'ruby', name: 'google-cloud-artifact_registry' },
    {
      type: 'terraform.resource',
      name: /^google_artifact_/,
      example: 'google_artifact_registry_repository',
    },
  ],
});


--- src/rules/storage/gcp.containerregistry.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.containerregistry',
  name: 'Cloud Container Registry',
  type: 'storage',
  dependencies: [],
});


--- src/rules/storage/gcp.gcs.ts ---

import { register } from '../../register.js';

register({
  tech: 'gcp.gcs',
  name: 'Cloud Storage',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@google-cloud/storage' },
    {
      type: 'terraform.resource',
      name: /^google_storage_/,
      example: 'google_storage_bucket',
    },
    { type: 'golang', name: 'cloud.google.com/go/storage' },
    { type: 'ruby', name: 'google-cloud-storage' },
    { type: 'ruby', name: 'google-apis-storage_v1' },
    { type: 'rust', name: 'google-cloud-storage' },
    { type: 'php', name: 'google/cloud-storage' },
    {
      type: 'githubAction',
      name: 'google-github-actions/upload-cloud-storage',
    },
    { type: 'php', name: 'league/flysystem-google-cloud-storage' },
    { type: 'python', name: 'google-cloud-storage' },
    { type: 'terraform.resource', name: 'airbyte_destination_gcs' },
  ],
});


--- src/rules/storage/index.ts ---

import './aws.cloudfront.js';
import './aws.ebs.js';
import './aws.ecr.js';
import './aws.efs.js';
import './aws.glacier.js';
import './aws.s3.js';
import './azure.storage.js';
import './cloudflare.r2.js';
import './gcp.artifactregistry.js';
import './gcp.containerregistry.js';
import './gcp.gcs.js';
import './ovh.storage.js';
import './scaleway.storage.js';
import './supabase.storage.js';


--- src/rules/storage/ovh.storage.ts ---

import { register } from '../../register.js';

register({
  tech: 'ovh.storage',
  name: 'OVH Storage',
  type: 'storage',
  dependencies: [
    {
      type: 'terraform.resource',
      name: 'ovh_cloud_project_region_storage_presign',
    },
  ],
});


--- src/rules/storage/scaleway.storage.ts ---

import { register } from '../../register.js';

register({
  tech: 'scaleway.storage',
  name: 'Scaleway Storage',
  type: 'storage',
  dependencies: [
    { type: 'terraform.resource', name: 'scaleway_object_bucket' },
    { type: 'terraform.resource', name: 'scaleway_object_bucket_acl' },
  ],
});


--- src/rules/storage/supabase.storage.ts ---

import { register } from '../../register.js';

register({
  tech: 'supabase.storage',
  name: 'Supabase Storage',
  type: 'storage',
  dependencies: [
    { type: 'npm', name: '@supabase/storage-js' },
    { type: 'docker', name: 'bitnami/supabase-storage' },
    { type: 'docker', name: 'supabase/storage-api' },
  ],
});


--- src/rules/test/index.ts ---

import './jest.js';
import './k6.js';
import './lighthouse.js';
import './mochajs.js';
import './phppest.js';
import './phpunit.js';
import './storybook.js';
import './testinglibrary.js';
import './vitest.js';


--- src/rules/test/jest.ts ---

import { register } from '../../register.js';

register({
  tech: 'jest',
  name: 'Jest',
  type: 'test',
  files: /jest.config.(js|ts|mjs|cjs|json)/,
  example: 'jest.config.ts',
  dependencies: [
    { type: 'npm', name: 'jest' },
    { type: 'npm', name: 'babel-jest' },
    { type: 'npm', name: 'jest-cli' },
  ],
});


--- src/rules/test/k6.ts ---

import { register } from '../../register.js';

register({
  tech: 'k6',
  name: 'Grafana K6',
  type: 'test',
  dependencies: [
    { type: 'npm', name: 'k6' },
    { type: 'golang', name: 'go.k6.io/xk6/cmd/xk6ver' },
    { type: 'docker', name: 'grafana/k6' },
  ],
});


--- src/rules/test/lighthouse.ts ---

import { register } from '../../register.js';

register({
  tech: 'lighthouse',
  name: 'Lighthouse',
  type: 'test',
  dependencies: [
    { type: 'npm', name: 'lighthouse' },
    { type: 'githubAction', name: 'jakejarvis/lighthouse-action' },
    { type: 'githubAction', name: 'foo-software/lighthouse-check-action' },
    { type: 'githubAction', name: 'treosh/lighthouse-ci-action' },
    { type: 'docker', name: 'femtopixel/google-lighthouse' },
  ],
});


--- src/rules/test/mochajs.ts ---

import { register } from '../../register.js';

register({
  tech: 'mochajs',
  name: 'Mocha',
  type: 'test',
  files: /.mocharc.(js|cjs|json|jsonc|yaml|yml)/,
  example: 'jest.config.ts',
  dependencies: [{ type: 'npm', name: 'mocha' }],
});


--- src/rules/test/phppest.ts ---

import { register } from '../../register.js';

register({
  tech: 'phppest',
  name: 'PHP Pest',
  type: 'test',
  dependencies: [{ type: 'php', name: 'pestphp/pest' }],
});


--- src/rules/test/phpunit.ts ---

import { register } from '../../register.js';

register({
  tech: 'phpunit',
  name: 'PHPUnit',
  type: 'test',
  files: ['phpunit.xml.dist'],
  dependencies: [{ type: 'php', name: 'phpunit/phpunit' }],
});


--- src/rules/test/storybook.ts ---

import { register } from '../../register.js';

register({
  tech: 'storybook',
  name: 'Storybook',
  type: 'test',
  files: ['.storybook'],
  dependencies: [{ type: 'npm', name: 'storybook' }],
});


--- src/rules/test/testinglibrary.ts ---

import { register } from '../../register.js';

register({
  tech: 'testinglibrary',
  name: 'Testing Library',
  type: 'test',
  dependencies: [{ type: 'npm', name: /^@testing-library\//, example: '@testing-library/react' }],
});


--- src/rules/test/vitest.ts ---

import { register } from '../../register.js';

register({
  tech: 'vitest',
  name: 'Vitest',
  type: 'test',
  files: ['vitest.config.js', 'vitest.config.ts'],
  dependencies: [{ type: 'npm', name: 'vitest' }],
});


--- src/rules/tool/adonisjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'adonisjs',
  name: 'AdonisJS',
  type: 'tool',
  dependencies: [
    { type: 'npm', name: 'adonisjs' },
    { type: 'npm', name: '@adonisjs/core' },
  ],
});


--- src/rules/tool/apacheThrift.ts ---

import { register } from '../../register.js';

register({
  tech: 'apache_thrift',
  name: 'Apache Thrift',
  type: 'tool',
  dependencies: [
    { type: 'docker', name: 'apache/thrift' },
    { type: 'npm', name: 'thrift' },
    { type: 'golang', name: 'github.com/apache/thrift' },
    { type: 'rust', name: 'thrift' },
    { type: 'ruby', name: 'thrift' },
  ],
});


--- src/rules/tool/atlasgo.ts ---

import { register } from '../../register.js';

register({
  tech: 'atlasgo',
  name: 'AtlasGo',
  type: 'tool',
  files: ['schema.hcl'],
  dependencies: [
    { type: 'docker', name: 'arigaio/atlas' },
    { type: 'githubAction', name: 'ariga/setup-atlas' },
    { type: 'githubAction', name: 'ariga/atlas-action/migrate/lint' },
    { type: 'githubAction', name: 'ariga/atlas-action/migrate/push' },
    { type: 'githubAction', name: 'ariga/atlas-action/migrate/apply' },
    { type: 'terraform', name: 'registry.terraform.io/ariga/atlas' },
  ],
});


--- src/rules/tool/bytebase.ts ---

import { register } from '../../register.js';

register({
  tech: 'bytebase',
  name: 'Bytebase',
  type: 'tool',
  dependencies: [
    { type: 'docker', name: 'bytebase/bytebase' },
    { type: 'githubAction', name: 'bytebase/sql-review-action' },
  ],
});


--- src/rules/tool/effectjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'effectjs',
  name: 'EffectJS',
  type: 'tool',
  dependencies: [{ type: 'npm', name: 'effect' }],
});


--- src/rules/tool/elysiajs.ts ---

import { register } from '../../register.js';

register({
  tech: 'elysiajs',
  name: 'ElysiaJS',
  type: 'tool',
  dependencies: [{ type: 'npm', name: 'elysia' }],
});


--- src/rules/tool/express.ts ---

import { register } from '../../register.js';

register({
  tech: 'express',
  name: 'Express',
  type: 'tool',
  dependencies: [{ type: 'npm', name: 'express' }],
});


--- src/rules/tool/fastify.ts ---

import { register } from '../../register.js';

register({
  tech: 'fastify',
  name: 'Fastify',
  type: 'tool',
  dependencies: [
    { type: 'npm', name: 'fastify' },
    { type: 'npm', name: '@opentelemetry/instrumentation-fastify' },
  ],
});


--- src/rules/tool/flyway.ts ---

import { register } from '../../register.js';

register({
  tech: 'flyway',
  name: 'Flyway',
  type: 'tool',
  dependencies: [
    { type: 'docker', name: 'flyway/flyway' },
    { type: 'githubAction', name: 'red-gate/flyway-hub-migration-test' },
    { type: 'githubAction', name: 'joshuaavalon/flyway-action' },
  ],
});


--- src/rules/tool/gitlab.ts ---

import { register } from '../../register.js';

register({
  tech: 'gitlab',
  name: 'Gitlab',
  type: 'tool',
  dependencies: [
    { type: 'terraform', name: 'registry.terraform.io/gitlabhq/gitlab' },
    { type: 'rust', name: 'gitlab' },
    { type: 'ruby', name: 'gitlab' },
    { type: 'php', name: 'm4tthumphrey/php-gitlab-api' },
    { type: 'npm', name: '@pulumi/gitlab' },
    { type: 'terraform.resource', name: 'airbyte_source_gitlab' },
    { type: 'python', name: 'python-gitlab' },
  ],
});


--- src/rules/tool/goacmelego.ts ---

import { register } from '../../register.js';

register({
  tech: 'goacmelego',
  name: 'Lego',
  type: 'tool',
  files: ['.lego'],
  dependencies: [
    { type: 'docker', name: 'goacme/lego' },
    { type: 'golang', name: 'github.com/go-acme/lego/v4/cmd/lego' },
  ],
});


--- src/rules/tool/honojs.ts ---

import { register } from '../../register.js';

register({
  tech: 'honojs',
  name: 'HonoJS',
  type: 'tool',
  dependencies: [{ type: 'npm', name: 'hono' }],
});


--- src/rules/tool/index.ts ---

import './adonisjs.js';
import './apacheThrift.js';
import './atlasgo.js';
import './bytebase.js';
import './effectjs.js';
import './elysiajs.js';
import './express.js';
import './fastify.js';
import './flyway.js';
import './gitlab.js';
import './goacmelego.js';
import './honojs.js';
import './koa.js';
import './liquibase.js';
import './mailhog.js';
import './mcp.js';
import './openapi.js';
import './pytorch.js';
import './reactEmail.js';
import './socketio.js';
import './tensorflow.js';
import './trpc.js';
import './twig.js';


--- src/rules/tool/koa.ts ---

import { register } from '../../register.js';

register({
  tech: 'koa',
  name: 'Koa',
  type: 'tool',
  dependencies: [
    { type: 'npm', name: 'koa' },
    { type: 'npm', name: '@opentelemetry/instrumentation-koa' },
  ],
});


--- src/rules/tool/liquibase.ts ---

import { register } from '../../register.js';

register({
  tech: 'liquibase',
  name: 'Liquibase',
  type: 'tool',
  dependencies: [
    { type: 'docker', name: 'liquibase/liquibase' },
    { type: 'docker', name: 'webdevops/liquibase' },
    { type: 'githubAction', name: 'liquibase/liquibase-github-action' },
    { type: 'githubAction', name: 'liquibase-github-actions/init-start-h2' },
    { type: 'githubAction', name: 'liquibase-github-actions/update' },
  ],
});


--- src/rules/tool/mailhog.ts ---

import { register } from '../../register.js';

register({
  tech: 'mailhog',
  name: 'Mailhog',
  type: 'tool',
  dependencies: [
    { type: 'golang', name: 'github.com/mailhog/MailHog' },
    { type: 'docker', name: 'mailhog/mailhog' },
  ],
});


--- src/rules/tool/mcp.ts ---

import { register } from '../../register.js';

register({
  tech: 'mcp',
  name: 'MCP',
  type: 'tool',
  dependencies: [
    { type: 'npm', name: '@modelcontextprotocol/sdk' },
    { type: 'python', name: 'mcp' },
    { type: 'ruby', name: 'mcp' },
  ],
});


--- src/rules/tool/openapi.ts ---

import { register } from '../../register.js';

register({
  tech: 'openapi',
  name: 'OpenAPI',
  type: 'tool',
  files: ['openapi.yaml', 'openapi.json', 'openapi.yml'],
  dependencies: [
    { type: 'npm', name: 'openapi-types' },
    { type: 'npm', name: 'openapi3-ts' },
    { type: 'npm', name: '@asteasolutions/zod-to-openapi' },
    { type: 'npm', name: 'openapi-typescript' },
    { type: 'npm', name: '@apidevtools/swagger-parser' },
    { type: 'golang', name: 'github.com/go-openapi/runtime' },
    { type: 'golang', name: 'github.com/go-openapi/swag' },
    { type: 'php', name: 'swagger-api/swagger-ui' },
    { type: 'python', name: 'openapi' },
    { type: 'ruby', name: 'openapi_parser' },
    { type: 'rust', name: 'openapi' },
  ],
});


--- src/rules/tool/pytorch.ts ---

import { register } from '../../register.js';

register({
  tech: 'pytorch',
  name: 'Pytorch',
  type: 'tool',
  dependencies: [{ type: 'python', name: 'pytorch' }],
});


--- src/rules/tool/reactEmail.ts ---

import { register } from '../../register.js';

register({
  tech: 'reactemail',
  name: 'React Email',
  type: 'tool',
  dependencies: [{ type: 'npm', name: 'react-email' }],
});


--- src/rules/tool/socketio.ts ---

import { register } from '../../register.js';

register({
  tech: 'socketio',
  name: 'Socket.io',
  type: 'tool',
  dependencies: [
    { type: 'npm', name: 'socket.io' },
    { type: 'python', name: 'python-socketio' },
    { type: 'npm', name: '@opentelemetry/instrumentation-socket.io' },
  ],
});


--- src/rules/tool/tensorflow.ts ---

import { register } from '../../register.js';

register({
  tech: 'tensorflow',
  name: 'Tensorflow',
  type: 'tool',
  dependencies: [
    { type: 'docker', name: 'tensorflow/tensorflow' },
    { type: 'npm', name: '@tensorflow/tfjs-core' },
    { type: 'npm', name: '@tensorflow/tfjs' },
    { type: 'npm', name: 'face-api.js' },
    { type: 'golang', name: 'github.com/wamuir/graft/tensorflow' },
    { type: 'python', name: 'tensorflow' },
  ],
});


--- src/rules/tool/trpc.ts ---

import { register } from '../../register.js';

register({
  tech: 'trpc',
  name: 'TRPC',
  type: 'tool',
  dependencies: [
    { type: 'npm', name: '@trpc/server' },
    { type: 'npm', name: '@trpc/client' },
    { type: 'npm', name: '@trpc/react-query' },
    { type: 'npm', name: '@trpc/next' },
  ],
});


--- src/rules/tool/twig.ts ---

import { register } from '../../register.js';

register({
  tech: 'twigphp',
  name: 'Twig',
  type: 'tool',
  dependencies: [{ type: 'php', name: 'twig/twig' }],
});


--- src/rules/ui/antd.ts ---

import { register } from '../../register.js';

register({
  tech: 'antd',
  name: 'Ant Design',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: 'antd' },
    { type: 'npm', name: 'ant-design-vue' },
  ],
});


--- src/rules/ui/ariakitui.ts ---

import { register } from '../../register.js';

register({
  tech: 'ariakitui',
  name: 'AriaKit UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: /^@ariakit\//, example: '@ariakit/react' }],
});


--- src/rules/ui/arkui.ts ---

import { register } from '../../register.js';

register({
  tech: 'arkui',
  name: 'Ark UI',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: '@ark-ui/react' },
    { type: 'npm', name: '@ark-ui/svelte' },
    { type: 'npm', name: '@ark-ui/solid' },
    { type: 'npm', name: '@ark-ui/vue' },
  ],
});


--- src/rules/ui/baseui.ts ---

import { register } from '../../register.js';

register({
  tech: 'baseui',
  name: 'Base UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: '@base-ui-components/react' }],
});


--- src/rules/ui/bootstrap.ts ---

import { register } from '../../register.js';

register({
  tech: 'bootstrap',
  name: 'Bootstrap',
  type: 'ui',
  dependencies: [{ type: 'npm', name: 'bootstrap' }],
});


--- src/rules/ui/chakraui.ts ---

import { register } from '../../register.js';

register({
  tech: 'chakraui',
  name: 'Chakra UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: /^@chakra-ui\//, example: '@chakra-ui/react' }],
});


--- src/rules/ui/codemirror.ts ---

import { register } from '../../register.js';

register({
  tech: 'codemirror',
  name: 'CodeMirror',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: 'codemirror' },
    { type: 'npm', name: /@codemirror\//, example: '@codemirror/view' },
  ],
});


--- src/rules/ui/d3js.ts ---

import { register } from '../../register.js';

register({
  tech: 'd3js',
  name: 'D3.js',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: 'd3' },
    { type: 'npm', name: 'd3-shape' },
    { type: 'npm', name: '@types/d3' },
    { type: 'npm', name: '@types/d3-shape' },
  ],
});


--- src/rules/ui/daisyui.ts ---

import { register } from '../../register.js';

register({
  tech: 'daisyui',
  name: 'daisyUI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: 'daisyui' }],
});


--- src/rules/ui/fluentui.ts ---

import { register } from '../../register.js';

register({
  tech: 'fluentui',
  name: 'Fluent UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: /^@fluentui\//, example: '@fluentui/react' }],
});


--- src/rules/ui/gradio.ts ---

import { register } from '../../register.js';

register({
  tech: 'gradio',
  name: 'Gradio',
  type: 'ui',
  dependencies: [{ type: 'python', name: 'gradio' }],
});


--- src/rules/ui/headlessui.ts ---

import { register } from '../../register.js';

register({
  tech: 'headlessui',
  name: 'Headless UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: /^@headlessui\//, example: '@headlessui/react' }],
});


--- src/rules/ui/heroui.ts ---

import { register } from '../../register.js';

register({
  tech: 'heroui',
  name: 'Hero UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: /^@heroui\//, example: '@heroui/react' }],
});


--- src/rules/ui/index.ts ---

import './antd.js';
import './ariakitui.js';
import './arkui.js';
import './baseui.js';
import './bootstrap.js';
import './chakraui.js';
import './codemirror.js';
import './d3js.js';
import './daisyui.js';
import './fluentui.js';
import './gradio.js';
import './headlessui.js';
import './heroui.js';
import './lexicaleditor.js';
import './mantineui.js';
import './materialui.js';
import './monacoeditor.js';
import './phaserjs.js';
import './radixui.js';
import './reactRouterDom.js';
import './refinedev.js';
import './rekaui.js';
import './remixRouter.js';
import './sandpackeditor.js';
import './shadcn.js';
import './shopify.hydrogen.js';
import './tailwind.js';
import './tanstackRouter.js';
import './tiptap.js';


--- src/rules/ui/lexicaleditor.ts ---

import { register } from '../../register.js';

register({
  tech: 'lexicaleditor',
  name: 'Lexical Editor',
  type: 'ui',
  dependencies: [{ type: 'npm', name: 'lexical' }],
});


--- src/rules/ui/mantineui.ts ---

import { register } from '../../register.js';

register({
  tech: 'mantineui',
  name: 'Mantine UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: /^@mantine\//, example: '@mantine/core' }],
});


--- src/rules/ui/materialui.ts ---

import { register } from '../../register.js';

register({
  tech: 'materialui',
  name: 'Material UI',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: '@mui/material' },
    { type: 'npm', name: '@mui/types' },
  ],
});


--- src/rules/ui/monacoeditor.ts ---

import { register } from '../../register.js';

register({
  tech: 'monacoeditor',
  name: 'Monaco Editor',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: 'monaco-editor' },
    { type: 'npm', name: '@monaco-editor/loader' },
    { type: 'npm', name: '@monaco-editor/react' },
  ],
});


--- src/rules/ui/phaserjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'phaserjs',
  name: 'Phaser',
  type: 'ui',
  dependencies: [{ type: 'npm', name: 'phaser' }],
});


--- src/rules/ui/radixui.ts ---

import { register } from '../../register.js';

register({
  tech: 'radixui',
  name: 'Radix UI',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: '@radix-ui/react-context' },
    { type: 'npm', name: '@radix-ui/react-slot' },
    { type: 'npm', name: '@radix-ui/react-label' },
    { type: 'npm', name: 'radix-ui' },
  ],
});


--- src/rules/ui/reactRouterDom.ts ---

import { register } from '../../register.js';

register({
  tech: 'reactrouterdom',
  name: 'React Router',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: 'react-router-dom' },
    { type: 'npm', name: 'react-router' },
  ],
});


--- src/rules/ui/refinedev.ts ---

import { register } from '../../register.js';

register({
  tech: 'refinedev',
  name: 'Refine',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: '@refinedev/core' },
    { type: 'npm', name: '@refinedev/antd' },
    { type: 'npm', name: '@refinedev/cli' },
  ],
});


--- src/rules/ui/rekaui.ts ---

import { register } from '../../register.js';

register({
  tech: 'rekaui',
  name: 'Reka UI',
  type: 'ui',
  dependencies: [{ type: 'npm', name: 'reka-ui' }],
});


--- src/rules/ui/remixRouter.ts ---

import { register } from '../../register.js';

register({
  tech: 'remixrouter',
  name: 'Remix Router',
  type: 'ui',
  dependencies: [
    { type: 'npm', name: '@remix-run/router' },
    { type: 'npm', name: '@remix-run/react' },
  ],
});


--- src/rules/ui/sandpackeditor.ts ---

import { register } from '../../register.js';

register({
  tech: 'sandpackeditor',
  name: 'Sandpack',
  type: 'ui',
  dependencies: [{ type: 'npm', name: '@codesandbox/sandpack-react' }],
});


--- src/rules/ui/shadcn.ts ---

import { Payload } from '../../payload/index.js';
import { register } from '../../register.js';

import type { ComponentMatcher } from '../../types/rule.js';

/**
 * No other way to detect Shadcn than checking the components.json file.
 * It's really unfortunate, and we will try no to have to do this for other techs.
 */
const detectShadcn: ComponentMatcher = async (files, provider) => {
  for (const file of files) {
    if (file.name !== 'components.json') {
      continue;
    }

    const content = await provider.open(file.fp);
    if (!content) {
      continue;
    }

    let parsed: Record<string, unknown>;
    try {
      parsed = JSON.parse(content) as Record<string, unknown>;
    } catch {
      continue;
    }

    if (!('$schema' in parsed)) {
      continue;
    }

    if (parsed.$schema !== 'https://ui.shadcn.com/schema.json') {
      continue;
    }

    const pl = new Payload({ name: 'virtual', folderPath: file.fp });
    pl.addTech('shadcn', ['components.json']);
    return pl;
  }

  return false;
};

register({
  tech: 'shadcn',
  name: 'Shadcn',
  type: 'ui',
  detect: detectShadcn,
  dependencies: [
    { type: 'npm', name: 'shadcn-ui' },
    { type: 'npm', name: '@shadcn/ui' },
    { type: 'npm', name: 'shadcn' },
    { type: 'npm', name: 'shadcn-nuxt' },
    { type: 'npm', name: 'shadcn-svelte' },
    { type: 'npm', name: 'shadcn-vue' },
  ],
});


--- src/rules/ui/shopify.hydrogen.ts ---

import { register } from '../../register.js';

register({
  tech: 'shopify.hydrogen',
  name: 'Shopify Hydrogen',
  type: 'ui',
  dependencies: [{ type: 'npm', name: '@shopify/hydrogen' }],
});


--- src/rules/ui/tailwind.ts ---

import { register } from '../../register.js';

register({
  tech: 'tailwind',
  name: 'Tailwind',
  type: 'ui',
  files: ['tailwind.config.js'],
  dependencies: [{ type: 'npm', name: 'tailwindcss' }],
});


--- src/rules/ui/tanstackRouter.ts ---

import { register } from '../../register.js';

register({
  tech: 'tanstackrouter',
  name: 'TanStack Router',
  type: 'ui',
  dependencies: [{ type: 'npm', name: '@tanstack/react-router' }],
});


--- src/rules/ui/tiptap.ts ---

import { register } from '../../register.js';

register({
  tech: 'tiptap',
  name: 'Tiptap',
  type: 'ui',
  dependencies: [{ type: 'npm', name: /^@tiptap\//, example: '@tiptap/react' }],
});


--- src/rules/ui_framework/alpinejs.ts ---

import { register } from '../../register.js';

register({
  tech: 'alpinejs',
  name: 'Alpine.js',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'alpinejs' }],
});


--- src/rules/ui_framework/angular.ts ---

import { register } from '../../register.js';

register({
  tech: 'angular',
  name: 'Angular',
  type: 'ui_framework',
  files: ['angular.json'],
  dependencies: [
    { type: 'npm', name: 'angular' },
    { type: 'npm', name: /^@angular\//, example: '@angular/forms' },
  ],
});


--- src/rules/ui_framework/emberjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'emberjs',
  name: 'Ember',
  type: 'ui_framework',
  files: ['ember-cli-build.js'],
  dependencies: [
    { type: 'npm', name: 'ember-cli' },
    { type: 'npm', name: 'ember' },
    { type: 'npm', name: 'ember-data' },
    { type: 'npm', name: 'ember-source' },
  ],
});


--- src/rules/ui_framework/expojs.ts ---

import { register } from '../../register.js';

register({
  tech: 'expojs',
  name: 'ExpoJS',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'expo' }],
});


--- src/rules/ui_framework/htmx.ts ---

import { register } from '../../register.js';

register({
  tech: 'htmx',
  name: 'HTMX',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'htmx.org' }],
});


--- src/rules/ui_framework/index.ts ---

import './alpinejs.js';
import './angular.js';
import './emberjs.js';
import './expojs.js';
import './htmx.js';
import './infernojs.js';
import './ionic.js';
import './litjs.js';
import './mithriljs.js';
import './preactjs.js';
import './qwikjs.js';
import './react.js';
import './solidjs.js';
import './stenciljs.js';
import './sveltejs.js';
import './umijs.js';
import './vue.js';


--- src/rules/ui_framework/infernojs.ts ---

import { register } from '../../register.js';

register({
  tech: 'infernojs',
  name: 'Inferno',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'inferno' }],
});


--- src/rules/ui_framework/ionic.ts ---

import { register } from '../../register.js';

register({
  tech: 'ionic',
  name: 'Ionic',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: /@ionic\//, example: '@ionic/core' }],
});


--- src/rules/ui_framework/litjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'litjs',
  name: 'Lit',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'lit' }],
});


--- src/rules/ui_framework/mithriljs.ts ---

import { register } from '../../register.js';

register({
  tech: 'mithriljs',
  name: 'Mithril',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'mithril' }],
});


--- src/rules/ui_framework/preactjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'preactjs',
  name: 'Preact',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'preact' }],
});


--- src/rules/ui_framework/qwikjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'qwikjs',
  name: 'Qwik',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'builder.io/qwik' }],
});


--- src/rules/ui_framework/react.ts ---

import { register } from '../../register.js';

register({
  tech: 'react',
  name: 'React',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'react' }],
});


--- src/rules/ui_framework/solidjs.ts ---

import { register } from '../../register.js';

register({
  tech: 'solidjs',
  name: 'Solid js',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'solid-js' }],
});


--- src/rules/ui_framework/stenciljs.ts ---

import { register } from '../../register.js';

register({
  tech: 'stenciljs',
  name: 'Stencil',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: '@stencil/core' }],
});


--- src/rules/ui_framework/sveltejs.ts ---

import { register } from '../../register.js';

register({
  tech: 'sveltejs',
  name: 'Svelte',
  type: 'ui_framework',
  files: ['svelte.config.js'],
  dependencies: [{ type: 'npm', name: 'svelte' }],
});


--- src/rules/ui_framework/umijs.ts ---

import { register } from '../../register.js';

register({
  tech: 'umijs',
  name: 'UmiJS',
  type: 'ui_framework',
  files: ['.umirc.ts'],
  dependencies: [
    { type: 'npm', name: 'umi' },
    { type: 'npm', name: '@umijs/route-utils' },
  ],
});


--- src/rules/ui_framework/vue.ts ---

import { register } from '../../register.js';

register({
  tech: 'vue',
  name: 'Vue.js',
  type: 'ui_framework',
  dependencies: [{ type: 'npm', name: 'vue' }],
});


--- src/rules/validation/arktype.ts ---

import { register } from '../../register.js';

register({
  tech: 'arktype',
  name: 'ArkType',
  type: 'validation',
  dependencies: [{ type: 'npm', name: 'arktype' }],
});


--- src/rules/validation/index.ts ---

import './arktype.js';
import './joijs.js';
import './jsonschema.js';
import './superstruct.js';
import './typebox.js';
import './valibot.js';
import './zod.js';


--- src/rules/validation/joijs.ts ---

import { register } from '../../register.js';

register({
  tech: 'joijs',
  name: 'Joi',
  type: 'validation',
  dependencies: [{ type: 'npm', name: 'joi' }],
});


--- src/rules/validation/jsonschema.ts ---

import { register } from '../../register.js';

register({
  tech: 'jsonschema',
  name: 'JSON Schema',
  type: 'validation',
  dependencies: [
    { type: 'npm', name: '@types/json-schema' },
    { type: 'npm', name: 'json-schema' },
    { type: 'npm', name: 'jsonschema' },
    { type: 'npm', name: 'ajv' },
    { type: 'php', name: 'justinrainbow/json-schema' },
    { type: 'php', name: 'opis/json-schema' },
    { type: 'golang', name: 'github.com/invopop/jsonschema' },
    { type: 'python', name: 'jsonschema' },
    { type: 'ruby', name: 'json-schema' },
    { type: 'rust', name: 'jsonschema' },
  ],
});


--- src/rules/validation/superstruct.ts ---

import { register } from '../../register.js';

register({
  tech: 'superstruct',
  name: 'Superstruct',
  type: 'validation',
  dependencies: [{ type: 'npm', name: 'superstruct' }],
});


--- src/rules/validation/typebox.ts ---

import { register } from '../../register.js';

register({
  tech: 'typebox',
  name: 'TypeBox',
  type: 'validation',
  dependencies: [{ type: 'npm', name: '@sinclair/typebox' }],
});


--- src/rules/validation/valibot.ts ---

import { register } from '../../register.js';

register({
  tech: 'valibot',
  name: 'Valibot',
  type: 'validation',
  dependencies: [{ type: 'npm', name: 'valibot' }],
});


--- src/rules/validation/zod.ts ---

import { register } from '../../register.js';

register({
  tech: 'zod',
  name: 'Zod',
  type: 'validation',
  dependencies: [{ type: 'npm', name: 'zod' }],
});


--- src/scripts/prebuild.ts ---

import fs from 'node:fs/promises';
import path from 'node:path';

import { registeredRules } from '../register.js';
import '../rules/index.js';

async function ensureIndexFiles(rulesFolder: string): Promise<void> {
  const folders = await fs.readdir(rulesFolder, { withFileTypes: true });
  for (const folder of folders) {
    if (!folder.isDirectory()) {
      continue;
    }
    if (folder.name === '__snapshots__' || folder.name === 'spec') {
      continue;
    }

    const folderPath = path.join(rulesFolder, folder.name);
    const files = await fs.readdir(folderPath);
    let imports = '';

    for (const file of files) {
      if (file !== 'index.ts' && file.endsWith('.ts')) {
        imports += `import './${file.replace('.ts', '.js')}';\n`;
      }
    }

    const indexPath = path.join(folderPath, 'index.ts');
    await fs.writeFile(indexPath, imports);
  }
}

// Ensure all rules folders have proper index.ts files
await ensureIndexFiles(path.join(import.meta.dirname, '../rules'));

await (async (): Promise<void> => {
  const list: string[] = registeredRules
    .sort((a, b) => (a.tech > b.tech ? 1 : -1))
    .map(({ tech, name, type }) => {
      return `{ key: '${tech}', name: '${name}', type: '${type}' }`;
    });

  await fs.writeFile(
    './src/common/techs.generated.ts',
    `import type { AllowedKeys, TechItem } from '../types/techs.js';

export const listTech: TechItem[] = [
  ${list.join(',\n  ')},
];

export const listIndexed = {} as Record<AllowedKeys, TechItem>;
for (const v of Object.values(listTech)) {
  listIndexed[v.key] = v;
}
`
  );
})();


--- src/tests/helpers.ts ---

import type { AnalyserJson } from '../types/index.js';

export function cleanNestedSnapshot(pl: AnalyserJson): AnalyserJson {
  pl.id = '';
  pl.inComponent = '';

  for (const child of pl.childs) cleanNestedSnapshot(child);
  for (const edge of pl.edges) edge.target = '';

  return pl;
}


--- src/types/index.ts ---

import type { AllowedLicenses } from './licenses.js';
import type { SupportedDeps } from './rule.js';
import type { AllowedKeys } from './techs.js';
import type { Modify } from './utils.js';
import type { Payload } from '../payload/index.js';

export interface GraphEdge {
  target: Payload;
  read: boolean;
  write: boolean;
}

export type Dependency = [SupportedDeps, string, string];

export interface Analyser {
  /**
   * Unique random id for this payload
   */
  id: string;

  /**
   * Best-effort name of this payload
   */
  name: string;

  /**
   * Where this payload was found.
   * When flatten() it will contain all path that were deduplicated
   */
  path: Set<string>;

  /**
   * If this payload is a specific Technology.
   * e.g: if it's a Postgresql database, the tech will be: "postgresql"
   */
  tech: AllowedKeys | null;

  /**
   * List matched tech from the rules.
   * Computed with the dependencies and languages.
   */
  techs: Set<AllowedKeys>;

  /**
   * If this payload is hosted by another payload.
   * e.g: we found a vercel dependency at the same level, this payload will be considered in the component Vercel.
   */
  inComponent: null | Payload;

  /**
   * List all childs of this payload
   */
  childs: Payload[];

  /**
   * List all languages found in this folder.
   * This list is computed using file extensions.
   */
  languages: Record<string, number>;

  /**
   * List all languages found in this folder.
   * This list is computed using file extensions.
   */
  licenses: Set<AllowedLicenses>;

  /**
   * List all relationship from this Payload to another one.
   * e.g:
   * this is a package.json and we found a Postgresql at the same level,
   * we will add an edge from this payload to the Postgresql's one.
   */
  edges: GraphEdge[];

  /**
   * List all dependencies wether or not they matched a rule.
   */
  dependencies: Dependency[];
}

export type AnalyserJson = Modify<
  Analyser,
  {
    childs: AnalyserJson[];
    path: string[];
    techs: AllowedKeys[];
    licenses: AllowedLicenses[];
    inComponent: null | string;
    edges: Modify<GraphEdge, { target: string }>[];
    reason: string[];
  }
>;


--- src/types/licenses.ts ---

// https://github.com/jslicense/spdx-license-ids
export type AllowedLicenses =
  | '0BSD'
  | '3D-Slicer-1.0'
  | 'AAL'
  | 'Abstyles'
  | 'AdaCore-doc'
  | 'Adobe-2006'
  | 'Adobe-Display-PostScript'
  | 'Adobe-Glyph'
  | 'Adobe-Utopia'
  | 'ADSL'
  | 'AFL-1.1'
  | 'AFL-1.2'
  | 'AFL-2.0'
  | 'AFL-2.1'
  | 'AFL-3.0'
  | 'Afmparse'
  | 'AGPL-1.0-only'
  | 'AGPL-1.0-or-later'
  | 'AGPL-3.0-only'
  | 'AGPL-3.0-or-later'
  | 'Aladdin'
  | 'AMD-newlib'
  | 'AMDPLPA'
  | 'AML-glslang'
  | 'AML'
  | 'AMPAS'
  | 'ANTLR-PD-fallback'
  | 'ANTLR-PD'
  | 'any-OSI-perl-modules'
  | 'any-OSI'
  | 'Apache-1.0'
  | 'Apache-1.1'
  | 'Apache-2.0'
  | 'APAFML'
  | 'APL-1.0'
  | 'App-s2p'
  | 'APSL-1.0'
  | 'APSL-1.1'
  | 'APSL-1.2'
  | 'APSL-2.0'
  | 'Arphic-1999'
  | 'Artistic-1.0-cl8'
  | 'Artistic-1.0-Perl'
  | 'Artistic-1.0'
  | 'Artistic-2.0'
  | 'ASWF-Digital-Assets-1.0'
  | 'ASWF-Digital-Assets-1.1'
  | 'Baekmuk'
  | 'Bahyph'
  | 'Barr'
  | 'bcrypt-Solar-Designer'
  | 'Beerware'
  | 'Bitstream-Charter'
  | 'Bitstream-Vera'
  | 'BitTorrent-1.0'
  | 'BitTorrent-1.1'
  | 'blessing'
  | 'BlueOak-1.0.0'
  | 'Boehm-GC-without-fee'
  | 'Boehm-GC'
  | 'Borceux'
  | 'Brian-Gladman-2-Clause'
  | 'Brian-Gladman-3-Clause'
  | 'BSD-1-Clause'
  | 'BSD-2-Clause-Darwin'
  | 'BSD-2-Clause-first-lines'
  | 'BSD-2-Clause-Patent'
  | 'BSD-2-Clause-Views'
  | 'BSD-2-Clause'
  | 'BSD-3-Clause-acpica'
  | 'BSD-3-Clause-Attribution'
  | 'BSD-3-Clause-Clear'
  | 'BSD-3-Clause-flex'
  | 'BSD-3-Clause-HP'
  | 'BSD-3-Clause-LBNL'
  | 'BSD-3-Clause-Modification'
  | 'BSD-3-Clause-No-Military-License'
  | 'BSD-3-Clause-No-Nuclear-License-2014'
  | 'BSD-3-Clause-No-Nuclear-License'
  | 'BSD-3-Clause-No-Nuclear-Warranty'
  | 'BSD-3-Clause-Open-MPI'
  | 'BSD-3-Clause-Sun'
  | 'BSD-3-Clause'
  | 'BSD-4-Clause-Shortened'
  | 'BSD-4-Clause-UC'
  | 'BSD-4-Clause'
  | 'BSD-4.3RENO'
  | 'BSD-4.3TAHOE'
  | 'BSD-Advertising-Acknowledgement'
  | 'BSD-Attribution-HPND-disclaimer'
  | 'BSD-Inferno-Nettverk'
  | 'BSD-Protection'
  | 'BSD-Source-beginning-file'
  | 'BSD-Source-Code'
  | 'BSD-Systemics-W3Works'
  | 'BSD-Systemics'
  | 'BSL-1.0'
  | 'BUSL-1.1'
  | 'bzip2-1.0.6'
  | 'C-UDA-1.0'
  | 'CAL-1.0-Combined-Work-Exception'
  | 'CAL-1.0'
  | 'Caldera-no-preamble'
  | 'Caldera'
  | 'Catharon'
  | 'CATOSL-1.1'
  | 'CC-BY-1.0'
  | 'CC-BY-2.0'
  | 'CC-BY-2.5-AU'
  | 'CC-BY-2.5'
  | 'CC-BY-3.0-AT'
  | 'CC-BY-3.0-AU'
  | 'CC-BY-3.0-DE'
  | 'CC-BY-3.0-IGO'
  | 'CC-BY-3.0-NL'
  | 'CC-BY-3.0-US'
  | 'CC-BY-3.0'
  | 'CC-BY-4.0'
  | 'CC-BY-NC-1.0'
  | 'CC-BY-NC-2.0'
  | 'CC-BY-NC-2.5'
  | 'CC-BY-NC-3.0-DE'
  | 'CC-BY-NC-3.0'
  | 'CC-BY-NC-4.0'
  | 'CC-BY-NC-ND-1.0'
  | 'CC-BY-NC-ND-2.0'
  | 'CC-BY-NC-ND-2.5'
  | 'CC-BY-NC-ND-3.0-DE'
  | 'CC-BY-NC-ND-3.0-IGO'
  | 'CC-BY-NC-ND-3.0'
  | 'CC-BY-NC-ND-4.0'
  | 'CC-BY-NC-SA-1.0'
  | 'CC-BY-NC-SA-2.0-DE'
  | 'CC-BY-NC-SA-2.0-FR'
  | 'CC-BY-NC-SA-2.0-UK'
  | 'CC-BY-NC-SA-2.0'
  | 'CC-BY-NC-SA-2.5'
  | 'CC-BY-NC-SA-3.0-DE'
  | 'CC-BY-NC-SA-3.0-IGO'
  | 'CC-BY-NC-SA-3.0'
  | 'CC-BY-NC-SA-4.0'
  | 'CC-BY-ND-1.0'
  | 'CC-BY-ND-2.0'
  | 'CC-BY-ND-2.5'
  | 'CC-BY-ND-3.0-DE'
  | 'CC-BY-ND-3.0'
  | 'CC-BY-ND-4.0'
  | 'CC-BY-SA-1.0'
  | 'CC-BY-SA-2.0-UK'
  | 'CC-BY-SA-2.0'
  | 'CC-BY-SA-2.1-JP'
  | 'CC-BY-SA-2.5'
  | 'CC-BY-SA-3.0-AT'
  | 'CC-BY-SA-3.0-DE'
  | 'CC-BY-SA-3.0-IGO'
  | 'CC-BY-SA-3.0'
  | 'CC-BY-SA-4.0'
  | 'CC-PDDC'
  | 'CC-PDM-1.0'
  | 'CC-SA-1.0'
  | 'CC0-1.0'
  | 'CDDL-1.0'
  | 'CDDL-1.1'
  | 'CDL-1.0'
  | 'CDLA-Permissive-1.0'
  | 'CDLA-Permissive-2.0'
  | 'CDLA-Sharing-1.0'
  | 'CECILL-1.0'
  | 'CECILL-1.1'
  | 'CECILL-2.0'
  | 'CECILL-2.1'
  | 'CECILL-B'
  | 'CECILL-C'
  | 'CERN-OHL-1.1'
  | 'CERN-OHL-1.2'
  | 'CERN-OHL-P-2.0'
  | 'CERN-OHL-S-2.0'
  | 'CERN-OHL-W-2.0'
  | 'CFITSIO'
  | 'check-cvs'
  | 'checkmk'
  | 'ClArtistic'
  | 'Clips'
  | 'CMU-Mach-nodoc'
  | 'CMU-Mach'
  | 'CNRI-Jython'
  | 'CNRI-Python-GPL-Compatible'
  | 'CNRI-Python'
  | 'COIL-1.0'
  | 'Community-Spec-1.0'
  | 'Condor-1.1'
  | 'copyleft-next-0.3.0'
  | 'copyleft-next-0.3.1'
  | 'Cornell-Lossless-JPEG'
  | 'CPAL-1.0'
  | 'CPL-1.0'
  | 'CPOL-1.02'
  | 'Cronyx'
  | 'Crossword'
  | 'CrystalStacker'
  | 'CUA-OPL-1.0'
  | 'Cube'
  | 'curl'
  | 'cve-tou'
  | 'D-FSL-1.0'
  | 'DEC-3-Clause'
  | 'diffmark'
  | 'DL-DE-BY-2.0'
  | 'DL-DE-ZERO-2.0'
  | 'DOC'
  | 'DocBook-Schema'
  | 'DocBook-Stylesheet'
  | 'DocBook-XML'
  | 'Dotseqn'
  | 'DRL-1.0'
  | 'DRL-1.1'
  | 'DSDP'
  | 'dtoa'
  | 'dvipdfm'
  | 'ECL-1.0'
  | 'ECL-2.0'
  | 'EFL-1.0'
  | 'EFL-2.0'
  | 'eGenix'
  | 'Elastic-2.0'
  | 'Entessa'
  | 'EPICS'
  | 'EPL-1.0'
  | 'EPL-2.0'
  | 'ErlPL-1.1'
  | 'etalab-2.0'
  | 'EUDatagrid'
  | 'EUPL-1.0'
  | 'EUPL-1.1'
  | 'EUPL-1.2'
  | 'Eurosym'
  | 'Fair'
  | 'FBM'
  | 'FDK-AAC'
  | 'Ferguson-Twofish'
  | 'Frameworx-1.0'
  | 'FreeBSD-DOC'
  | 'FreeImage'
  | 'FSFAP-no-warranty-disclaimer'
  | 'FSFAP'
  | 'FSFUL'
  | 'FSFULLR'
  | 'FSFULLRWD'
  | 'FTL'
  | 'Furuseth'
  | 'fwlw'
  | 'GCR-docs'
  | 'GD'
  | 'generic-xts'
  | 'GFDL-1.1-invariants-only'
  | 'GFDL-1.1-invariants-or-later'
  | 'GFDL-1.1-no-invariants-only'
  | 'GFDL-1.1-no-invariants-or-later'
  | 'GFDL-1.1-only'
  | 'GFDL-1.1-or-later'
  | 'GFDL-1.2-invariants-only'
  | 'GFDL-1.2-invariants-or-later'
  | 'GFDL-1.2-no-invariants-only'
  | 'GFDL-1.2-no-invariants-or-later'
  | 'GFDL-1.2-only'
  | 'GFDL-1.2-or-later'
  | 'GFDL-1.3-invariants-only'
  | 'GFDL-1.3-invariants-or-later'
  | 'GFDL-1.3-no-invariants-only'
  | 'GFDL-1.3-no-invariants-or-later'
  | 'GFDL-1.3-only'
  | 'GFDL-1.3-or-later'
  | 'Giftware'
  | 'GL2PS'
  | 'Glide'
  | 'Glulxe'
  | 'GLWTPL'
  | 'gnuplot'
  | 'GPL-1.0-only'
  | 'GPL-1.0-or-later'
  | 'GPL-2.0-only'
  | 'GPL-2.0-or-later'
  | 'GPL-3.0-only'
  | 'GPL-3.0-or-later'
  | 'Graphics-Gems'
  | 'gSOAP-1.3b'
  | 'gtkbook'
  | 'Gutmann'
  | 'HaskellReport'
  | 'hdparm'
  | 'HIDAPI'
  | 'Hippocratic-2.1'
  | 'HP-1986'
  | 'HP-1989'
  | 'HPND-DEC'
  | 'HPND-doc-sell'
  | 'HPND-doc'
  | 'HPND-export-US-acknowledgement'
  | 'HPND-export-US-modify'
  | 'HPND-export-US'
  | 'HPND-export2-US'
  | 'HPND-Fenneberg-Livingston'
  | 'HPND-INRIA-IMAG'
  | 'HPND-Intel'
  | 'HPND-Kevlin-Henney'
  | 'HPND-Markus-Kuhn'
  | 'HPND-merchantability-variant'
  | 'HPND-MIT-disclaimer'
  | 'HPND-Netrek'
  | 'HPND-Pbmplus'
  | 'HPND-sell-MIT-disclaimer-xserver'
  | 'HPND-sell-regexpr'
  | 'HPND-sell-variant-MIT-disclaimer-rev'
  | 'HPND-sell-variant-MIT-disclaimer'
  | 'HPND-sell-variant'
  | 'HPND-UC-export-US'
  | 'HPND-UC'
  | 'HPND'
  | 'HTMLTIDY'
  | 'IBM-pibs'
  | 'ICU'
  | 'IEC-Code-Components-EULA'
  | 'IJG-short'
  | 'IJG'
  | 'ImageMagick'
  | 'iMatix'
  | 'Imlib2'
  | 'Info-ZIP'
  | 'Inner-Net-2.0'
  | 'InnoSetup'
  | 'Intel-ACPI'
  | 'Intel'
  | 'Interbase-1.0'
  | 'IPA'
  | 'IPL-1.0'
  | 'ISC-Veillard'
  | 'ISC'
  | 'Jam'
  | 'JasPer-2.0'
  | 'JPL-image'
  | 'JPNIC'
  | 'JSON'
  | 'Kastrup'
  | 'Kazlib'
  | 'Knuth-CTAN'
  | 'LAL-1.2'
  | 'LAL-1.3'
  | 'Latex2e-translated-notice'
  | 'Latex2e'
  | 'Leptonica'
  | 'LGPL-2.0-only'
  | 'LGPL-2.0-or-later'
  | 'LGPL-2.1-only'
  | 'LGPL-2.1-or-later'
  | 'LGPL-3.0-only'
  | 'LGPL-3.0-or-later'
  | 'LGPLLR'
  | 'libpng-2.0'
  | 'Libpng'
  | 'libselinux-1.0'
  | 'libtiff'
  | 'libutil-David-Nugent'
  | 'LiLiQ-P-1.1'
  | 'LiLiQ-R-1.1'
  | 'LiLiQ-Rplus-1.1'
  | 'Linux-man-pages-1-para'
  | 'Linux-man-pages-copyleft-2-para'
  | 'Linux-man-pages-copyleft-var'
  | 'Linux-man-pages-copyleft'
  | 'Linux-OpenIB'
  | 'LOOP'
  | 'LPD-document'
  | 'LPL-1.0'
  | 'LPL-1.02'
  | 'LPPL-1.0'
  | 'LPPL-1.1'
  | 'LPPL-1.2'
  | 'LPPL-1.3a'
  | 'LPPL-1.3c'
  | 'lsof'
  | 'Lucida-Bitmap-Fonts'
  | 'LZMA-SDK-9.11-to-9.20'
  | 'LZMA-SDK-9.22'
  | 'Mackerras-3-Clause-acknowledgment'
  | 'Mackerras-3-Clause'
  | 'magaz'
  | 'mailprio'
  | 'MakeIndex'
  | 'Martin-Birgmeier'
  | 'McPhee-slideshow'
  | 'metamail'
  | 'Minpack'
  | 'MIPS'
  | 'MirOS'
  | 'MIT-0'
  | 'MIT-advertising'
  | 'MIT-Click'
  | 'MIT-CMU'
  | 'MIT-enna'
  | 'MIT-feh'
  | 'MIT-Festival'
  | 'MIT-Khronos-old'
  | 'MIT-Modern-Variant'
  | 'MIT-open-group'
  | 'MIT-testregex'
  | 'MIT-Wu'
  | 'MIT'
  | 'MITNFA'
  | 'MMIXware'
  | 'Motosoto'
  | 'MPEG-SSG'
  | 'mpi-permissive'
  | 'mpich2'
  | 'MPL-1.0'
  | 'MPL-1.1'
  | 'MPL-2.0-no-copyleft-exception'
  | 'MPL-2.0'
  | 'mplus'
  | 'MS-LPL'
  | 'MS-PL'
  | 'MS-RL'
  | 'MTLL'
  | 'MulanPSL-1.0'
  | 'MulanPSL-2.0'
  | 'Multics'
  | 'Mup'
  | 'NAIST-2003'
  | 'NASA-1.3'
  | 'Naumen'
  | 'NBPL-1.0'
  | 'NCBI-PD'
  | 'NCGL-UK-2.0'
  | 'NCL'
  | 'NCSA'
  | 'NetCDF'
  | 'Newsletr'
  | 'NGPL'
  | 'NICTA-1.0'
  | 'NIST-PD-fallback'
  | 'NIST-PD'
  | 'NIST-Software'
  | 'NLOD-1.0'
  | 'NLOD-2.0'
  | 'NLPL'
  | 'Nokia'
  | 'NOSL'
  | 'Noweb'
  | 'NPL-1.0'
  | 'NPL-1.1'
  | 'NPOSL-3.0'
  | 'NRL'
  | 'NTP-0'
  | 'NTP'
  | 'O-UDA-1.0'
  | 'OAR'
  | 'OCCT-PL'
  | 'OCLC-2.0'
  | 'ODbL-1.0'
  | 'ODC-By-1.0'
  | 'OFFIS'
  | 'OFL-1.0-no-RFN'
  | 'OFL-1.0-RFN'
  | 'OFL-1.0'
  | 'OFL-1.1-no-RFN'
  | 'OFL-1.1-RFN'
  | 'OFL-1.1'
  | 'OGC-1.0'
  | 'OGDL-Taiwan-1.0'
  | 'OGL-Canada-2.0'
  | 'OGL-UK-1.0'
  | 'OGL-UK-2.0'
  | 'OGL-UK-3.0'
  | 'OGTSL'
  | 'OLDAP-1.1'
  | 'OLDAP-1.2'
  | 'OLDAP-1.3'
  | 'OLDAP-1.4'
  | 'OLDAP-2.0.1'
  | 'OLDAP-2.0'
  | 'OLDAP-2.1'
  | 'OLDAP-2.2.1'
  | 'OLDAP-2.2.2'
  | 'OLDAP-2.2'
  | 'OLDAP-2.3'
  | 'OLDAP-2.4'
  | 'OLDAP-2.5'
  | 'OLDAP-2.6'
  | 'OLDAP-2.7'
  | 'OLDAP-2.8'
  | 'OLFL-1.3'
  | 'OML'
  | 'OpenPBS-2.3'
  | 'OpenSSL-standalone'
  | 'OpenSSL'
  | 'OpenVision'
  | 'OPL-1.0'
  | 'OPL-UK-3.0'
  | 'OPUBL-1.0'
  | 'OSET-PL-2.1'
  | 'OSL-1.0'
  | 'OSL-1.1'
  | 'OSL-2.0'
  | 'OSL-2.1'
  | 'OSL-3.0'
  | 'PADL'
  | 'Parity-6.0.0'
  | 'Parity-7.0.0'
  | 'PDDL-1.0'
  | 'PHP-3.0'
  | 'PHP-3.01'
  | 'Pixar'
  | 'pkgconf'
  | 'Plexus'
  | 'pnmstitch'
  | 'PolyForm-Noncommercial-1.0.0'
  | 'PolyForm-Small-Business-1.0.0'
  | 'PostgreSQL'
  | 'PPL'
  | 'PSF-2.0'
  | 'psfrag'
  | 'psutils'
  | 'Python-2.0.1'
  | 'Python-2.0'
  | 'python-ldap'
  | 'Qhull'
  | 'QPL-1.0-INRIA-2004'
  | 'QPL-1.0'
  | 'radvd'
  | 'Rdisc'
  | 'RHeCos-1.1'
  | 'RPL-1.1'
  | 'RPL-1.5'
  | 'RPSL-1.0'
  | 'RSA-MD'
  | 'RSCPL'
  | 'Ruby-pty'
  | 'Ruby'
  | 'SAX-PD-2.0'
  | 'SAX-PD'
  | 'Saxpath'
  | 'SCEA'
  | 'SchemeReport'
  | 'Sendmail-8.23'
  | 'Sendmail-Open-Source-1.1'
  | 'Sendmail'
  | 'SGI-B-1.0'
  | 'SGI-B-1.1'
  | 'SGI-B-2.0'
  | 'SGI-OpenGL'
  | 'SGP4'
  | 'SHL-0.5'
  | 'SHL-0.51'
  | 'SimPL-2.0'
  | 'SISSL-1.2'
  | 'SISSL'
  | 'SL'
  | 'Sleepycat'
  | 'SMAIL-GPL'
  | 'SMLNJ'
  | 'SMPPL'
  | 'SNIA'
  | 'snprintf'
  | 'softSurfer'
  | 'Soundex'
  | 'Spencer-86'
  | 'Spencer-94'
  | 'Spencer-99'
  | 'SPL-1.0'
  | 'ssh-keyscan'
  | 'SSH-OpenSSH'
  | 'SSH-short'
  | 'SSLeay-standalone'
  | 'SSPL-1.0'
  | 'SugarCRM-1.1.3'
  | 'Sun-PPP-2000'
  | 'Sun-PPP'
  | 'SunPro'
  | 'SWL'
  | 'swrule'
  | 'Symlinks'
  | 'TAPR-OHL-1.0'
  | 'TCL'
  | 'TCP-wrappers'
  | 'TermReadKey'
  | 'TGPPL-1.0'
  | 'ThirdEye'
  | 'threeparttable'
  | 'TMate'
  | 'TORQUE-1.1'
  | 'TOSL'
  | 'TPDL'
  | 'TPL-1.0'
  | 'TrustedQSL'
  | 'TTWL'
  | 'TTYP0'
  | 'TU-Berlin-1.0'
  | 'TU-Berlin-2.0'
  | 'Ubuntu-font-1.0'
  | 'UCAR'
  | 'UCL-1.0'
  | 'ulem'
  | 'UMich-Merit'
  | 'Unicode-3.0'
  | 'Unicode-DFS-2015'
  | 'Unicode-DFS-2016'
  | 'Unicode-TOU'
  | 'UnixCrypt'
  | 'Unlicense'
  | 'UPL-1.0'
  | 'URT-RLE'
  | 'Vim'
  | 'VOSTROM'
  | 'VSL-1.0'
  | 'W3C-19980720'
  | 'W3C-20150513'
  | 'W3C'
  | 'w3m'
  | 'Watcom-1.0'
  | 'Widget-Workshop'
  | 'Wsuipa'
  | 'WTFPL'
  | 'wwl'
  | 'X11-distribute-modifications-variant'
  | 'X11-swapped'
  | 'X11'
  | 'Xdebug-1.03'
  | 'Xerox'
  | 'Xfig'
  | 'XFree86-1.1'
  | 'xinetd'
  | 'xkeyboard-config-Zinoviev'
  | 'xlock'
  | 'Xnet'
  | 'xpp'
  | 'XSkat'
  | 'xzoom'
  | 'YPL-1.0'
  | 'YPL-1.1'
  | 'Zed'
  | 'Zeeff'
  | 'Zend-2.0'
  | 'Zimbra-1.3'
  | 'Zimbra-1.4'
  | 'zlib-acknowledgement'
  | 'Zlib'
  | 'ZPL-1.1'
  | 'ZPL-2.0'
  | 'ZPL-2.1';


--- src/types/rule.ts ---

import type { AllowedKeys, TechType } from './techs.js';
import type { MaybePromise } from './utils.js';
import type { Payload } from '../payload/index.js';
import type { BaseProvider, ProviderFile } from '../provider/base.js';

export type SupportedDeps =
  | 'deno'
  | 'docker'
  | 'githubAction'
  | 'golang'
  | 'npm'
  | 'php'
  | 'python'
  | 'ruby'
  | 'rust'
  | 'terraform.resource'
  | 'terraform';

export type RuleDependency = {
  type: SupportedDeps;
} & (
  | { name: RegExp; example: string }
  | {
      name: string;
    }
);

export type Rule = {
  tech: AllowedKeys;
  name: string;
  type: TechType;
  dotenv?: string[];
  dependencies?: RuleDependency[];
  detect?: ComponentMatcher | ComponentMatcher[];
  extensions?: string[];
  // eslint-disable-next-line @typescript-eslint/no-redundant-type-constituents
} & (never | RuleFiles);

export type RuleFiles =
  | {
      files: RegExp;
      example: string;
    }
  | {
      files: string[];
    }
  | {
      files?: never;
    }
  | {
      matchFullPath: boolean;
      files: RegExp;
      example: string;
    };

export type RuleWithFile = Pick<Rule, 'tech'> & RuleFiles;
export type RuleWithDotEnv = { dotenv: string[] } & Pick<Rule, 'tech'>;

export type ComponentMatcher = (
  files: ProviderFile[],
  provider: BaseProvider
) => MaybePromise<false | Payload | Payload[]>;

export type TechMatcher = (files: ProviderFile[]) => [Rule, string] | false;
export type ExtensionMatcher = (list: Set<string>) => [Rule, string] | false;
export type DotEnvMatcher = (content: string) => [Rule, string] | false;


--- src/types/techs.ts ---

export type TechType =
  | 'ai'
  | 'analytics'
  | 'api' // @deprecated
  | 'app'
  | 'auth'
  | 'automation'
  | 'builder'
  | 'ci'
  | 'cloud'
  | 'cms'
  | 'collaboration'
  | 'communication'
  | 'crm'
  | 'db'
  | 'etl'
  | 'framework'
  | 'hosting'
  | 'iac'
  | 'iconset'
  | 'language'
  | 'linter'
  | 'maps'
  | 'messaging' // @deprecated
  | 'monitoring'
  | 'network'
  | 'notification'
  | 'orm'
  | 'package_manager'
  | 'payment'
  | 'queue'
  | 'runtime'
  | 'saas'
  | 'security'
  | 'ssg'
  | 'storage'
  | 'test'
  | 'tool'
  | 'ui_framework'
  | 'ui'
  | 'validation';

export type AllowedKeys =
  | 'ada'
  | 'adminer'
  | 'adobe.analytics'
  | 'adobe.commercecloud'
  | 'adobe.experiencemanager'
  | 'adobe'
  | 'adonisjs'
  | 'adyen'
  | 'airbyte'
  | 'aircall'
  | 'airtable'
  | 'akamai'
  | 'algolia'
  | 'alibabacloud'
  | 'alpinejs'
  | 'amplitude'
  | 'angular'
  | 'ansible'
  | 'antd'
  | 'antdicons'
  | 'anthropic'
  | 'apache_airflow'
  | 'apache_cassandra'
  | 'apache_couchdb'
  | 'apache_flink'
  | 'apache_hadoop'
  | 'apache_hive'
  | 'apache_iceberg'
  | 'apache_kafka'
  | 'apache_solr'
  | 'apache_spark'
  | 'apache_storm'
  | 'apache_thrift'
  | 'apacheCordova'
  | 'apachetika'
  | 'apideck'
  | 'apify'
  | 'apiplatform'
  | 'apple.maps'
  | 'apple'
  | 'appsignal'
  | 'appveyor'
  | 'ariakitui'
  | 'arktype'
  | 'arkui'
  | 'asana'
  | 'asdf'
  | 'aspnet'
  | 'assemble'
  | 'astro'
  | 'atlasgo'
  | 'atlassian.bitbucket'
  | 'atlassian.bitbucketpipelines'
  | 'atlassian.confluence'
  | 'atlassian.jira'
  | 'atlassian.opsgenie'
  | 'atlassian.trello'
  | 'atlassian'
  | 'auth0'
  | 'aws.amplifyhosting'
  | 'aws.apigateway'
  | 'aws.athena'
  | 'aws.bedrock'
  | 'aws.cloudformation'
  | 'aws.cloudfront'
  | 'aws.cloudsearch'
  | 'aws.cloudwatch'
  | 'aws.codebuild'
  | 'aws.codepipeline'
  | 'aws.cognito'
  | 'aws.comprehend'
  | 'aws.documentdb'
  | 'aws.dynamodb'
  | 'aws.ebs'
  | 'aws.ec2'
  | 'aws.ecr'
  | 'aws.ecs'
  | 'aws.efs'
  | 'aws.eks'
  | 'aws.elasticache'
  | 'aws.fargate'
  | 'aws.glacier'
  | 'aws.glue'
  | 'aws.kafka'
  | 'aws.kinesis'
  | 'aws.kms'
  | 'aws.lambda'
  | 'aws.lightsail'
  | 'aws.memorydb'
  | 'aws.mq'
  | 'aws.neptune'
  | 'aws.opensearch'
  | 'aws.polly'
  | 'aws.rds'
  | 'aws.redshift'
  | 'aws.rekognition'
  | 'aws.s3'
  | 'aws.sagemaker'
  | 'aws.secretsmanager'
  | 'aws.ses'
  | 'aws.sfn'
  | 'aws.sns'
  | 'aws.sqs'
  | 'aws.timestream'
  | 'aws.transcribe'
  | 'aws.translate'
  | 'aws'
  | 'azure.aks'
  | 'azure.ci'
  | 'azure.cosmosdb'
  | 'azure.functions'
  | 'azure.maps'
  | 'azure.mariadb'
  | 'azure.mysql'
  | 'azure.openai'
  | 'azure.postgres'
  | 'azure.redis'
  | 'azure.sql'
  | 'azure.staticwebapps'
  | 'azure.storage'
  | 'azure'
  | 'babel'
  | 'base44'
  | 'baseui'
  | 'bash'
  | 'beehiiv'
  | 'betterauth'
  | 'betterstack'
  | 'bigcommerce'
  | 'biomejs'
  | 'blackfire'
  | 'blitzjs'
  | 'bootstrap'
  | 'bootstrapicons'
  | 'box'
  | 'brevo'
  | 'browerbase'
  | 'browserstack'
  | 'browseruse'
  | 'bugsnag'
  | 'builtwithfern'
  | 'bundler'
  | 'bunsh'
  | 'bytebase'
  | 'c'
  | 'caddy'
  | 'calcom'
  | 'calendly'
  | 'capacitorjs'
  | 'cargo'
  | 'celery'
  | 'chakraui'
  | 'chargebee'
  | 'checkov'
  | 'chef'
  | 'chromadb'
  | 'circleci'
  | 'cirrusci'
  | 'clerk'
  | 'clickhouse'
  | 'clicksend'
  | 'clickup'
  | 'clojure'
  | 'cloudbees.codeship'
  | 'cloudbees'
  | 'cloudflare.pages'
  | 'cloudflare.r2'
  | 'cloudflare.workers'
  | 'cloudflare'
  | 'cloudinary'
  | 'cobol'
  | 'cockroachdb'
  | 'codeclimate'
  | 'codecov'
  | 'codemirror'
  | 'codesandboxci'
  | 'coffeescript'
  | 'cohereai'
  | 'commercetools'
  | 'composio'
  | 'concourseci'
  | 'consul'
  | 'contentful'
  | 'convexdb'
  | 'couchbase'
  | 'coveralls'
  | 'cplusplus'
  | 'cratedb'
  | 'crawl4ai'
  | 'crowdin'
  | 'csharp'
  | 'css'
  | 'cypressci'
  | 'd3js'
  | 'daisyui'
  | 'dart'
  | 'databricks'
  | 'databuddy'
  | 'datadog'
  | 'datadome'
  | 'datafast'
  | 'dataiku'
  | 'datastax'
  | 'datocms'
  | 'deepseek'
  | 'deepsource'
  | 'deferrun'
  | 'deno'
  | 'denodeploy'
  | 'dependabot'
  | 'depotdev'
  | 'dieselrs'
  | 'digitalocean'
  | 'dioxus'
  | 'discord'
  | 'discourse'
  | 'django'
  | 'docker'
  | 'docsify'
  | 'doctrinephp'
  | 'docusaurus'
  | 'docusign'
  | 'dokku'
  | 'drizzleorm'
  | 'droneci'
  | 'dropbox'
  | 'drupal'
  | 'duckdb'
  | 'dynatrace'
  | 'effectjs'
  | 'elasticcloud'
  | 'elasticsearch'
  | 'electron'
  | 'elevenlabs'
  | 'eleventy'
  | 'elixir'
  | 'elysiajs'
  | 'emberjs'
  | 'equinix'
  | 'esbuild'
  | 'eslint'
  | 'expodev'
  | 'expojs'
  | 'express'
  | 'fabric'
  | 'facebook'
  | 'fastify'
  | 'fastly'
  | 'fathom'
  | 'feathericons'
  | 'figma'
  | 'firebase.firestore'
  | 'firebase'
  | 'firecrawl'
  | 'fluentui'
  | 'flyio'
  | 'flyway'
  | 'fontawesome'
  | 'freshdesk'
  | 'frontegg'
  | 'fumadocs'
  | 'fusionauth'
  | 'gatsby'
  | 'gcp.aiplatform'
  | 'gcp.appengine'
  | 'gcp.artifactregistry'
  | 'gcp.bigquery'
  | 'gcp.bigtable'
  | 'gcp.cloudbuild'
  | 'gcp.cloudrun'
  | 'gcp.containerregistry'
  | 'gcp.dataflow'
  | 'gcp.dataproc'
  | 'gcp.datastore'
  | 'gcp.dialogflow'
  | 'gcp.dns'
  | 'gcp.functions'
  | 'gcp.gce'
  | 'gcp.gcs'
  | 'gcp.gke'
  | 'gcp.kms'
  | 'gcp.language'
  | 'gcp.logging'
  | 'gcp.maps'
  | 'gcp.memorystore'
  | 'gcp.pubsub'
  | 'gcp.secretmanager'
  | 'gcp.spanner'
  | 'gcp.speech'
  | 'gcp.sql'
  | 'gcp.tasks'
  | 'gcp.translate'
  | 'gcp.vertex'
  | 'gcp.vision'
  | 'gcp'
  | 'geminiai'
  | 'ghost'
  | 'gitbook'
  | 'gitguardian'
  | 'github.actions'
  | 'github.codeql'
  | 'github.pages'
  | 'github'
  | 'gitlab.ci'
  | 'gitlab'
  | 'glsl'
  | 'goacmelego'
  | 'goent'
  | 'goenv'
  | 'golang'
  | 'golangcilint'
  | 'google.analytics'
  | 'google.calendar'
  | 'google.chat'
  | 'google.docs'
  | 'google.drive'
  | 'google.forms'
  | 'google.gmail'
  | 'google.keep'
  | 'google.meet'
  | 'google.pay'
  | 'google.sheets'
  | 'google.sites'
  | 'google.slides'
  | 'google.tasks'
  | 'google'
  | 'gorm'
  | 'gradio'
  | 'grafana'
  | 'gridsome'
  | 'groq'
  | 'hanko'
  | 'haproxy'
  | 'hashicorp_vault'
  | 'haskell'
  | 'headlessui'
  | 'healthchecksio'
  | 'helm'
  | 'heremaps'
  | 'heroicons'
  | 'heroku'
  | 'heroui'
  | 'hetzner'
  | 'hexojs'
  | 'honeybadger'
  | 'honojs'
  | 'hostinger'
  | 'hotjar'
  | 'html'
  | 'htmx'
  | 'httpd'
  | 'hubspot'
  | 'hugeicons'
  | 'huggingface'
  | 'hugo'
  | 'hyperdx'
  | 'hypertune'
  | 'ibmcloud'
  | 'ifttt'
  | 'infernojs'
  | 'infisical'
  | 'influxdb'
  | 'inngest'
  | 'instagram'
  | 'integrationapp'
  | 'intercom'
  | 'intuit'
  | 'ionic'
  | 'ionicons'
  | 'java'
  | 'javascript'
  | 'jekyll'
  | 'jenkins'
  | 'jest'
  | 'joijs'
  | 'joomla'
  | 'jsonschema'
  | 'jsx'
  | 'k6'
  | 'kentico'
  | 'kibana'
  | 'kinde'
  | 'klarna'
  | 'klaviyo'
  | 'knex'
  | 'koa'
  | 'koalaanalytics'
  | 'kong'
  | 'kotlin'
  | 'koyeb'
  | 'kubernetes'
  | 'kysely'
  | 'lago'
  | 'laravel'
  | 'launchdarkly'
  | 'lemonsqueezy'
  | 'lexicaleditor'
  | 'libsql'
  | 'lighthouse'
  | 'linear'
  | 'linkedin'
  | 'liquibase'
  | 'litjs'
  | 'logrocket'
  | 'logsnag'
  | 'logstash'
  | 'logtoio'
  | 'lordicon'
  | 'lovable'
  | 'lua'
  | 'lucideicons'
  | 'magento'
  | 'mailchimp'
  | 'mailgun'
  | 'mailhog'
  | 'mailjet'
  | 'mantineui'
  | 'mapbox'
  | 'mariadb'
  | 'materialdesignicons'
  | 'materialui'
  | 'matlab'
  | 'matomo'
  | 'mattermost'
  | 'mcp'
  | 'meilisearch'
  | 'meilisearchcloud'
  | 'memcached'
  | 'mergedev'
  | 'metabase'
  | 'meteorjs'
  | 'microsoft.onedrive'
  | 'microsoft'
  | 'milvusdb'
  | 'mintlify'
  | 'miro'
  | 'mistralai'
  | 'mithriljs'
  | 'mixpanel'
  | 'mkdocs'
  | 'mochajs'
  | 'monacoeditor'
  | 'monday'
  | 'mongodb'
  | 'mongodbatlas'
  | 'mongoexpress'
  | 'mssql'
  | 'muiicons'
  | 'mysql'
  | 'n8n'
  | 'nango'
  | 'nats'
  | 'neo4j'
  | 'neondb'
  | 'nestjs'
  | 'netlify'
  | 'newrelic'
  | 'nextcloud'
  | 'nextjs'
  | 'nginx'
  | 'nodejs'
  | 'notion'
  | 'novu'
  | 'npm'
  | 'nuget'
  | 'nuxtjs'
  | 'nvm'
  | 'nxcloud'
  | 'nxjs'
  | 'objectivec'
  | 'oceanbase'
  | 'okta'
  | 'ollama'
  | 'onlineornot'
  | 'openai'
  | 'openapi'
  | 'opentelemetry'
  | 'optimizely'
  | 'oraclecloud'
  | 'orysh'
  | 'ovh.database'
  | 'ovh.dedicated'
  | 'ovh.kubernetes'
  | 'ovh.storage'
  | 'ovh.vps'
  | 'ovh'
  | 'oxlint'
  | 'paddle'
  | 'pagerduty'
  | 'papertrail'
  | 'parceljs'
  | 'payloadcms'
  | 'paypal'
  | 'paystack'
  | 'percona'
  | 'perl'
  | 'perplexityai'
  | 'phaserjs'
  | 'phosphoreicons'
  | 'php'
  | 'phpcomposer'
  | 'phpenv'
  | 'phppest'
  | 'phpstan'
  | 'phpunit'
  | 'pinecone'
  | 'pingdom'
  | 'pipenv'
  | 'pirschanalytics'
  | 'placekit'
  | 'planetscale'
  | 'platformsh'
  | 'plausible'
  | 'playwright'
  | 'pnpm'
  | 'poetry'
  | 'polarsh'
  | 'postgresql'
  | 'postgrest'
  | 'posthog'
  | 'postman'
  | 'postmark'
  | 'powershell'
  | 'preactjs'
  | 'prestashop'
  | 'prettier'
  | 'prisma'
  | 'prismacloud'
  | 'prometheus'
  | 'propelauth'
  | 'pulumi'
  | 'puppeteer'
  | 'python'
  | 'pytorch'
  | 'qdrant'
  | 'qovery.cluster'
  | 'qovery.database'
  | 'qovery'
  | 'questdb'
  | 'qwikjs'
  | 'r'
  | 'rabbitmq'
  | 'radixicons'
  | 'radixui'
  | 'rails'
  | 'railway.mongodb'
  | 'railway.mysql'
  | 'railway.postgres'
  | 'railway.redis'
  | 'railway'
  | 'react'
  | 'reactemail'
  | 'reacticons'
  | 'reactrouterdom'
  | 'readthedocs'
  | 'reddit'
  | 'redis'
  | 'redwoodjs'
  | 'refinedev'
  | 'rekaui'
  | 'relativeci'
  | 'remixicons'
  | 'remixrouter'
  | 'remixrun'
  | 'remult'
  | 'render'
  | 'renovate'
  | 'replicate'
  | 'replit.database'
  | 'replit.postgres'
  | 'replit'
  | 'resend'
  | 'rethinkdb'
  | 'revenuecat'
  | 'rollbar'
  | 'rolldown'
  | 'rollup'
  | 'rspack'
  | 'rubocop'
  | 'ruby'
  | 'rubyenv'
  | 'rust'
  | 'salesforce'
  | 'sandpackeditor'
  | 'sanity'
  | 'sap'
  | 'sas'
  | 'scala'
  | 'scaleway.container'
  | 'scaleway.database'
  | 'scaleway.documentdb'
  | 'scaleway.elasticmetal'
  | 'scaleway.function'
  | 'scaleway.kubernetes'
  | 'scaleway.mq'
  | 'scaleway.redis'
  | 'scaleway.secretmanager'
  | 'scaleway.storage'
  | 'scaleway'
  | 'scoutapm'
  | 'scss'
  | 'segment'
  | 'selenium'
  | 'sendgrid'
  | 'sentry'
  | 'sequelize'
  | 'sequelruby'
  | 'servicenow'
  | 'shadcn'
  | 'shopify.hydrogen'
  | 'shopify'
  | 'signoz'
  | 'simpleanalytics'
  | 'simpleicons'
  | 'sitecore.xmlcloud'
  | 'sitecore'
  | 'slack'
  | 'slatedocs'
  | 'snowflake'
  | 'snyk'
  | 'socketio'
  | 'solidjs'
  | 'sonarcloud'
  | 'sonarlint'
  | 'sonarqube'
  | 'splitio'
  | 'splunk'
  | 'spotify'
  | 'sqlalchemy'
  | 'sqlite'
  | 'sqreen'
  | 'squarespace'
  | 'squareup'
  | 'stenciljs'
  | 'storyblok'
  | 'storybook'
  | 'strapi'
  | 'stripe'
  | 'styleci'
  | 'stylelint'
  | 'stytch'
  | 'supabase.auth'
  | 'supabase.functions'
  | 'supabase.postgres'
  | 'supabase.realtime'
  | 'supabase.storage'
  | 'supabase'
  | 'superstruct'
  | 'supertokens'
  | 'surrealdb'
  | 'sveltejs'
  | 'sveltekit'
  | 'swc'
  | 'swift'
  | 'swiftype'
  | 'symfony'
  | 'tablericons'
  | 'tailscale'
  | 'tailwind'
  | 'tanstackrouter'
  | 'tanstackstart'
  | 'tauri'
  | 'tdengine'
  | 'teamcity'
  | 'teamspeak'
  | 'telegraf'
  | 'telegram'
  | 'tencentcloud'
  | 'tensorflow'
  | 'terraform'
  | 'terragrunt'
  | 'testinglibrary'
  | 'tidb'
  | 'timescaledb'
  | 'tinybird'
  | 'tiptap'
  | 'traefik'
  | 'travisci'
  | 'trayio'
  | 'trpc'
  | 'trufflesecurity'
  | 'turborepo'
  | 'tursodb'
  | 'twentycrm'
  | 'twigphp'
  | 'twilio'
  | 'twitch'
  | 'twitter'
  | 'typebox'
  | 'typeorm'
  | 'typescript'
  | 'typesense'
  | 'typesensecloud'
  | 'ultracite'
  | 'umijs'
  | 'upstash.kafka'
  | 'upstash.qstash'
  | 'upstash.redis'
  | 'upstash'
  | 'uptimekuma'
  | 'useautumn'
  | 'useparagon'
  | 'vale'
  | 'valibot'
  | 'valkey'
  | 'vercel.ai'
  | 'vercel.analytics'
  | 'vercel.blob'
  | 'vercel.edge'
  | 'vercel.functions'
  | 'vercel.kv'
  | 'vercel.postgres'
  | 'vercel'
  | 'veriff'
  | 'vialink'
  | 'victoriametrics'
  | 'visualbasicnet'
  | 'vite'
  | 'vitepress'
  | 'vitest'
  | 'vue'
  | 'vuejs'
  | 'vuepress'
  | 'wasp'
  | 'webflow'
  | 'webpack'
  | 'whatsapp'
  | 'wikipedia'
  | 'withorb'
  | 'wiz'
  | 'wolframalpha'
  | 'woocommerce'
  | 'wordpress'
  | 'workos'
  | 'xai'
  | 'yarn'
  | 'yii2'
  | 'yousign'
  | 'youtube'
  | 'zapier'
  | 'zendesk'
  | 'zig'
  | 'zipkin'
  | 'zod'
  | 'zookeeper'
  | 'zoom'
  | 'zuora';

export interface TechItem {
  key: AllowedKeys;
  name: string;
  type: TechType;
}


--- src/types/utils.ts ---

export type Modify<T, TR> = Omit<T, keyof TR> & TR;

export type MaybePromise<T> = Promise<T> | T;


--- tests/__fixtures__/pkgs/app/src/index.html ---



--- vitest.config.ts ---

// eslint-disable-next-line import/no-unresolved
import { defineConfig } from 'vitest/config';

export default defineConfig({
  test: {
    environment: 'node',
    // include: ['build/**/*.test.js'],
    include: ['src/**/*.test.ts'],
    // globalSetup: 'src/test/vitest.global.ts',
    // setupFiles: 'src/test/vitest.each.ts',
    clearMocks: true,
    env: {},
    coverage: {
      enabled: true,
      reporter: ['cobertura'],
      provider: 'v8',
    },
  },
  json: {},
});
